[0m21:40:35.759329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B53DD1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B50ED1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B54B0BED0>]}


============================== 21:40:35.764060 | 0c6bc945-c0cb-4f8e-b2d2-19667f4ccd7f ==============================
[0m21:40:35.764060 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:40:35.765186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:40:35.784377 [info ] [MainThread]: dbt version: 1.9.2
[0m21:40:35.785532 [info ] [MainThread]: python version: 3.13.2
[0m21:40:35.786692 [info ] [MainThread]: python path: C:\Users\RamanathanL\.venv\Scripts\python.exe
[0m21:40:35.788041 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m21:40:36.103375 [info ] [MainThread]: Using profiles dir at C:\Users\RamanathanL\.dbt
[0m21:40:36.104379 [info ] [MainThread]: Using profiles.yml file at C:\Users\RamanathanL\.dbt\profiles.yml
[0m21:40:36.105221 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\dbt_project.yml
[0m21:40:36.117051 [info ] [MainThread]: adapter type: snowflake
[0m21:40:36.118261 [info ] [MainThread]: adapter version: 1.9.1
[0m21:40:36.234475 [info ] [MainThread]: Configuration:
[0m21:40:36.235319 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:40:36.236028 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:40:36.236743 [info ] [MainThread]: Required dependencies:
[0m21:40:36.237457 [debug] [MainThread]: Executing "git --help"
[0m21:40:36.305594 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:40:36.306207 [debug] [MainThread]: STDERR: "b''"
[0m21:40:36.306768 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:40:36.307657 [info ] [MainThread]: Connection:
[0m21:40:36.308383 [info ] [MainThread]:   account: thrkksz-hu73637
[0m21:40:36.309142 [info ] [MainThread]:   user: ramanathanlakshmanan
[0m21:40:36.309981 [info ] [MainThread]:   database: DE_MINI_PROJECT_DB
[0m21:40:36.310847 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m21:40:36.311970 [info ] [MainThread]:   role: accountadmin
[0m21:40:36.312856 [info ] [MainThread]:   schema: TEST_SCHEMA
[0m21:40:36.313899 [info ] [MainThread]:   authenticator: None
[0m21:40:36.314736 [info ] [MainThread]:   oauth_client_id: None
[0m21:40:36.315546 [info ] [MainThread]:   query_tag: None
[0m21:40:36.316246 [info ] [MainThread]:   client_session_keep_alive: False
[0m21:40:36.316927 [info ] [MainThread]:   host: None
[0m21:40:36.317611 [info ] [MainThread]:   port: None
[0m21:40:36.318419 [info ] [MainThread]:   proxy_host: None
[0m21:40:36.319274 [info ] [MainThread]:   proxy_port: None
[0m21:40:36.320042 [info ] [MainThread]:   protocol: None
[0m21:40:36.320730 [info ] [MainThread]:   connect_retries: 1
[0m21:40:36.321448 [info ] [MainThread]:   connect_timeout: None
[0m21:40:36.322265 [info ] [MainThread]:   retry_on_database_errors: False
[0m21:40:36.323198 [info ] [MainThread]:   retry_all: False
[0m21:40:36.323987 [info ] [MainThread]:   insecure_mode: False
[0m21:40:36.325136 [info ] [MainThread]:   reuse_connections: True
[0m21:40:36.326355 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m21:40:36.958022 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m21:40:40.178262 [debug] [MainThread]: Using snowflake connection "debug"
[0m21:40:40.178724 [debug] [MainThread]: On debug: select 1 as id
[0m21:40:40.179059 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:40:41.771770 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.593 seconds
[0m21:40:41.773477 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:40:41.774718 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:40:41.776706 [debug] [MainThread]: Command `dbt debug` succeeded at 21:40:41.776450 after 6.16 seconds
[0m21:40:41.777389 [debug] [MainThread]: Connection 'debug' was left open.
[0m21:40:41.777982 [debug] [MainThread]: On debug: Close
[0m21:40:41.882318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B566FCC30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B564039B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B562ECD10>]}
[0m21:40:41.883362 [debug] [MainThread]: Flushing usage events
[0m21:40:42.971736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:44:41.892372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5D5C01A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5D2D85310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5D7A07ED0>]}


============================== 21:44:41.897534 | 5920b4ea-c117-4bef-8101-af23694f196b ==============================
[0m21:44:41.897534 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:44:41.898479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m checkConnection', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:44:42.401888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5920b4ea-c117-4bef-8101-af23694f196b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5D823DBA0>]}
[0m21:44:42.474061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5920b4ea-c117-4bef-8101-af23694f196b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5D8119E10>]}
[0m21:44:42.475344 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m21:44:42.987474 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:44:42.989259 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:44:42.990217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5920b4ea-c117-4bef-8101-af23694f196b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5D8174A50>]}
[0m21:44:45.509939 [error] [MainThread]: Encountered an error:
Compilation Error in model checkConnection (models\example\checkConnection.sql)
  expected token 'end of print statement', got ':'
    line 4
      {{source:('checkSource','customers$')}}
[0m21:44:45.511352 [debug] [MainThread]: Command `dbt run` failed at 21:44:45.511203 after 3.76 seconds
[0m21:44:45.511787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5D84608C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5D8462F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C5D78EBE70>]}
[0m21:44:45.512209 [debug] [MainThread]: Flushing usage events
[0m21:44:46.560824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:44:55.991487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A257D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A22935310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A2750BED0>]}


============================== 21:44:55.996129 | 96cbe1cd-4bf5-45fb-978e-0f24b404b990 ==============================
[0m21:44:55.996129 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:44:55.997210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m checkConnection', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:44:56.433653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96cbe1cd-4bf5-45fb-978e-0f24b404b990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A27D4DBA0>]}
[0m21:44:56.498990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96cbe1cd-4bf5-45fb-978e-0f24b404b990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A27C29E10>]}
[0m21:44:56.500094 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m21:44:56.936372 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:44:56.937644 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:44:56.938587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '96cbe1cd-4bf5-45fb-978e-0f24b404b990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A27C84A50>]}
[0m21:44:58.502156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96cbe1cd-4bf5-45fb-978e-0f24b404b990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A27BE5D60>]}
[0m21:44:58.599980 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m21:44:58.629756 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m21:44:58.705117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96cbe1cd-4bf5-45fb-978e-0f24b404b990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A280651D0>]}
[0m21:44:58.705758 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 472 macros
[0m21:44:58.706588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96cbe1cd-4bf5-45fb-978e-0f24b404b990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A27F8EA90>]}
[0m21:44:58.710000 [info ] [MainThread]: 
[0m21:44:58.711000 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:44:58.711795 [info ] [MainThread]: 
[0m21:44:58.713295 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:44:58.715013 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m21:44:58.816322 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m21:44:58.816795 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m21:44:58.817173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:59.546441 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.729 seconds
[0m21:44:59.554157 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_TEST_SCHEMA'
[0m21:44:59.565187 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_TEST_SCHEMA"
[0m21:44:59.565632 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_TEST_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_TEST_SCHEMA"} */
show objects in DE_MINI_PROJECT_DB.TEST_SCHEMA limit 10000;
[0m21:44:59.566038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:44:59.995835 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.430 seconds
[0m21:45:00.001790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96cbe1cd-4bf5-45fb-978e-0f24b404b990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A282D4710>]}
[0m21:45:00.006059 [debug] [Thread-1 (]: Began running node model.dbt_transformations.checkConnection
[0m21:45:00.006845 [info ] [Thread-1 (]: 1 of 1 START sql view model TEST_SCHEMA.checkConnection ........................ [RUN]
[0m21:45:00.008015 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.checkConnection'
[0m21:45:00.008570 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.checkConnection
[0m21:45:00.020415 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.checkConnection"
[0m21:45:00.027122 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.checkConnection
[0m21:45:00.070365 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.checkConnection"
[0m21:45:00.073992 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.checkConnection"
[0m21:45:00.074603 [debug] [Thread-1 (]: On model.dbt_transformations.checkConnection: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.checkConnection"} */
create or replace   view DE_MINI_PROJECT_DB.TEST_SCHEMA.checkConnection
  
   as (
    SELECT 
    *
FROM
    DBT_MINI_PROJECT_DB.TEST_SCHEMA.customers$
  );
[0m21:45:00.075053 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:45:00.599433 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafbce-3201-7d7b-000c-4ad20001b05a
[0m21:45:00.600005 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'DBT_MINI_PROJECT_DB' does not exist or not authorized.
[0m21:45:00.609086 [debug] [Thread-1 (]: Database Error in model checkConnection (models\example\checkConnection.sql)
  002003 (02000): SQL compilation error:
  Database 'DBT_MINI_PROJECT_DB' does not exist or not authorized.
  compiled code at target\run\dbt_transformations\models\example\checkConnection.sql
[0m21:45:00.619740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96cbe1cd-4bf5-45fb-978e-0f24b404b990', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A289ACD60>]}
[0m21:45:00.620782 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model TEST_SCHEMA.checkConnection ............... [[31mERROR[0m in 0.60s]
[0m21:45:00.622091 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.checkConnection
[0m21:45:00.622891 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.checkConnection' to be skipped because of status 'error'.  Reason: Database Error in model checkConnection (models\example\checkConnection.sql)
  002003 (02000): SQL compilation error:
  Database 'DBT_MINI_PROJECT_DB' does not exist or not authorized.
  compiled code at target\run\dbt_transformations\models\example\checkConnection.sql.
[0m21:45:00.625376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:45:00.625874 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m21:45:00.626244 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m21:45:00.730120 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_TEST_SCHEMA' was left open.
[0m21:45:00.731075 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_TEST_SCHEMA: Close
[0m21:45:00.843350 [debug] [MainThread]: Connection 'model.dbt_transformations.checkConnection' was left open.
[0m21:45:00.843817 [debug] [MainThread]: On model.dbt_transformations.checkConnection: Close
[0m21:45:00.952724 [info ] [MainThread]: 
[0m21:45:00.953633 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m21:45:00.954796 [debug] [MainThread]: Command end result
[0m21:45:00.985021 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m21:45:00.988141 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m21:45:00.995299 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m21:45:00.995723 [info ] [MainThread]: 
[0m21:45:00.996562 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:45:00.997315 [info ] [MainThread]: 
[0m21:45:00.998138 [error] [MainThread]:   Database Error in model checkConnection (models\example\checkConnection.sql)
  002003 (02000): SQL compilation error:
  Database 'DBT_MINI_PROJECT_DB' does not exist or not authorized.
  compiled code at target\run\dbt_transformations\models\example\checkConnection.sql
[0m21:45:00.999035 [info ] [MainThread]: 
[0m21:45:00.999853 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:45:01.001891 [debug] [MainThread]: Command `dbt run` failed at 21:45:01.001575 after 5.14 seconds
[0m21:45:01.002462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A286BC550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A28A0FAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A28365450>]}
[0m21:45:01.003076 [debug] [MainThread]: Flushing usage events
[0m21:45:01.929037 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:46:23.674445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DAAD1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D7C05310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DC80BED0>]}


============================== 21:46:23.679497 | 8d56060a-de55-4087-92d9-38aa5023a390 ==============================
[0m21:46:23.679497 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:46:23.680529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m checkConnection', 'send_anonymous_usage_stats': 'True'}
[0m21:46:24.167240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d56060a-de55-4087-92d9-38aa5023a390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DD03DBA0>]}
[0m21:46:24.240267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d56060a-de55-4087-92d9-38aa5023a390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DCF19E10>]}
[0m21:46:24.241579 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m21:46:24.714585 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:46:24.921746 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m21:46:24.922398 [debug] [MainThread]: Partial parsing: added file: dbt_transformations://models\example\source.yml
[0m21:46:25.357745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d56060a-de55-4087-92d9-38aa5023a390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DCF76F50>]}
[0m21:46:25.511586 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m21:46:25.515915 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m21:46:25.543740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d56060a-de55-4087-92d9-38aa5023a390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5D7D7B6B0>]}
[0m21:46:25.544395 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 472 macros
[0m21:46:25.545313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d56060a-de55-4087-92d9-38aa5023a390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DD075390>]}
[0m21:46:25.547036 [info ] [MainThread]: 
[0m21:46:25.547813 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:46:25.548524 [info ] [MainThread]: 
[0m21:46:25.549590 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:46:25.551041 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m21:46:25.665943 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m21:46:25.666511 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m21:46:25.666907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:26.399846 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.733 seconds
[0m21:46:26.407908 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_TEST_SCHEMA'
[0m21:46:26.419147 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_TEST_SCHEMA"
[0m21:46:26.419638 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_TEST_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_TEST_SCHEMA"} */
show objects in DE_MINI_PROJECT_DB.TEST_SCHEMA limit 10000;
[0m21:46:26.420057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:46:26.884367 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.464 seconds
[0m21:46:26.889425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d56060a-de55-4087-92d9-38aa5023a390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DD3EEEA0>]}
[0m21:46:26.892359 [debug] [Thread-1 (]: Began running node model.dbt_transformations.checkConnection
[0m21:46:26.892999 [info ] [Thread-1 (]: 1 of 1 START sql view model TEST_SCHEMA.checkConnection ........................ [RUN]
[0m21:46:26.894001 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.checkConnection'
[0m21:46:26.894506 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.checkConnection
[0m21:46:26.907158 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.checkConnection"
[0m21:46:26.908314 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.checkConnection
[0m21:46:26.944187 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.checkConnection"
[0m21:46:26.945671 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.checkConnection"
[0m21:46:26.946226 [debug] [Thread-1 (]: On model.dbt_transformations.checkConnection: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.checkConnection"} */
create or replace   view DE_MINI_PROJECT_DB.TEST_SCHEMA.checkConnection
  
   as (
    SELECT 
    *
FROM
    DBT_MINI_PROJECT_DB.TEST_SCHEMA.customers$
  );
[0m21:46:26.946660 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:46:27.323345 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafbd0-3201-7e87-000c-4ad20001c016
[0m21:46:27.323873 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'DBT_MINI_PROJECT_DB' does not exist or not authorized.
[0m21:46:27.331475 [debug] [Thread-1 (]: Database Error in model checkConnection (models\example\checkConnection.sql)
  002003 (02000): SQL compilation error:
  Database 'DBT_MINI_PROJECT_DB' does not exist or not authorized.
  compiled code at target\run\dbt_transformations\models\example\checkConnection.sql
[0m21:46:27.333562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d56060a-de55-4087-92d9-38aa5023a390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DD95D910>]}
[0m21:46:27.334305 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model TEST_SCHEMA.checkConnection ............... [[31mERROR[0m in 0.44s]
[0m21:46:27.335785 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.checkConnection
[0m21:46:27.336735 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.checkConnection' to be skipped because of status 'error'.  Reason: Database Error in model checkConnection (models\example\checkConnection.sql)
  002003 (02000): SQL compilation error:
  Database 'DBT_MINI_PROJECT_DB' does not exist or not authorized.
  compiled code at target\run\dbt_transformations\models\example\checkConnection.sql.
[0m21:46:27.338934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:46:27.339331 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m21:46:27.339689 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m21:46:27.443896 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_TEST_SCHEMA' was left open.
[0m21:46:27.444369 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_TEST_SCHEMA: Close
[0m21:46:27.563528 [debug] [MainThread]: Connection 'model.dbt_transformations.checkConnection' was left open.
[0m21:46:27.564089 [debug] [MainThread]: On model.dbt_transformations.checkConnection: Close
[0m21:46:27.677897 [info ] [MainThread]: 
[0m21:46:27.680711 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m21:46:27.685047 [debug] [MainThread]: Command end result
[0m21:46:27.713215 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m21:46:27.715551 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m21:46:27.723489 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m21:46:27.723936 [info ] [MainThread]: 
[0m21:46:27.724954 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:46:27.725823 [info ] [MainThread]: 
[0m21:46:27.726735 [error] [MainThread]:   Database Error in model checkConnection (models\example\checkConnection.sql)
  002003 (02000): SQL compilation error:
  Database 'DBT_MINI_PROJECT_DB' does not exist or not authorized.
  compiled code at target\run\dbt_transformations\models\example\checkConnection.sql
[0m21:46:27.727501 [info ] [MainThread]: 
[0m21:46:27.728256 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:46:27.729455 [debug] [MainThread]: Command `dbt run` failed at 21:46:27.729313 after 4.33 seconds
[0m21:46:27.729903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DD92AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DDA639D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F5DDA61B30>]}
[0m21:46:27.730357 [debug] [MainThread]: Flushing usage events
[0m21:46:28.778201 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:51:08.505289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DDCBD1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DD9CD5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DDE90BED0>]}


============================== 21:51:08.510181 | dd6e7199-c191-460e-94d1-8a34886ab727 ==============================
[0m21:51:08.510181 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:51:08.511245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m checkConnection', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:51:08.954890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd6e7199-c191-460e-94d1-8a34886ab727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DDF13DBA0>]}
[0m21:51:09.022846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd6e7199-c191-460e-94d1-8a34886ab727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DDF019E10>]}
[0m21:51:09.023975 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m21:51:09.491420 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:51:09.700652 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 2 files added, 0 files changed.
[0m21:51:09.701239 [debug] [MainThread]: Partial parsing: added file: dbt_transformations://models\source.yml
[0m21:51:09.701641 [debug] [MainThread]: Partial parsing: added file: dbt_transformations://models\checkConnection.sql
[0m21:51:09.702121 [debug] [MainThread]: Partial parsing: deleted file: dbt_transformations://models\example\checkConnection.sql
[0m21:51:09.702468 [debug] [MainThread]: Partial parsing: deleted file: dbt_transformations://models\example\my_second_dbt_model.sql
[0m21:51:09.702793 [debug] [MainThread]: Partial parsing: deleted file: dbt_transformations://models\example\my_first_dbt_model.sql
[0m21:51:10.080796 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_transformations.example
[0m21:51:10.092929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd6e7199-c191-460e-94d1-8a34886ab727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DDF077D50>]}
[0m21:51:10.219453 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m21:51:10.223595 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m21:51:10.247421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd6e7199-c191-460e-94d1-8a34886ab727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DD9E4B6B0>]}
[0m21:51:10.247971 [info ] [MainThread]: Found 1 model, 1 source, 472 macros
[0m21:51:10.248931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd6e7199-c191-460e-94d1-8a34886ab727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DDF174130>]}
[0m21:51:10.250648 [info ] [MainThread]: 
[0m21:51:10.251402 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:51:10.252084 [info ] [MainThread]: 
[0m21:51:10.252940 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:51:10.254098 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m21:51:10.363573 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m21:51:10.364040 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m21:51:10.364427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:11.045762 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.681 seconds
[0m21:51:11.049098 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_TEST_SCHEMA'
[0m21:51:11.060227 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_TEST_SCHEMA"
[0m21:51:11.060736 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_TEST_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_TEST_SCHEMA"} */
show objects in DE_MINI_PROJECT_DB.TEST_SCHEMA limit 10000;
[0m21:51:11.061087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:11.505423 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.444 seconds
[0m21:51:11.509942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd6e7199-c191-460e-94d1-8a34886ab727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DDF6C5300>]}
[0m21:51:11.513465 [debug] [Thread-1 (]: Began running node model.dbt_transformations.checkConnection
[0m21:51:11.514313 [info ] [Thread-1 (]: 1 of 1 START sql view model TEST_SCHEMA.checkConnection ........................ [RUN]
[0m21:51:11.515644 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.checkConnection'
[0m21:51:11.516257 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.checkConnection
[0m21:51:11.528301 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.checkConnection"
[0m21:51:11.529782 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.checkConnection
[0m21:51:11.563892 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.checkConnection"
[0m21:51:11.565475 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.checkConnection"
[0m21:51:11.565972 [debug] [Thread-1 (]: On model.dbt_transformations.checkConnection: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.checkConnection"} */
create or replace   view DE_MINI_PROJECT_DB.TEST_SCHEMA.checkConnection
  
   as (
    SELECT * FROM DBT_MINI_PROJECT_DB.TEST_SCHEMA.customers$
  );
[0m21:51:11.566424 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:51:12.027232 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafbd5-3201-7e57-000c-4ad20001a822
[0m21:51:12.028533 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'DBT_MINI_PROJECT_DB' does not exist or not authorized.
[0m21:51:12.040933 [debug] [Thread-1 (]: Database Error in model checkConnection (models\checkConnection.sql)
  002003 (02000): SQL compilation error:
  Database 'DBT_MINI_PROJECT_DB' does not exist or not authorized.
  compiled code at target\run\dbt_transformations\models\checkConnection.sql
[0m21:51:12.043626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd6e7199-c191-460e-94d1-8a34886ab727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DDFA55C10>]}
[0m21:51:12.044493 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model TEST_SCHEMA.checkConnection ............... [[31mERROR[0m in 0.53s]
[0m21:51:12.045771 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.checkConnection
[0m21:51:12.046573 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.checkConnection' to be skipped because of status 'error'.  Reason: Database Error in model checkConnection (models\checkConnection.sql)
  002003 (02000): SQL compilation error:
  Database 'DBT_MINI_PROJECT_DB' does not exist or not authorized.
  compiled code at target\run\dbt_transformations\models\checkConnection.sql.
[0m21:51:12.049023 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:12.049418 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m21:51:12.049776 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m21:51:12.156901 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_TEST_SCHEMA' was left open.
[0m21:51:12.157393 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_TEST_SCHEMA: Close
[0m21:51:12.261490 [debug] [MainThread]: Connection 'model.dbt_transformations.checkConnection' was left open.
[0m21:51:12.262438 [debug] [MainThread]: On model.dbt_transformations.checkConnection: Close
[0m21:51:12.379330 [info ] [MainThread]: 
[0m21:51:12.381944 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m21:51:12.385894 [debug] [MainThread]: Command end result
[0m21:51:12.423992 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m21:51:12.426620 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m21:51:12.433673 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m21:51:12.434205 [info ] [MainThread]: 
[0m21:51:12.435276 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:51:12.436357 [info ] [MainThread]: 
[0m21:51:12.437587 [error] [MainThread]:   Database Error in model checkConnection (models\checkConnection.sql)
  002003 (02000): SQL compilation error:
  Database 'DBT_MINI_PROJECT_DB' does not exist or not authorized.
  compiled code at target\run\dbt_transformations\models\checkConnection.sql
[0m21:51:12.438627 [info ] [MainThread]: 
[0m21:51:12.439588 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:51:12.440992 [debug] [MainThread]: Command `dbt run` failed at 21:51:12.440833 after 4.15 seconds
[0m21:51:12.441443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DDFA2DA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DDFB74370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027DDFB74410>]}
[0m21:51:12.441893 [debug] [MainThread]: Flushing usage events
[0m21:51:13.452489 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:51:30.845222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C93D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C74F1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8CB10FED0>]}


============================== 21:51:30.850120 | f6d6203a-41c4-40e5-9d46-6cb349dcbcb9 ==============================
[0m21:51:30.850120 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:51:30.851181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m checkConnection', 'send_anonymous_usage_stats': 'True'}
[0m21:51:31.288848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6d6203a-41c4-40e5-9d46-6cb349dcbcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8CB93DBA0>]}
[0m21:51:31.355713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6d6203a-41c4-40e5-9d46-6cb349dcbcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8CB815E10>]}
[0m21:51:31.356960 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m21:51:31.801320 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:51:31.980620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:51:31.981341 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\source.yml
[0m21:51:32.357757 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_transformations.example
[0m21:51:32.370335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6d6203a-41c4-40e5-9d46-6cb349dcbcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8CB877C50>]}
[0m21:51:32.500079 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m21:51:32.504376 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m21:51:32.528975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6d6203a-41c4-40e5-9d46-6cb349dcbcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C766B6B0>]}
[0m21:51:32.529575 [info ] [MainThread]: Found 1 model, 1 source, 472 macros
[0m21:51:32.530481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6d6203a-41c4-40e5-9d46-6cb349dcbcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8CB974130>]}
[0m21:51:32.532140 [info ] [MainThread]: 
[0m21:51:32.532884 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:51:32.533562 [info ] [MainThread]: 
[0m21:51:32.534457 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:51:32.535688 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m21:51:32.640150 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m21:51:32.640622 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m21:51:32.641015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:33.326373 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.685 seconds
[0m21:51:33.336240 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_TEST_SCHEMA'
[0m21:51:33.365245 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_TEST_SCHEMA"
[0m21:51:33.365973 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_TEST_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_TEST_SCHEMA"} */
show objects in DE_MINI_PROJECT_DB.TEST_SCHEMA limit 10000;
[0m21:51:33.366554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:33.930053 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.563 seconds
[0m21:51:33.933895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6d6203a-41c4-40e5-9d46-6cb349dcbcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8CBFDFD40>]}
[0m21:51:33.937326 [debug] [Thread-1 (]: Began running node model.dbt_transformations.checkConnection
[0m21:51:33.938182 [info ] [Thread-1 (]: 1 of 1 START sql view model TEST_SCHEMA.checkConnection ........................ [RUN]
[0m21:51:33.939230 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.checkConnection'
[0m21:51:33.939816 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.checkConnection
[0m21:51:33.954143 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.checkConnection"
[0m21:51:33.955400 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.checkConnection
[0m21:51:34.002863 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.checkConnection"
[0m21:51:34.004444 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.checkConnection"
[0m21:51:34.004982 [debug] [Thread-1 (]: On model.dbt_transformations.checkConnection: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.checkConnection"} */
create or replace   view DE_MINI_PROJECT_DB.TEST_SCHEMA.checkConnection
  
   as (
    SELECT * FROM DE_MINI_PROJECT_DB.TEST_SCHEMA.customers$
  );
[0m21:51:34.005431 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:51:34.589800 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m21:51:34.622518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6d6203a-41c4-40e5-9d46-6cb349dcbcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8CD261910>]}
[0m21:51:34.623420 [info ] [Thread-1 (]: 1 of 1 OK created sql view model TEST_SCHEMA.checkConnection ................... [[32mSUCCESS 1[0m in 0.68s]
[0m21:51:34.624730 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.checkConnection
[0m21:51:34.626443 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:34.626830 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m21:51:34.627192 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m21:51:34.733677 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_TEST_SCHEMA' was left open.
[0m21:51:34.734171 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_TEST_SCHEMA: Close
[0m21:51:34.836364 [debug] [MainThread]: Connection 'model.dbt_transformations.checkConnection' was left open.
[0m21:51:34.837412 [debug] [MainThread]: On model.dbt_transformations.checkConnection: Close
[0m21:51:34.942360 [info ] [MainThread]: 
[0m21:51:34.943379 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.41 seconds (2.41s).
[0m21:51:34.944707 [debug] [MainThread]: Command end result
[0m21:51:34.969477 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m21:51:34.971938 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m21:51:34.980426 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m21:51:34.980925 [info ] [MainThread]: 
[0m21:51:34.982038 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:51:34.982915 [info ] [MainThread]: 
[0m21:51:34.983816 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:51:34.985072 [debug] [MainThread]: Command `dbt run` succeeded at 21:51:34.984936 after 4.27 seconds
[0m21:51:34.985487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8CD252570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8CBC00FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8C73C5130>]}
[0m21:51:34.985893 [debug] [MainThread]: Flushing usage events
[0m21:51:35.940847 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:52:24.960746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213229E1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002131FB61310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021324807ED0>]}


============================== 21:52:24.972078 | 83783af6-c7f9-4290-a7ad-721b3f297385 ==============================
[0m21:52:24.972078 [info ] [MainThread]: Running with dbt=1.9.2
[0m21:52:24.973315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m checkConnection', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:52:25.834960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83783af6-c7f9-4290-a7ad-721b3f297385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132514DBA0>]}
[0m21:52:25.948452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83783af6-c7f9-4290-a7ad-721b3f297385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021325029E10>]}
[0m21:52:25.950265 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m21:52:26.764137 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m21:52:27.183468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:52:27.184308 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:52:27.199614 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_transformations.example
[0m21:52:27.259044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83783af6-c7f9-4290-a7ad-721b3f297385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021325085950>]}
[0m21:52:27.371777 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m21:52:27.383491 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m21:52:27.451116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83783af6-c7f9-4290-a7ad-721b3f297385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002131FCDB6B0>]}
[0m21:52:27.451832 [info ] [MainThread]: Found 1 model, 1 source, 472 macros
[0m21:52:27.452576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83783af6-c7f9-4290-a7ad-721b3f297385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021325417230>]}
[0m21:52:27.456389 [info ] [MainThread]: 
[0m21:52:27.457467 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:52:27.458521 [info ] [MainThread]: 
[0m21:52:27.460277 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:52:27.463790 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m21:52:27.594398 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m21:52:27.595039 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m21:52:27.595454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:28.393020 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.797 seconds
[0m21:52:28.397461 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_TEST_SCHEMA'
[0m21:52:28.473318 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_TEST_SCHEMA"
[0m21:52:28.473844 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_TEST_SCHEMA: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_TEST_SCHEMA"} */
show objects in DE_MINI_PROJECT_DB.TEST_SCHEMA limit 10000;
[0m21:52:28.474231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:52:28.856209 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.382 seconds
[0m21:52:28.862205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83783af6-c7f9-4290-a7ad-721b3f297385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213256E3BA0>]}
[0m21:52:28.866568 [debug] [Thread-1 (]: Began running node model.dbt_transformations.checkConnection
[0m21:52:28.867197 [info ] [Thread-1 (]: 1 of 1 START sql view model TEST_SCHEMA.checkConnection ........................ [RUN]
[0m21:52:28.868260 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.checkConnection'
[0m21:52:28.868708 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.checkConnection
[0m21:52:28.876461 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.checkConnection"
[0m21:52:28.877742 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.checkConnection
[0m21:52:28.913279 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.checkConnection"
[0m21:52:28.914870 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.checkConnection"
[0m21:52:28.915379 [debug] [Thread-1 (]: On model.dbt_transformations.checkConnection: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.checkConnection"} */
create or replace   view DE_MINI_PROJECT_DB.TEST_SCHEMA.checkConnection
  
   as (
    SELECT * FROM DE_MINI_PROJECT_DB.TEST_SCHEMA.customers$
  );
[0m21:52:28.915811 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:52:29.394158 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.478 seconds
[0m21:52:29.425861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83783af6-c7f9-4290-a7ad-721b3f297385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213259C0350>]}
[0m21:52:29.426637 [info ] [Thread-1 (]: 1 of 1 OK created sql view model TEST_SCHEMA.checkConnection ................... [[32mSUCCESS 1[0m in 0.56s]
[0m21:52:29.427836 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.checkConnection
[0m21:52:29.429484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:52:29.429837 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m21:52:29.430183 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m21:52:29.540625 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_TEST_SCHEMA' was left open.
[0m21:52:29.541111 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_TEST_SCHEMA: Close
[0m21:52:29.657713 [debug] [MainThread]: Connection 'model.dbt_transformations.checkConnection' was left open.
[0m21:52:29.659353 [debug] [MainThread]: On model.dbt_transformations.checkConnection: Close
[0m21:52:29.781275 [info ] [MainThread]: 
[0m21:52:29.783722 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m21:52:29.787314 [debug] [MainThread]: Command end result
[0m21:52:29.818038 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m21:52:29.820433 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m21:52:29.827246 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m21:52:29.827650 [info ] [MainThread]: 
[0m21:52:29.828761 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:52:29.829726 [info ] [MainThread]: 
[0m21:52:29.830494 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:52:29.831673 [debug] [MainThread]: Command `dbt run` succeeded at 21:52:29.831531 after 5.49 seconds
[0m21:52:29.832095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021325A40470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002132512BE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021325128690>]}
[0m21:52:29.832529 [debug] [MainThread]: Flushing usage events
[0m21:52:30.856189 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:46:53.220235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259188D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025915A35310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591A60BED0>]}


============================== 10:46:53.243515 | cff9e87b-52fa-42e5-89cd-564e0e0cc509 ==============================
[0m10:46:53.243515 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:46:53.245665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:46:56.988198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cff9e87b-52fa-42e5-89cd-564e0e0cc509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591AE4DBA0>]}
[0m10:46:57.057343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cff9e87b-52fa-42e5-89cd-564e0e0cc509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591AD29E10>]}
[0m10:46:57.067384 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m10:46:57.705929 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:46:57.814243 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:46:57.815155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cff9e87b-52fa-42e5-89cd-564e0e0cc509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591AD85550>]}
[0m10:47:00.708350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cff9e87b-52fa-42e5-89cd-564e0e0cc509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591B1C9D60>]}
[0m10:47:00.782362 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m10:47:00.810089 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m10:47:01.167729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cff9e87b-52fa-42e5-89cd-564e0e0cc509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591B2F74D0>]}
[0m10:47:01.168340 [info ] [MainThread]: Found 1 model, 1 source, 472 macros
[0m10:47:01.169262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cff9e87b-52fa-42e5-89cd-564e0e0cc509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591B12F2B0>]}
[0m10:47:01.171004 [info ] [MainThread]: 
[0m10:47:01.171740 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:47:01.172401 [info ] [MainThread]: 
[0m10:47:01.173237 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:47:01.174336 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m10:47:04.906616 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m10:47:04.907070 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m10:47:04.907430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:07.293314 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.386 seconds
[0m10:47:07.295681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB, now create_DE_MINI_PROJECT_DB_TEST_SCHEMA_staging)
[0m10:47:07.296769 [debug] [ThreadPool]: Creating schema "database: "DE_MINI_PROJECT_DB"
schema: "TEST_SCHEMA_staging"
"
[0m10:47:07.302461 [debug] [ThreadPool]: Using snowflake connection "create_DE_MINI_PROJECT_DB_TEST_SCHEMA_staging"
[0m10:47:07.302865 [debug] [ThreadPool]: On create_DE_MINI_PROJECT_DB_TEST_SCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "create_DE_MINI_PROJECT_DB_TEST_SCHEMA_staging"} */
create schema if not exists DE_MINI_PROJECT_DB.TEST_SCHEMA_staging
[0m10:47:07.399332 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.096 seconds
[0m10:47:07.407087 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_TEST_SCHEMA_staging'
[0m10:47:07.420487 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_TEST_SCHEMA_staging"
[0m10:47:07.420903 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_TEST_SCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_TEST_SCHEMA_staging"} */
show objects in DE_MINI_PROJECT_DB.TEST_SCHEMA_staging limit 10000;
[0m10:47:07.421269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:47:07.847174 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.426 seconds
[0m10:47:07.851379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cff9e87b-52fa-42e5-89cd-564e0e0cc509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591B0E6B10>]}
[0m10:47:07.860714 [debug] [Thread-1 (]: Began running node model.dbt_transformations.stg_customers
[0m10:47:07.862669 [info ] [Thread-1 (]: 1 of 1 START sql table model TEST_SCHEMA_staging.customers ..................... [RUN]
[0m10:47:07.865503 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.stg_customers'
[0m10:47:07.866946 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.stg_customers
[0m10:47:07.877146 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.stg_customers"
[0m10:47:07.879089 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.stg_customers
[0m10:47:07.914678 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.stg_customers"
[0m10:47:07.917087 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.stg_customers"
[0m10:47:07.917699 [debug] [Thread-1 (]: On model.dbt_transformations.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.stg_customers"} */
create or replace transient table DE_MINI_PROJECT_DB.TEST_SCHEMA_staging.customers
         as
        (

SELECT
    CAST(customer_id AS INT),
    customer_name,
    company
FROM 
    DE_MINI_PROJECT_DB.TEST_SCHEMA.customers$
WHERE
    customer_id IS NOT NULL
    AND customer_name IS NOT NULL
    AND company IS NOT NULL
        );
[0m10:47:07.918186 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:47:08.462883 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafedd-3201-7e56-000c-4ad20001f08a
[0m10:47:08.463397 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m10:47:08.471193 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\dbt_transformations\models\staging\stg_customers.sql
[0m10:47:08.482886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cff9e87b-52fa-42e5-89cd-564e0e0cc509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591B9C9D30>]}
[0m10:47:08.483715 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model TEST_SCHEMA_staging.customers ............ [[31mERROR[0m in 0.61s]
[0m10:47:08.484994 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.stg_customers
[0m10:47:08.485894 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\dbt_transformations\models\staging\stg_customers.sql.
[0m10:47:08.488135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:47:08.488499 [debug] [MainThread]: Connection 'create_DE_MINI_PROJECT_DB_TEST_SCHEMA_staging' was left open.
[0m10:47:08.488878 [debug] [MainThread]: On create_DE_MINI_PROJECT_DB_TEST_SCHEMA_staging: Close
[0m10:47:08.598829 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_TEST_SCHEMA_staging' was left open.
[0m10:47:08.599281 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_TEST_SCHEMA_staging: Close
[0m10:47:08.707951 [debug] [MainThread]: Connection 'model.dbt_transformations.stg_customers' was left open.
[0m10:47:08.708391 [debug] [MainThread]: On model.dbt_transformations.stg_customers: Close
[0m10:47:08.824132 [info ] [MainThread]: 
[0m10:47:08.825673 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.65 seconds (7.65s).
[0m10:47:08.826856 [debug] [MainThread]: Command end result
[0m10:47:08.854667 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m10:47:08.857387 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m10:47:08.866624 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m10:47:08.867133 [info ] [MainThread]: 
[0m10:47:08.868136 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:47:08.868930 [info ] [MainThread]: 
[0m10:47:08.869744 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\dbt_transformations\models\staging\stg_customers.sql
[0m10:47:08.870496 [info ] [MainThread]: 
[0m10:47:08.871228 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:47:08.872519 [debug] [MainThread]: Command `dbt run` failed at 10:47:08.872382 after 15.91 seconds
[0m10:47:08.872947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591B0EDE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591B7E3260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002591A596550>]}
[0m10:47:08.873383 [debug] [MainThread]: Flushing usage events
[0m10:47:09.889151 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:48:08.761328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9978D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9949F5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A99960FED0>]}


============================== 10:48:08.766194 | 95f09550-b077-424d-9b39-327a3f979b17 ==============================
[0m10:48:08.766194 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:48:08.767360 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m10:48:09.267118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95f09550-b077-424d-9b39-327a3f979b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A999E3DBA0>]}
[0m10:48:09.338810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95f09550-b077-424d-9b39-327a3f979b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A999D19E10>]}
[0m10:48:09.340286 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m10:48:09.820289 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:48:10.008093 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:48:10.008743 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\staging\stg_customers.sql
[0m10:48:10.291375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95f09550-b077-424d-9b39-327a3f979b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A999D76C50>]}
[0m10:48:10.363143 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m10:48:10.367872 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m10:48:10.396275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95f09550-b077-424d-9b39-327a3f979b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A994B6B6B0>]}
[0m10:48:10.396923 [info ] [MainThread]: Found 1 model, 1 source, 472 macros
[0m10:48:10.397766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95f09550-b077-424d-9b39-327a3f979b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A99A102970>]}
[0m10:48:10.399647 [info ] [MainThread]: 
[0m10:48:10.401217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:48:10.401971 [info ] [MainThread]: 
[0m10:48:10.402879 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:48:10.404022 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m10:48:10.574371 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m10:48:10.574818 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m10:48:10.575216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:11.465075 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.890 seconds
[0m10:48:11.474153 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_TEST_SCHEMA_staging'
[0m10:48:11.494479 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_TEST_SCHEMA_staging"
[0m10:48:11.495138 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_TEST_SCHEMA_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_TEST_SCHEMA_staging"} */
show objects in DE_MINI_PROJECT_DB.TEST_SCHEMA_staging limit 10000;
[0m10:48:11.495708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:48:12.082770 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.587 seconds
[0m10:48:12.090360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95f09550-b077-424d-9b39-327a3f979b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A99A6EBEE0>]}
[0m10:48:12.098471 [debug] [Thread-1 (]: Began running node model.dbt_transformations.stg_customers
[0m10:48:12.100618 [info ] [Thread-1 (]: 1 of 1 START sql table model TEST_SCHEMA_staging.customers ..................... [RUN]
[0m10:48:12.103851 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.stg_customers'
[0m10:48:12.105549 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.stg_customers
[0m10:48:12.115328 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.stg_customers"
[0m10:48:12.116573 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.stg_customers
[0m10:48:12.153871 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.stg_customers"
[0m10:48:12.155525 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.stg_customers"
[0m10:48:12.156014 [debug] [Thread-1 (]: On model.dbt_transformations.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.stg_customers"} */
create or replace transient table DE_MINI_PROJECT_DB.TEST_SCHEMA_staging.customers
         as
        (

SELECT
    CAST(customer_id AS INT) AS customer_id,
    customer_name,
    company
FROM 
    DE_MINI_PROJECT_DB.TEST_SCHEMA.customers$
WHERE
    customer_id IS NOT NULL
    AND customer_name IS NOT NULL
    AND company IS NOT NULL
        );
[0m10:48:12.156480 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:48:13.515458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.359 seconds
[0m10:48:13.556996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95f09550-b077-424d-9b39-327a3f979b17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A99A6FD550>]}
[0m10:48:13.557769 [info ] [Thread-1 (]: 1 of 1 OK created sql table model TEST_SCHEMA_staging.customers ................ [[32mSUCCESS 1[0m in 1.45s]
[0m10:48:13.559112 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.stg_customers
[0m10:48:13.560957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:48:13.561384 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m10:48:13.561745 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m10:48:13.684776 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_TEST_SCHEMA_staging' was left open.
[0m10:48:13.686288 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_TEST_SCHEMA_staging: Close
[0m10:48:13.799595 [debug] [MainThread]: Connection 'model.dbt_transformations.stg_customers' was left open.
[0m10:48:13.800048 [debug] [MainThread]: On model.dbt_transformations.stg_customers: Close
[0m10:48:13.911263 [info ] [MainThread]: 
[0m10:48:13.912291 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.51 seconds (3.51s).
[0m10:48:13.913703 [debug] [MainThread]: Command end result
[0m10:48:13.940465 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m10:48:13.943654 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m10:48:13.951083 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m10:48:13.951524 [info ] [MainThread]: 
[0m10:48:13.952595 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:48:13.953383 [info ] [MainThread]: 
[0m10:48:13.954190 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:48:13.955531 [debug] [MainThread]: Command `dbt run` succeeded at 10:48:13.955389 after 5.35 seconds
[0m10:48:13.955963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A99A711910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A99A76ECB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A99A76C910>]}
[0m10:48:13.956400 [debug] [MainThread]: Flushing usage events
[0m10:48:14.970890 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:54:24.872421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A718BF1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A715D81310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A71AA0BED0>]}


============================== 10:54:24.877834 | 5607cc4b-626b-4f2a-9145-668eb078a874 ==============================
[0m10:54:24.877834 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:54:24.879018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_customers', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:54:25.425128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5607cc4b-626b-4f2a-9145-668eb078a874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A71B23DBA0>]}
[0m10:54:25.498688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5607cc4b-626b-4f2a-9145-668eb078a874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A71B119E10>]}
[0m10:54:25.500070 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m10:54:26.056796 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:54:26.184433 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:54:26.185462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5607cc4b-626b-4f2a-9145-668eb078a874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A71B175550>]}
[0m10:54:27.621150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5607cc4b-626b-4f2a-9145-668eb078a874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A71B5307D0>]}
[0m10:54:27.695335 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m10:54:27.700748 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m10:54:27.744142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5607cc4b-626b-4f2a-9145-668eb078a874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A71B70B4D0>]}
[0m10:54:27.744705 [info ] [MainThread]: Found 1 model, 1 source, 473 macros
[0m10:54:27.745567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5607cc4b-626b-4f2a-9145-668eb078a874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A71A8F8940>]}
[0m10:54:27.747339 [info ] [MainThread]: 
[0m10:54:27.748432 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:54:27.749725 [info ] [MainThread]: 
[0m10:54:27.750958 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:54:27.752349 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m10:54:27.916345 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m10:54:27.916989 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m10:54:27.917492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:28.712843 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.795 seconds
[0m10:54:28.714913 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB, now create_DE_MINI_PROJECT_DB_staging)
[0m10:54:28.715527 [debug] [ThreadPool]: Creating schema "database: "DE_MINI_PROJECT_DB"
schema: "staging"
"
[0m10:54:28.720273 [debug] [ThreadPool]: Using snowflake connection "create_DE_MINI_PROJECT_DB_staging"
[0m10:54:28.720722 [debug] [ThreadPool]: On create_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "create_DE_MINI_PROJECT_DB_staging"} */
create schema if not exists DE_MINI_PROJECT_DB.staging
[0m10:54:28.842442 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.121 seconds
[0m10:54:28.844928 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m10:54:28.855997 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m10:54:28.856524 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m10:54:28.856947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:29.271561 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.414 seconds
[0m10:54:29.278860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5607cc4b-626b-4f2a-9145-668eb078a874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A71B4D7AD0>]}
[0m10:54:29.286955 [debug] [Thread-1 (]: Began running node model.dbt_transformations.stg_customers
[0m10:54:29.289182 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.customers ................................. [RUN]
[0m10:54:29.292333 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.stg_customers'
[0m10:54:29.294046 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.stg_customers
[0m10:54:29.303865 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.stg_customers"
[0m10:54:29.305143 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.stg_customers
[0m10:54:29.341561 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.stg_customers"
[0m10:54:29.343168 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.stg_customers"
[0m10:54:29.343651 [debug] [Thread-1 (]: On model.dbt_transformations.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.stg_customers"} */
create or replace transient table DE_MINI_PROJECT_DB.staging.customers
         as
        (

SELECT
    CAST(customer_id AS INT) AS customer_id,
    customer_name,
    company
FROM 
    DE_MINI_PROJECT_DB.TEST_SCHEMA.customers$
WHERE
    customer_id IS NOT NULL
    AND customer_name IS NOT NULL
    AND company IS NOT NULL
        );
[0m10:54:29.344078 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:54:29.749163 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafee4-3201-7e57-000c-4ad20001ab22
[0m10:54:29.749673 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Schema 'DE_MINI_PROJECT_DB.TEST_SCHEMA' does not exist or not authorized.
[0m10:54:29.756669 [debug] [Thread-1 (]: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (02000): SQL compilation error:
  Schema 'DE_MINI_PROJECT_DB.TEST_SCHEMA' does not exist or not authorized.
  compiled code at target\run\dbt_transformations\models\staging\stg_customers.sql
[0m10:54:29.758758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5607cc4b-626b-4f2a-9145-668eb078a874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A71BBF6200>]}
[0m10:54:29.759456 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model staging.customers ........................ [[31mERROR[0m in 0.47s]
[0m10:54:29.760629 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.stg_customers
[0m10:54:29.761322 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.stg_customers' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (02000): SQL compilation error:
  Schema 'DE_MINI_PROJECT_DB.TEST_SCHEMA' does not exist or not authorized.
  compiled code at target\run\dbt_transformations\models\staging\stg_customers.sql.
[0m10:54:29.763379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:54:29.763734 [debug] [MainThread]: Connection 'create_DE_MINI_PROJECT_DB_staging' was left open.
[0m10:54:29.764081 [debug] [MainThread]: On create_DE_MINI_PROJECT_DB_staging: Close
[0m10:54:29.865079 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m10:54:29.866439 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m10:54:29.985533 [debug] [MainThread]: Connection 'model.dbt_transformations.stg_customers' was left open.
[0m10:54:29.986698 [debug] [MainThread]: On model.dbt_transformations.stg_customers: Close
[0m10:54:30.097400 [info ] [MainThread]: 
[0m10:54:30.099964 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m10:54:30.103909 [debug] [MainThread]: Command end result
[0m10:54:30.141704 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m10:54:30.144272 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m10:54:30.152314 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m10:54:30.153370 [info ] [MainThread]: 
[0m10:54:30.154370 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:54:30.155160 [info ] [MainThread]: 
[0m10:54:30.155934 [error] [MainThread]:   Database Error in model stg_customers (models\staging\stg_customers.sql)
  002003 (02000): SQL compilation error:
  Schema 'DE_MINI_PROJECT_DB.TEST_SCHEMA' does not exist or not authorized.
  compiled code at target\run\dbt_transformations\models\staging\stg_customers.sql
[0m10:54:30.156674 [info ] [MainThread]: 
[0m10:54:30.157421 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:54:30.158902 [debug] [MainThread]: Command `dbt run` failed at 10:54:30.158710 after 5.56 seconds
[0m10:54:30.159492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A71B4E9E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A71BDAA4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A71B6E0050>]}
[0m10:54:30.160046 [debug] [MainThread]: Flushing usage events
[0m10:54:31.297141 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:54:55.288584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5C9D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E59AA5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5E70BED0>]}


============================== 10:54:55.293871 | 2132ce72-a6e6-45c8-b2ed-76d5d20e53af ==============================
[0m10:54:55.293871 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:54:55.295117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:54:55.767301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2132ce72-a6e6-45c8-b2ed-76d5d20e53af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5EF3DBA0>]}
[0m10:54:55.836417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2132ce72-a6e6-45c8-b2ed-76d5d20e53af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5EE19E10>]}
[0m10:54:55.837762 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m10:54:56.333703 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:54:56.541961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:54:56.542757 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\source.yml
[0m10:54:56.965128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2132ce72-a6e6-45c8-b2ed-76d5d20e53af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5EE77250>]}
[0m10:54:57.092417 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m10:54:57.097335 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m10:54:57.123940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2132ce72-a6e6-45c8-b2ed-76d5d20e53af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E59C1B6B0>]}
[0m10:54:57.124492 [info ] [MainThread]: Found 1 model, 1 source, 473 macros
[0m10:54:57.125327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2132ce72-a6e6-45c8-b2ed-76d5d20e53af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5EF74130>]}
[0m10:54:57.127173 [info ] [MainThread]: 
[0m10:54:57.128153 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:54:57.128914 [info ] [MainThread]: 
[0m10:54:57.129979 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:54:57.131408 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m10:54:57.264218 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m10:54:57.264704 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m10:54:57.265096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:58.084950 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.820 seconds
[0m10:54:58.087925 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m10:54:58.100115 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m10:54:58.100603 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m10:54:58.100962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:58.523264 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.422 seconds
[0m10:54:58.526566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2132ce72-a6e6-45c8-b2ed-76d5d20e53af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5F5EBC70>]}
[0m10:54:58.530624 [debug] [Thread-1 (]: Began running node model.dbt_transformations.stg_customers
[0m10:54:58.531625 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.customers ................................. [RUN]
[0m10:54:58.533135 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.stg_customers'
[0m10:54:58.533831 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.stg_customers
[0m10:54:58.547458 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.stg_customers"
[0m10:54:58.548714 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.stg_customers
[0m10:54:58.585736 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.stg_customers"
[0m10:54:58.587341 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.stg_customers"
[0m10:54:58.587828 [debug] [Thread-1 (]: On model.dbt_transformations.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.stg_customers"} */
create or replace transient table DE_MINI_PROJECT_DB.staging.customers
         as
        (

SELECT
    CAST(customer_id AS INT) AS customer_id,
    customer_name,
    company
FROM 
    DE_MINI_PROJECT_DB.RAW.customers$
WHERE
    customer_id IS NOT NULL
    AND customer_name IS NOT NULL
    AND company IS NOT NULL
        );
[0m10:54:58.588265 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:54:59.319277 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.731 seconds
[0m10:54:59.360891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2132ce72-a6e6-45c8-b2ed-76d5d20e53af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5F8593D0>]}
[0m10:54:59.361642 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.customers ............................ [[32mSUCCESS 1[0m in 0.83s]
[0m10:54:59.362882 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.stg_customers
[0m10:54:59.364550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:54:59.364905 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m10:54:59.365248 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m10:54:59.474739 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m10:54:59.476134 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m10:54:59.582005 [debug] [MainThread]: Connection 'model.dbt_transformations.stg_customers' was left open.
[0m10:54:59.582467 [debug] [MainThread]: On model.dbt_transformations.stg_customers: Close
[0m10:54:59.690607 [info ] [MainThread]: 
[0m10:54:59.693448 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m10:54:59.697729 [debug] [MainThread]: Command end result
[0m10:54:59.731177 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m10:54:59.734196 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m10:54:59.741080 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m10:54:59.741473 [info ] [MainThread]: 
[0m10:54:59.742451 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:54:59.743267 [info ] [MainThread]: 
[0m10:54:59.744057 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:54:59.745434 [debug] [MainThread]: Command `dbt run` succeeded at 10:54:59.745290 after 4.61 seconds
[0m10:54:59.745894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5F845FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5F96C690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E5F96CC30>]}
[0m10:54:59.746722 [debug] [MainThread]: Flushing usage events
[0m10:55:00.729897 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:57:00.353760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207EC4D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E9635310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207EE203ED0>]}


============================== 10:57:00.364483 | 6c6625c2-9691-43a4-98ce-8bc67594de3e ==============================
[0m10:57:00.364483 [info ] [MainThread]: Running with dbt=1.9.2
[0m10:57:00.365684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_customers', 'send_anonymous_usage_stats': 'True'}
[0m10:57:01.142353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c6625c2-9691-43a4-98ce-8bc67594de3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207EEA4DBA0>]}
[0m10:57:01.217144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c6625c2-9691-43a4-98ce-8bc67594de3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207EE929E10>]}
[0m10:57:01.218846 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m10:57:01.739825 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m10:57:01.993285 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m10:57:01.993860 [debug] [MainThread]: Partial parsing: added file: dbt_transformations://models\staging\stg_countryRegion.sql
[0m10:57:01.994336 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\staging\stg_customers.sql
[0m10:57:02.318171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c6625c2-9691-43a4-98ce-8bc67594de3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207EE985750>]}
[0m10:57:02.395540 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m10:57:02.400618 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m10:57:02.448773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c6625c2-9691-43a4-98ce-8bc67594de3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207E97AB6B0>]}
[0m10:57:02.449400 [info ] [MainThread]: Found 2 models, 1 source, 473 macros
[0m10:57:02.450366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c6625c2-9691-43a4-98ce-8bc67594de3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207EED10910>]}
[0m10:57:02.453231 [info ] [MainThread]: 
[0m10:57:02.454305 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:57:02.455194 [info ] [MainThread]: 
[0m10:57:02.456388 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:57:02.457936 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m10:57:02.665933 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m10:57:02.666437 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m10:57:02.666840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:03.596138 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.929 seconds
[0m10:57:03.619820 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m10:57:03.637862 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m10:57:03.638399 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m10:57:03.638804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:04.065047 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.426 seconds
[0m10:57:04.067258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c6625c2-9691-43a4-98ce-8bc67594de3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F03E7C70>]}
[0m10:57:04.071091 [debug] [Thread-1 (]: Began running node model.dbt_transformations.stg_customers
[0m10:57:04.071722 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_customers ............................. [RUN]
[0m10:57:04.072733 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.stg_customers'
[0m10:57:04.073209 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.stg_customers
[0m10:57:04.081258 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.stg_customers"
[0m10:57:04.082663 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.stg_customers
[0m10:57:04.118277 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.stg_customers"
[0m10:57:04.120726 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.stg_customers"
[0m10:57:04.121410 [debug] [Thread-1 (]: On model.dbt_transformations.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.stg_customers"} */
create or replace transient table DE_MINI_PROJECT_DB.staging.stg_customers
         as
        (SELECT
    CAST(customer_id AS INT) AS customer_id,
    customer_name,
    company
FROM 
    DE_MINI_PROJECT_DB.RAW.customers$
WHERE
    customer_id IS NOT NULL
    AND customer_name IS NOT NULL
    AND company IS NOT NULL
        );
[0m10:57:04.122022 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:57:05.154172 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.032 seconds
[0m10:57:05.181458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c6625c2-9691-43a4-98ce-8bc67594de3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F03FDB50>]}
[0m10:57:05.182261 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_customers ........................ [[32mSUCCESS 1[0m in 1.11s]
[0m10:57:05.183429 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.stg_customers
[0m10:57:05.185248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:05.185647 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m10:57:05.186011 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m10:57:05.318953 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m10:57:05.319898 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m10:57:05.430501 [debug] [MainThread]: Connection 'model.dbt_transformations.stg_customers' was left open.
[0m10:57:05.430974 [debug] [MainThread]: On model.dbt_transformations.stg_customers: Close
[0m10:57:05.585467 [info ] [MainThread]: 
[0m10:57:05.586352 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m10:57:05.588855 [debug] [MainThread]: Command end result
[0m10:57:05.613379 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m10:57:05.616185 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m10:57:05.623785 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m10:57:05.624350 [info ] [MainThread]: 
[0m10:57:05.625510 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:57:05.626624 [info ] [MainThread]: 
[0m10:57:05.627674 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:57:05.629295 [debug] [MainThread]: Command `dbt run` succeeded at 10:57:05.629133 after 5.43 seconds
[0m10:57:05.629743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207F0404E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207EEA99590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207EEA9B6B0>]}
[0m10:57:05.630184 [debug] [MainThread]: Flushing usage events
[0m10:57:06.708999 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:07:51.951139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4294D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4275F5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42B20BED0>]}


============================== 11:07:51.966137 | fe72592a-2d4d-4f3d-90df-4906deb0c459 ==============================
[0m11:07:51.966137 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:07:51.967143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_countryRegion', 'send_anonymous_usage_stats': 'True'}
[0m11:07:55.292504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe72592a-2d4d-4f3d-90df-4906deb0c459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42BA3DBA0>]}
[0m11:07:55.357785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe72592a-2d4d-4f3d-90df-4906deb0c459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42B919E10>]}
[0m11:07:55.367152 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:07:55.983673 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:07:57.516054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:07:57.516841 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\source.yml
[0m11:07:57.517316 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\staging\stg_countryRegion.sql
[0m11:07:57.932233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe72592a-2d4d-4f3d-90df-4906deb0c459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42B977250>]}
[0m11:07:58.060845 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m11:07:58.078787 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m11:07:58.385875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe72592a-2d4d-4f3d-90df-4906deb0c459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42776B6B0>]}
[0m11:07:58.386409 [info ] [MainThread]: Found 2 models, 2 sources, 473 macros
[0m11:07:58.387259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe72592a-2d4d-4f3d-90df-4906deb0c459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42BA75390>]}
[0m11:07:58.388947 [info ] [MainThread]: 
[0m11:07:58.389690 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:07:58.390352 [info ] [MainThread]: 
[0m11:07:58.391190 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:07:58.392274 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m11:08:01.776492 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m11:08:01.776946 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m11:08:01.777345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:02.707265 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.930 seconds
[0m11:08:02.713934 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m11:08:02.725397 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m11:08:02.725836 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m11:08:02.726230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:03.100134 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.374 seconds
[0m11:08:03.104071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe72592a-2d4d-4f3d-90df-4906deb0c459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42D0E6C30>]}
[0m11:08:03.106764 [debug] [Thread-1 (]: Began running node model.dbt_transformations.stg_countryRegion
[0m11:08:03.107399 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_countryRegion ......................... [RUN]
[0m11:08:03.108386 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.stg_countryRegion'
[0m11:08:03.108848 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.stg_countryRegion
[0m11:08:03.119864 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.stg_countryRegion"
[0m11:08:03.121393 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.stg_countryRegion
[0m11:08:03.157460 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.stg_countryRegion"
[0m11:08:03.159671 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.stg_countryRegion"
[0m11:08:03.160372 [debug] [Thread-1 (]: On model.dbt_transformations.stg_countryRegion: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.stg_countryRegion"} */
create or replace transient table DE_MINI_PROJECT_DB.staging.stg_countryRegion
         as
        (SELECT 
    CAST(customer_id AS INT) AS customer_id,
    country,
    region
FROM
    DE_MINI_PROJECT_DB.RAW.countryRegion
WHERE   
    customer_id IS NOT NULL
    AND country IS NOT NULL
    AND region IS NOT NULL
        );
[0m11:08:03.160827 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:08:03.975127 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.814 seconds
[0m11:08:04.030017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe72592a-2d4d-4f3d-90df-4906deb0c459', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42D35D910>]}
[0m11:08:04.030860 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_countryRegion .................... [[32mSUCCESS 1[0m in 0.91s]
[0m11:08:04.032019 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.stg_countryRegion
[0m11:08:04.033630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:04.033983 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m11:08:04.034323 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m11:08:04.136671 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m11:08:04.137343 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m11:08:04.247119 [debug] [MainThread]: Connection 'model.dbt_transformations.stg_countryRegion' was left open.
[0m11:08:04.248067 [debug] [MainThread]: On model.dbt_transformations.stg_countryRegion: Close
[0m11:08:04.372332 [info ] [MainThread]: 
[0m11:08:04.373292 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.98 seconds (5.98s).
[0m11:08:04.374440 [debug] [MainThread]: Command end result
[0m11:08:04.398719 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m11:08:04.401372 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m11:08:04.408857 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m11:08:04.409338 [info ] [MainThread]: 
[0m11:08:04.410322 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:08:04.411221 [info ] [MainThread]: 
[0m11:08:04.412093 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:08:04.413899 [debug] [MainThread]: Command `dbt run` succeeded at 11:08:04.413637 after 12.72 seconds
[0m11:08:04.414404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42D34E620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42D488A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42D488C30>]}
[0m11:08:04.414921 [debug] [MainThread]: Flushing usage events
[0m11:08:05.371940 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:11:29.165131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C64C01A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C61D85310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C66A0FED0>]}


============================== 11:11:29.172384 | 5dbb78df-2d28-4e00-959a-e3757617f43b ==============================
[0m11:11:29.172384 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:11:29.173414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_products', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:11:29.674740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dbb78df-2d28-4e00-959a-e3757617f43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C6723DBA0>]}
[0m11:11:29.744692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dbb78df-2d28-4e00-959a-e3757617f43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C67119E10>]}
[0m11:11:29.745986 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:11:30.236895 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:11:30.447433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:11:30.448070 [debug] [MainThread]: Partial parsing: added file: dbt_transformations://models\staging\stg_products.sql
[0m11:11:30.448729 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\source.yml
[0m11:11:30.853667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dbb78df-2d28-4e00-959a-e3757617f43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C67176D50>]}
[0m11:11:30.981962 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m11:11:30.986619 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m11:11:31.013312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dbb78df-2d28-4e00-959a-e3757617f43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C61EFB6B0>]}
[0m11:11:31.013861 [info ] [MainThread]: Found 3 models, 3 sources, 473 macros
[0m11:11:31.014773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dbb78df-2d28-4e00-959a-e3757617f43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C67276430>]}
[0m11:11:31.016564 [info ] [MainThread]: 
[0m11:11:31.017319 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:11:31.017989 [info ] [MainThread]: 
[0m11:11:31.018840 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:11:31.019970 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m11:11:31.136535 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m11:11:31.136989 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m11:11:31.137409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:31.936465 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.799 seconds
[0m11:11:31.943444 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m11:11:31.954285 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m11:11:31.954760 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m11:11:31.955136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:32.430180 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.475 seconds
[0m11:11:32.440815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dbb78df-2d28-4e00-959a-e3757617f43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C66FAF930>]}
[0m11:11:32.448147 [debug] [Thread-1 (]: Began running node model.dbt_transformations.stg_products
[0m11:11:32.449951 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_products .............................. [RUN]
[0m11:11:32.452647 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.stg_products'
[0m11:11:32.454047 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.stg_products
[0m11:11:32.468964 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.stg_products"
[0m11:11:32.471475 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.stg_products
[0m11:11:32.504943 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.stg_products"
[0m11:11:32.506894 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.stg_products"
[0m11:11:32.507402 [debug] [Thread-1 (]: On model.dbt_transformations.stg_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.stg_products"} */
create or replace transient table DE_MINI_PROJECT_DB.staging.stg_products
         as
        (SELECT
    *
FROM
    DE_MINI_PROJECT_DB.RAW.products$
WHERE
    product_id IS NOT NULL
    AND product_family IS NOT NULL
    AND product_sub_family IS NOT NULL
        );
[0m11:11:32.507843 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:11:33.318237 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.810 seconds
[0m11:11:33.345795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dbb78df-2d28-4e00-959a-e3757617f43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C67B55910>]}
[0m11:11:33.346561 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_products ......................... [[32mSUCCESS 1[0m in 0.89s]
[0m11:11:33.347698 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.stg_products
[0m11:11:33.349260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:33.349625 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m11:11:33.349978 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m11:11:33.457907 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m11:11:33.458371 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m11:11:33.557762 [debug] [MainThread]: Connection 'model.dbt_transformations.stg_products' was left open.
[0m11:11:33.558258 [debug] [MainThread]: On model.dbt_transformations.stg_products: Close
[0m11:11:33.665377 [info ] [MainThread]: 
[0m11:11:33.668001 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.65 seconds (2.65s).
[0m11:11:33.671952 [debug] [MainThread]: Command end result
[0m11:11:33.712967 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m11:11:33.715641 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m11:11:33.722713 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m11:11:33.723131 [info ] [MainThread]: 
[0m11:11:33.723966 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:11:33.724646 [info ] [MainThread]: 
[0m11:11:33.725338 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:11:33.726805 [debug] [MainThread]: Command `dbt run` succeeded at 11:11:33.726642 after 4.71 seconds
[0m11:11:33.727272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C67B42620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C67C74FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014C67C74910>]}
[0m11:11:33.727784 [debug] [MainThread]: Flushing usage events
[0m11:11:35.516273 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:51:19.537810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002361D0D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002361C2B5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002361DE0FED0>]}


============================== 11:51:19.557352 | 5c70d3d6-93c7-4aa3-9aa6-b88bb2cb9097 ==============================
[0m11:51:19.557352 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:51:19.558432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:51:23.059021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c70d3d6-93c7-4aa3-9aa6-b88bb2cb9097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002361F64DBA0>]}
[0m11:51:23.125678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c70d3d6-93c7-4aa3-9aa6-b88bb2cb9097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002361F529E10>]}
[0m11:51:23.136760 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:51:23.761228 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:51:25.366339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 4 files changed.
[0m11:51:25.366932 [debug] [MainThread]: Partial parsing: added file: dbt_transformations://models\staging\stg_transactions.sql
[0m11:51:25.367642 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\source.yml
[0m11:51:25.368067 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\staging\stg_customers.sql
[0m11:51:25.368523 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\staging\stg_countryRegion.sql
[0m11:51:25.368929 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\staging\stg_products.sql
[0m11:51:25.773276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c70d3d6-93c7-4aa3-9aa6-b88bb2cb9097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002361F587E50>]}
[0m11:51:25.895762 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m11:51:25.914312 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m11:51:26.224942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c70d3d6-93c7-4aa3-9aa6-b88bb2cb9097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002361C41B6B0>]}
[0m11:51:26.225509 [info ] [MainThread]: Found 4 models, 4 sources, 473 macros
[0m11:51:26.226458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c70d3d6-93c7-4aa3-9aa6-b88bb2cb9097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002361DCEB150>]}
[0m11:51:26.228693 [info ] [MainThread]: 
[0m11:51:26.229540 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:51:26.230291 [info ] [MainThread]: 
[0m11:51:26.231131 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:51:26.237734 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m11:51:29.991087 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m11:51:29.991559 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m11:51:29.991954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:31.002656 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.010 seconds
[0m11:51:31.012060 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m11:51:31.022143 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m11:51:31.022543 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m11:51:31.022872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:31.419196 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.396 seconds
[0m11:51:31.421491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c70d3d6-93c7-4aa3-9aa6-b88bb2cb9097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002361FAFFAD0>]}
[0m11:51:31.424362 [debug] [Thread-1 (]: Began running node model.dbt_transformations.stg_countryRegion
[0m11:51:31.424941 [info ] [Thread-1 (]: 1 of 4 START sql table model staging.stg_countryRegion ......................... [RUN]
[0m11:51:31.426028 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.stg_countryRegion'
[0m11:51:31.426459 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.stg_countryRegion
[0m11:51:31.437230 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.stg_countryRegion"
[0m11:51:31.438623 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.stg_countryRegion
[0m11:51:31.475150 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.stg_countryRegion"
[0m11:51:31.477206 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.stg_countryRegion"
[0m11:51:31.477755 [debug] [Thread-1 (]: On model.dbt_transformations.stg_countryRegion: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.stg_countryRegion"} */
create or replace transient table DE_MINI_PROJECT_DB.staging.stg_countryRegion
         as
        (WITH country_clean_cte AS(
    SELECT 
        CAST(customer_id AS INT) AS customer_id,
        country,
        region
    FROM
        DE_MINI_PROJECT_DB.RAW.countryRegion
    WHERE   
        customer_id IS NOT NULL
        AND country IS NOT NULL
        AND region IS NOT NULL
)

SELECT 
    DISTINCT *
FROM    
    country_clean_cte
        );
[0m11:51:31.478191 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:51:32.608009 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.130 seconds
[0m11:51:32.644536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c70d3d6-93c7-4aa3-9aa6-b88bb2cb9097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023621059790>]}
[0m11:51:32.645390 [info ] [Thread-1 (]: 1 of 4 OK created sql table model staging.stg_countryRegion .................... [[32mSUCCESS 1[0m in 1.21s]
[0m11:51:32.646510 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.stg_countryRegion
[0m11:51:32.647009 [debug] [Thread-1 (]: Began running node model.dbt_transformations.stg_customers
[0m11:51:32.647549 [info ] [Thread-1 (]: 2 of 4 START sql table model staging.stg_customers ............................. [RUN]
[0m11:51:32.648447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_transformations.stg_countryRegion, now model.dbt_transformations.stg_customers)
[0m11:51:32.648884 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.stg_customers
[0m11:51:32.652038 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.stg_customers"
[0m11:51:32.653828 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.stg_customers
[0m11:51:32.657013 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.stg_customers"
[0m11:51:32.658924 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.stg_customers"
[0m11:51:32.659463 [debug] [Thread-1 (]: On model.dbt_transformations.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.stg_customers"} */
create or replace transient table DE_MINI_PROJECT_DB.staging.stg_customers
         as
        (WITH customers_clean_cte AS(
    SELECT
        CAST(customer_id AS INT) AS customer_id,
        customer_name,
        company
    FROM 
        DE_MINI_PROJECT_DB.RAW.customers$
    WHERE
        customer_id IS NOT NULL
        AND customer_name IS NOT NULL
        AND company IS NOT NULL
)

SELECT  
    DISTINCT *
FROM
    customers_clean_cte
        );
[0m11:51:33.318837 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.658 seconds
[0m11:51:33.322032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c70d3d6-93c7-4aa3-9aa6-b88bb2cb9097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023621042780>]}
[0m11:51:33.322742 [info ] [Thread-1 (]: 2 of 4 OK created sql table model staging.stg_customers ........................ [[32mSUCCESS 1[0m in 0.67s]
[0m11:51:33.323906 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.stg_customers
[0m11:51:33.324378 [debug] [Thread-1 (]: Began running node model.dbt_transformations.stg_products
[0m11:51:33.324907 [info ] [Thread-1 (]: 3 of 4 START sql table model staging.stg_products .............................. [RUN]
[0m11:51:33.325769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_transformations.stg_customers, now model.dbt_transformations.stg_products)
[0m11:51:33.326207 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.stg_products
[0m11:51:33.328874 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.stg_products"
[0m11:51:33.330018 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.stg_products
[0m11:51:33.332487 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.stg_products"
[0m11:51:33.334249 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.stg_products"
[0m11:51:33.334840 [debug] [Thread-1 (]: On model.dbt_transformations.stg_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.stg_products"} */
create or replace transient table DE_MINI_PROJECT_DB.staging.stg_products
         as
        (SELECT
    DISTINCT *
FROM
    DE_MINI_PROJECT_DB.RAW.products$
WHERE
    product_id IS NOT NULL
    AND product_family IS NOT NULL
    AND product_sub_family IS NOT NULL
        );
[0m11:51:33.774599 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.439 seconds
[0m11:51:33.777862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c70d3d6-93c7-4aa3-9aa6-b88bb2cb9097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002362122A7B0>]}
[0m11:51:33.778524 [info ] [Thread-1 (]: 3 of 4 OK created sql table model staging.stg_products ......................... [[32mSUCCESS 1[0m in 0.45s]
[0m11:51:33.779615 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.stg_products
[0m11:51:33.780073 [debug] [Thread-1 (]: Began running node model.dbt_transformations.stg_transactions
[0m11:51:33.780581 [info ] [Thread-1 (]: 4 of 4 START sql table model staging.stg_transactions .......................... [RUN]
[0m11:51:33.781382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_transformations.stg_products, now model.dbt_transformations.stg_transactions)
[0m11:51:33.781800 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.stg_transactions
[0m11:51:33.785039 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.stg_transactions"
[0m11:51:33.787145 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.stg_transactions
[0m11:51:33.790704 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.stg_transactions"
[0m11:51:33.793772 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.stg_transactions"
[0m11:51:33.794329 [debug] [Thread-1 (]: On model.dbt_transformations.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.stg_transactions"} */
create or replace transient table DE_MINI_PROJECT_DB.staging.stg_transactions
         as
        (WITH transactions_clean_cte AS(
    SELECT
        CAST(customer_id AS INT) AS customer_id,
        product_id,
        CAST(payment_month AS DATE) AS payment_month,
        CAST(revenue_type AS INT) AS revenue_type,
        CAST(revenue AS FLOAT) AS revenue,
        CAST(quantity AS INT) AS quantity,
        companies AS company
    FROM
        DE_MINI_PROJECT_DB.RAW.transactions$
 )   

 SELECT 
    DISTINCT *
FROM
    transactions_clean_cte
        );
[0m11:51:34.058543 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baff1d-3201-7d7b-000c-4ad20001d37a
[0m11:51:34.059068 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DE_MINI_PROJECT_DB.RAW."TRANSACTIONS$"' does not exist or not authorized.
[0m11:51:34.068179 [debug] [Thread-1 (]: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'DE_MINI_PROJECT_DB.RAW."TRANSACTIONS$"' does not exist or not authorized.
  compiled code at target\run\dbt_transformations\models\staging\stg_transactions.sql
[0m11:51:34.068857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c70d3d6-93c7-4aa3-9aa6-b88bb2cb9097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236211382D0>]}
[0m11:51:34.069577 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model staging.stg_transactions ................. [[31mERROR[0m in 0.29s]
[0m11:51:34.070695 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.stg_transactions
[0m11:51:34.071394 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.stg_transactions' to be skipped because of status 'error'.  Reason: Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'DE_MINI_PROJECT_DB.RAW."TRANSACTIONS$"' does not exist or not authorized.
  compiled code at target\run\dbt_transformations\models\staging\stg_transactions.sql.
[0m11:51:34.073620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:34.074096 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m11:51:34.074526 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m11:51:34.183650 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m11:51:34.184360 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m11:51:34.302900 [debug] [MainThread]: Connection 'model.dbt_transformations.stg_transactions' was left open.
[0m11:51:34.304516 [debug] [MainThread]: On model.dbt_transformations.stg_transactions: Close
[0m11:51:34.447963 [info ] [MainThread]: 
[0m11:51:34.449493 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 8.22 seconds (8.22s).
[0m11:51:34.452724 [debug] [MainThread]: Command end result
[0m11:51:34.483765 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m11:51:34.486450 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m11:51:34.494708 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m11:51:34.495152 [info ] [MainThread]: 
[0m11:51:34.496067 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:51:34.496866 [info ] [MainThread]: 
[0m11:51:34.497725 [error] [MainThread]:   Database Error in model stg_transactions (models\staging\stg_transactions.sql)
  002003 (42S02): SQL compilation error:
  Object 'DE_MINI_PROJECT_DB.RAW."TRANSACTIONS$"' does not exist or not authorized.
  compiled code at target\run\dbt_transformations\models\staging\stg_transactions.sql
[0m11:51:34.498528 [info ] [MainThread]: 
[0m11:51:34.499290 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m11:51:34.500701 [debug] [MainThread]: Command `dbt run` failed at 11:51:34.500540 after 15.16 seconds
[0m11:51:34.501163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002361DE29FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236195B1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023621148B90>]}
[0m11:51:34.501618 [debug] [MainThread]: Flushing usage events
[0m11:51:35.559634 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:53:43.280963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCD90D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCD82B5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCD9E0FED0>]}


============================== 11:53:43.285892 | 2e123d91-bd52-4e33-9ba0-5d30a932bbb8 ==============================
[0m11:53:43.285892 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:53:43.286977 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:53:43.750878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e123d91-bd52-4e33-9ba0-5d30a932bbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCDB63DBA0>]}
[0m11:53:43.818038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e123d91-bd52-4e33-9ba0-5d30a932bbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCDB515E10>]}
[0m11:53:43.819276 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:53:44.278687 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:53:44.489741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:53:44.490654 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\source.yml
[0m11:53:44.491068 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\staging\stg_transactions.sql
[0m11:53:44.883749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e123d91-bd52-4e33-9ba0-5d30a932bbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCDB577E50>]}
[0m11:53:45.007910 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m11:53:45.012247 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m11:53:45.038801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e123d91-bd52-4e33-9ba0-5d30a932bbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCDB4D68A0>]}
[0m11:53:45.039382 [info ] [MainThread]: Found 4 models, 4 sources, 473 macros
[0m11:53:45.040302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e123d91-bd52-4e33-9ba0-5d30a932bbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCDB674130>]}
[0m11:53:45.042420 [info ] [MainThread]: 
[0m11:53:45.043183 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:53:45.043928 [info ] [MainThread]: 
[0m11:53:45.044802 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:53:45.049882 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m11:53:45.165106 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m11:53:45.165552 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m11:53:45.165966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:46.233532 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.068 seconds
[0m11:53:46.236693 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m11:53:46.246627 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m11:53:46.247027 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m11:53:46.247360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:46.636395 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.389 seconds
[0m11:53:46.641853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e123d91-bd52-4e33-9ba0-5d30a932bbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCDBB23860>]}
[0m11:53:46.644628 [debug] [Thread-1 (]: Began running node model.dbt_transformations.stg_countryRegion
[0m11:53:46.645212 [info ] [Thread-1 (]: 1 of 4 START sql table model staging.stg_countryRegion ......................... [RUN]
[0m11:53:46.646248 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.stg_countryRegion'
[0m11:53:46.646675 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.stg_countryRegion
[0m11:53:46.657470 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.stg_countryRegion"
[0m11:53:46.659428 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.stg_countryRegion
[0m11:53:46.693825 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.stg_countryRegion"
[0m11:53:46.695589 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.stg_countryRegion"
[0m11:53:46.696094 [debug] [Thread-1 (]: On model.dbt_transformations.stg_countryRegion: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.stg_countryRegion"} */
create or replace transient table DE_MINI_PROJECT_DB.staging.stg_countryRegion
         as
        (WITH country_clean_cte AS(
    SELECT 
        CAST(customer_id AS INT) AS customer_id,
        country,
        region
    FROM
        DE_MINI_PROJECT_DB.RAW.countryRegion
    WHERE   
        customer_id IS NOT NULL
        AND country IS NOT NULL
        AND region IS NOT NULL
)

SELECT 
    DISTINCT *
FROM    
    country_clean_cte
        );
[0m11:53:46.696547 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:53:47.445951 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.749 seconds
[0m11:53:47.473010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e123d91-bd52-4e33-9ba0-5d30a932bbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCDBF5D910>]}
[0m11:53:47.473763 [info ] [Thread-1 (]: 1 of 4 OK created sql table model staging.stg_countryRegion .................... [[32mSUCCESS 1[0m in 0.83s]
[0m11:53:47.474910 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.stg_countryRegion
[0m11:53:47.475379 [debug] [Thread-1 (]: Began running node model.dbt_transformations.stg_customers
[0m11:53:47.475898 [info ] [Thread-1 (]: 2 of 4 START sql table model staging.stg_customers ............................. [RUN]
[0m11:53:47.476810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_transformations.stg_countryRegion, now model.dbt_transformations.stg_customers)
[0m11:53:47.477333 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.stg_customers
[0m11:53:47.480018 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.stg_customers"
[0m11:53:47.481250 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.stg_customers
[0m11:53:47.484703 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.stg_customers"
[0m11:53:47.487349 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.stg_customers"
[0m11:53:47.488204 [debug] [Thread-1 (]: On model.dbt_transformations.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.stg_customers"} */
create or replace transient table DE_MINI_PROJECT_DB.staging.stg_customers
         as
        (WITH customers_clean_cte AS(
    SELECT
        CAST(customer_id AS INT) AS customer_id,
        customer_name,
        company
    FROM 
        DE_MINI_PROJECT_DB.RAW.customers$
    WHERE
        customer_id IS NOT NULL
        AND customer_name IS NOT NULL
        AND company IS NOT NULL
)

SELECT  
    DISTINCT *
FROM
    customers_clean_cte
        );
[0m11:53:47.932618 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.444 seconds
[0m11:53:47.935219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e123d91-bd52-4e33-9ba0-5d30a932bbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCDBAE0C00>]}
[0m11:53:47.936075 [info ] [Thread-1 (]: 2 of 4 OK created sql table model staging.stg_customers ........................ [[32mSUCCESS 1[0m in 0.46s]
[0m11:53:47.937424 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.stg_customers
[0m11:53:47.937981 [debug] [Thread-1 (]: Began running node model.dbt_transformations.stg_products
[0m11:53:47.938602 [info ] [Thread-1 (]: 3 of 4 START sql table model staging.stg_products .............................. [RUN]
[0m11:53:47.939588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_transformations.stg_customers, now model.dbt_transformations.stg_products)
[0m11:53:47.940124 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.stg_products
[0m11:53:47.943241 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.stg_products"
[0m11:53:47.944485 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.stg_products
[0m11:53:47.947022 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.stg_products"
[0m11:53:47.948647 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.stg_products"
[0m11:53:47.949102 [debug] [Thread-1 (]: On model.dbt_transformations.stg_products: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.stg_products"} */
create or replace transient table DE_MINI_PROJECT_DB.staging.stg_products
         as
        (SELECT
    DISTINCT *
FROM
    DE_MINI_PROJECT_DB.RAW.products$
WHERE
    product_id IS NOT NULL
    AND product_family IS NOT NULL
    AND product_sub_family IS NOT NULL
        );
[0m11:53:48.446217 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.497 seconds
[0m11:53:48.448772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e123d91-bd52-4e33-9ba0-5d30a932bbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCDD07D090>]}
[0m11:53:48.449466 [info ] [Thread-1 (]: 3 of 4 OK created sql table model staging.stg_products ......................... [[32mSUCCESS 1[0m in 0.51s]
[0m11:53:48.450694 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.stg_products
[0m11:53:48.451199 [debug] [Thread-1 (]: Began running node model.dbt_transformations.stg_transactions
[0m11:53:48.451781 [info ] [Thread-1 (]: 4 of 4 START sql table model staging.stg_transactions .......................... [RUN]
[0m11:53:48.452716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_transformations.stg_products, now model.dbt_transformations.stg_transactions)
[0m11:53:48.453128 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.stg_transactions
[0m11:53:48.455924 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.stg_transactions"
[0m11:53:48.457088 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.stg_transactions
[0m11:53:48.459407 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.stg_transactions"
[0m11:53:48.461197 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.stg_transactions"
[0m11:53:48.461649 [debug] [Thread-1 (]: On model.dbt_transformations.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.stg_transactions"} */
create or replace transient table DE_MINI_PROJECT_DB.staging.stg_transactions
         as
        (WITH transactions_clean_cte AS(
    SELECT
        CAST(customer_id AS INT) AS customer_id,
        product_id,
        CAST(payment_month AS DATE) AS payment_month,
        CAST(revenue_type AS INT) AS revenue_type,
        CAST(revenue AS FLOAT) AS revenue,
        CAST(quantity AS INT) AS quantity,
        companies AS company
    FROM
        DE_MINI_PROJECT_DB.RAW.transaction$
 )   

 SELECT 
    DISTINCT *
FROM
    transactions_clean_cte
        );
[0m11:53:49.204804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.743 seconds
[0m11:53:49.207637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e123d91-bd52-4e33-9ba0-5d30a932bbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCDBDD03D0>]}
[0m11:53:49.208299 [info ] [Thread-1 (]: 4 of 4 OK created sql table model staging.stg_transactions ..................... [[32mSUCCESS 1[0m in 0.75s]
[0m11:53:49.209458 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.stg_transactions
[0m11:53:49.210990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:49.211339 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m11:53:49.211679 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m11:53:49.315049 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m11:53:49.315512 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m11:53:49.418242 [debug] [MainThread]: Connection 'model.dbt_transformations.stg_transactions' was left open.
[0m11:53:49.419843 [debug] [MainThread]: On model.dbt_transformations.stg_transactions: Close
[0m11:53:49.547423 [info ] [MainThread]: 
[0m11:53:49.550215 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 4.50 seconds (4.50s).
[0m11:53:49.556856 [debug] [MainThread]: Command end result
[0m11:53:49.581335 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m11:53:49.584040 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m11:53:49.593073 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m11:53:49.593522 [info ] [MainThread]: 
[0m11:53:49.594391 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:53:49.595112 [info ] [MainThread]: 
[0m11:53:49.595857 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m11:53:49.597180 [debug] [MainThread]: Command `dbt run` succeeded at 11:53:49.597039 after 6.54 seconds
[0m11:53:49.597609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCD9E29FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCD55B1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCD8F97AD0>]}
[0m11:53:49.598041 [debug] [MainThread]: Flushing usage events
[0m11:53:50.622150 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:37.496458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F34D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F05F1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F520FED0>]}


============================== 11:58:37.513935 | d774c93e-3d98-46b6-991f-2d829e29520f ==============================
[0m11:58:37.513935 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:58:37.515218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_transactions', 'send_anonymous_usage_stats': 'True'}
[0m11:58:41.244245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd774c93e-3d98-46b6-991f-2d829e29520f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F5A3DBA0>]}
[0m11:58:41.347192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd774c93e-3d98-46b6-991f-2d829e29520f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F5919E10>]}
[0m11:58:41.357718 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m11:58:42.033971 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:58:43.851895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:58:43.852576 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\staging\stg_transactions.sql
[0m11:58:44.147673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd774c93e-3d98-46b6-991f-2d829e29520f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F5976F50>]}
[0m11:58:44.224864 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m11:58:44.244086 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m11:58:44.552468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd774c93e-3d98-46b6-991f-2d829e29520f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F076B6B0>]}
[0m11:58:44.553096 [info ] [MainThread]: Found 4 models, 4 sources, 473 macros
[0m11:58:44.553912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd774c93e-3d98-46b6-991f-2d829e29520f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F5D017F0>]}
[0m11:58:44.555853 [info ] [MainThread]: 
[0m11:58:44.556676 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:58:44.557405 [info ] [MainThread]: 
[0m11:58:44.558335 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:58:44.560184 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m11:58:48.545200 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m11:58:48.545699 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m11:58:48.546089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:49.548087 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.002 seconds
[0m11:58:49.555946 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m11:58:49.567539 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m11:58:49.568041 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m11:58:49.568442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:49.965225 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.397 seconds
[0m11:58:49.968576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd774c93e-3d98-46b6-991f-2d829e29520f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F711F2B0>]}
[0m11:58:49.971675 [debug] [Thread-1 (]: Began running node model.dbt_transformations.stg_transactions
[0m11:58:49.972376 [info ] [Thread-1 (]: 1 of 1 START sql table model staging.stg_transactions .......................... [RUN]
[0m11:58:49.973710 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.stg_transactions'
[0m11:58:49.974179 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.stg_transactions
[0m11:58:49.982062 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.stg_transactions"
[0m11:58:49.983461 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.stg_transactions
[0m11:58:50.023531 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.stg_transactions"
[0m11:58:50.026911 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.stg_transactions"
[0m11:58:50.027478 [debug] [Thread-1 (]: On model.dbt_transformations.stg_transactions: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.stg_transactions"} */
create or replace transient table DE_MINI_PROJECT_DB.staging.stg_transactions
         as
        (WITH transactions_clean_cte AS(
    SELECT
        CAST(customer_id AS INT) AS customer_id,
        product_id,
        CAST(payment_month AS DATE) AS payment_month,
        CAST(revenue_type AS INT) AS revenue_type,
        CAST(revenue AS FLOAT) AS revenue,
        CAST(quantity AS INT) AS quantity,
        companies AS company
    FROM
        DE_MINI_PROJECT_DB.RAW.transaction$
    WHERE
        customer_id IS NOT NULL
        AND product_id IS NOT NULL
        AND payment_month IS NOT NULL
        AND revenue_type IS NOT NULL
        AND revenue IS NOT NULL
        AND quantity IS NOT NULL
        AND company IS NOT NULL
 )   

 SELECT 
    DISTINCT *
FROM
    transactions_clean_cte
        );
[0m11:58:50.027937 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:58:51.136635 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.109 seconds
[0m11:58:51.176302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd774c93e-3d98-46b6-991f-2d829e29520f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F7319D90>]}
[0m11:58:51.177146 [info ] [Thread-1 (]: 1 of 1 OK created sql table model staging.stg_transactions ..................... [[32mSUCCESS 1[0m in 1.19s]
[0m11:58:51.178494 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.stg_transactions
[0m11:58:51.180181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:51.180578 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m11:58:51.180941 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m11:58:51.289100 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m11:58:51.289704 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m11:58:51.407825 [debug] [MainThread]: Connection 'model.dbt_transformations.stg_transactions' was left open.
[0m11:58:51.408368 [debug] [MainThread]: On model.dbt_transformations.stg_transactions: Close
[0m11:58:51.509406 [info ] [MainThread]: 
[0m11:58:51.510587 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.95 seconds (6.95s).
[0m11:58:51.512188 [debug] [MainThread]: Command end result
[0m11:58:51.546722 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m11:58:51.550511 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m11:58:51.564975 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m11:58:51.565555 [info ] [MainThread]: 
[0m11:58:51.567764 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:58:51.569271 [info ] [MainThread]: 
[0m11:58:51.570534 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:58:51.575739 [debug] [MainThread]: Command `dbt run` succeeded at 11:58:51.575382 after 14.31 seconds
[0m11:58:51.576449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F731CE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F5A894F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218F5A8B6B0>]}
[0m11:58:51.576991 [debug] [MainThread]: Flushing usage events
[0m11:58:52.860896 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:35:24.265606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020157FF1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201571B5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020158D37ED0>]}


============================== 15:35:24.285687 | 9eabe64c-1793-4390-a625-5ecadf587c97 ==============================
[0m15:35:24.285687 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:35:24.286864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prep_customer_churn', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:35:27.841443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9eabe64c-1793-4390-a625-5ecadf587c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015A63DBA0>]}
[0m15:35:27.908403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9eabe64c-1793-4390-a625-5ecadf587c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015A519E10>]}
[0m15:35:27.917757 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:35:28.558974 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:35:28.674447 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:35:28.675377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9eabe64c-1793-4390-a625-5ecadf587c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015A575550>]}
[0m15:35:31.441501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9eabe64c-1793-4390-a625-5ecadf587c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015A932E40>]}
[0m15:35:31.514466 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m15:35:31.535145 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m15:35:31.848141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9eabe64c-1793-4390-a625-5ecadf587c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015AAFFA10>]}
[0m15:35:31.848795 [info ] [MainThread]: Found 5 models, 4 sources, 473 macros
[0m15:35:31.849724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eabe64c-1793-4390-a625-5ecadf587c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015A926750>]}
[0m15:35:31.851441 [info ] [MainThread]: 
[0m15:35:31.852199 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:35:31.852877 [info ] [MainThread]: 
[0m15:35:31.853732 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:35:31.854797 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m15:35:35.374700 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m15:35:35.375230 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m15:35:35.375606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:36.448261 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.073 seconds
[0m15:35:36.450768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB, now create_DE_MINI_PROJECT_DB_preparation)
[0m15:35:36.451298 [debug] [ThreadPool]: Creating schema "database: "DE_MINI_PROJECT_DB"
schema: "preparation"
"
[0m15:35:36.455777 [debug] [ThreadPool]: Using snowflake connection "create_DE_MINI_PROJECT_DB_preparation"
[0m15:35:36.456152 [debug] [ThreadPool]: On create_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "create_DE_MINI_PROJECT_DB_preparation"} */
create schema if not exists DE_MINI_PROJECT_DB.preparation
[0m15:35:36.586678 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.130 seconds
[0m15:35:36.596569 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_preparation'
[0m15:35:36.607033 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m15:35:36.607427 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m15:35:36.607761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:37.036589 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.428 seconds
[0m15:35:37.039964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_preparation, now list_DE_MINI_PROJECT_DB_staging)
[0m15:35:37.041978 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m15:35:37.042352 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m15:35:37.130897 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.088 seconds
[0m15:35:37.141887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9eabe64c-1793-4390-a625-5ecadf587c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015A8DF7D0>]}
[0m15:35:37.149885 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_customer_churn
[0m15:35:37.152004 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_customer_churn ................... [RUN]
[0m15:35:37.155136 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_customer_churn'
[0m15:35:37.156803 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_customer_churn
[0m15:35:37.178434 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_customer_churn"
[0m15:35:37.180975 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_customer_churn
[0m15:35:37.216633 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_customer_churn"
[0m15:35:37.219446 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_customer_churn"
[0m15:35:37.219983 [debug] [Thread-1 (]: On model.dbt_transformations.prep_customer_churn: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_customer_churn"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_customer_churn
         as
        (WITH transactions_customers_joined_cte AS(
    SELECT
        customer_id,
        customer_name,
        revenue_type,
        revenue,
        SUM(revenue) OVER(PARTITION BY customer_id) AS total_revenue
    FROM
        DE_MINI_PROJECT_DB.staging.stg_transactions
    INNER JOIN 
        DE_MINI_PROJECT_DB.staging.stg_customers
        USING(customer_id)
)

WITH rank_customers_cte AS (
    SELECT  
        customer_id,
        customer_name,
        DENSE_RANK() OVER(ORDER BY total_revenue DESC) AS customer_rank
    FROM    
        transactions_customers_joined_cte
    WHERE
        revenue_type=1
    GROUP BY    
        customer_id,customer_name
)

SELECT
    *
FROM
    rank_customers_cte
        );
[0m15:35:37.220486 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:35:37.807329 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafffd-3201-7e57-000c-4ad200020302
[0m15:35:37.807851 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 0 unexpected 'WITH'.
syntax error line 21 at position 21 unexpected 'OVER'.
[0m15:35:37.815962 [debug] [Thread-1 (]: Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 0 unexpected 'WITH'.
  syntax error line 21 at position 21 unexpected 'OVER'.
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql
[0m15:35:37.826139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9eabe64c-1793-4390-a625-5ecadf587c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015AFF2410>]}
[0m15:35:37.827234 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model preparation.prep_customer_churn .......... [[31mERROR[0m in 0.66s]
[0m15:35:37.828633 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_customer_churn
[0m15:35:37.829388 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.prep_customer_churn' to be skipped because of status 'error'.  Reason: Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 0 unexpected 'WITH'.
  syntax error line 21 at position 21 unexpected 'OVER'.
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql.
[0m15:35:37.831779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:37.832161 [debug] [MainThread]: Connection 'create_DE_MINI_PROJECT_DB_preparation' was left open.
[0m15:35:37.832506 [debug] [MainThread]: On create_DE_MINI_PROJECT_DB_preparation: Close
[0m15:35:37.942100 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m15:35:37.943599 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m15:35:38.056267 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_customer_churn' was left open.
[0m15:35:38.056919 [debug] [MainThread]: On model.dbt_transformations.prep_customer_churn: Close
[0m15:35:38.157993 [info ] [MainThread]: 
[0m15:35:38.158949 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.30 seconds (6.30s).
[0m15:35:38.160239 [debug] [MainThread]: Command end result
[0m15:35:38.193462 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m15:35:38.196741 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m15:35:38.203882 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m15:35:38.204369 [info ] [MainThread]: 
[0m15:35:38.205254 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:35:38.205990 [info ] [MainThread]: 
[0m15:35:38.206876 [error] [MainThread]:   Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 0 unexpected 'WITH'.
  syntax error line 21 at position 21 unexpected 'OVER'.
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql
[0m15:35:38.208197 [info ] [MainThread]: 
[0m15:35:38.209250 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:35:38.211055 [debug] [MainThread]: Command `dbt run` failed at 15:35:38.210846 after 14.16 seconds
[0m15:35:38.211651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015C0571B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002015C1A5BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020157F0DFD0>]}
[0m15:35:38.212135 [debug] [MainThread]: Flushing usage events
[0m15:35:39.178560 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:36:15.698131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002497CCD1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024979E55310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002497DA1FED0>]}


============================== 15:36:15.702982 | 2bfedb69-bc3f-487b-b9a6-a923da13027c ==============================
[0m15:36:15.702982 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:36:15.704072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m prep_customer_churn', 'send_anonymous_usage_stats': 'True'}
[0m15:36:16.198195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2bfedb69-bc3f-487b-b9a6-a923da13027c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002497F33DBA0>]}
[0m15:36:16.265362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2bfedb69-bc3f-487b-b9a6-a923da13027c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002497F219E10>]}
[0m15:36:16.266585 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:36:16.763264 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:36:16.972591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:36:16.973237 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\preparation\prep_customer_churn.sql
[0m15:36:17.265643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2bfedb69-bc3f-487b-b9a6-a923da13027c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002497F277150>]}
[0m15:36:17.342261 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m15:36:17.346868 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m15:36:17.375905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2bfedb69-bc3f-487b-b9a6-a923da13027c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002497C01B6B0>]}
[0m15:36:17.376534 [info ] [MainThread]: Found 5 models, 4 sources, 473 macros
[0m15:36:17.377450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bfedb69-bc3f-487b-b9a6-a923da13027c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002497F602F90>]}
[0m15:36:17.379189 [info ] [MainThread]: 
[0m15:36:17.379987 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:36:17.380699 [info ] [MainThread]: 
[0m15:36:17.381577 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:36:17.382735 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m15:36:17.550199 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m15:36:17.550651 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m15:36:17.551022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:18.344290 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.793 seconds
[0m15:36:18.354509 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m15:36:18.365046 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m15:36:18.365475 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m15:36:18.365834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:18.801132 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.435 seconds
[0m15:36:18.808648 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_staging, now list_DE_MINI_PROJECT_DB_preparation)
[0m15:36:18.817524 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m15:36:18.817932 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m15:36:18.899213 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.081 seconds
[0m15:36:18.906215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2bfedb69-bc3f-487b-b9a6-a923da13027c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002497FA17520>]}
[0m15:36:18.914292 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_customer_churn
[0m15:36:18.916438 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_customer_churn ................... [RUN]
[0m15:36:18.919543 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_customer_churn'
[0m15:36:18.921158 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_customer_churn
[0m15:36:18.931410 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_customer_churn"
[0m15:36:18.932806 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_customer_churn
[0m15:36:18.968046 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_customer_churn"
[0m15:36:18.970259 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_customer_churn"
[0m15:36:18.970757 [debug] [Thread-1 (]: On model.dbt_transformations.prep_customer_churn: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_customer_churn"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_customer_churn
         as
        (WITH transactions_customers_joined_cte AS(
    SELECT
        customer_id,
        customer_name,
        revenue_type,
        revenue,
        SUM(revenue) OVER(PARTITION BY customer_id) AS total_revenue
    FROM
        DE_MINI_PROJECT_DB.staging.stg_transactions
    INNER JOIN 
        DE_MINI_PROJECT_DB.staging.stg_customers
        USING(customer_id)
),rank_customers_cte AS (
    SELECT  
        customer_id,
        customer_name,
        DENSE_RANK() OVER(ORDER BY total_revenue DESC) AS customer_rank
    FROM    
        transactions_customers_joined_cte
    WHERE
        revenue_type=1
    GROUP BY    
        customer_id,customer_name
)

SELECT
    *
FROM
    rank_customers_cte
        );
[0m15:36:18.971258 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:36:19.390161 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bafffe-3201-7e56-000c-4ad20001f84a
[0m15:36:19.390662 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[TRANSACTIONS_CUSTOMERS_JOINED_CTE.TOTAL_REVENUE] is not a valid group by expression
[0m15:36:19.397591 [debug] [Thread-1 (]: Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  000979 (42601): SQL compilation error:
  [TRANSACTIONS_CUSTOMERS_JOINED_CTE.TOTAL_REVENUE] is not a valid group by expression
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql
[0m15:36:19.399570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bfedb69-bc3f-487b-b9a6-a923da13027c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002497FC0D850>]}
[0m15:36:19.400295 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model preparation.prep_customer_churn .......... [[31mERROR[0m in 0.48s]
[0m15:36:19.401588 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_customer_churn
[0m15:36:19.402528 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.prep_customer_churn' to be skipped because of status 'error'.  Reason: Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  000979 (42601): SQL compilation error:
  [TRANSACTIONS_CUSTOMERS_JOINED_CTE.TOTAL_REVENUE] is not a valid group by expression
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql.
[0m15:36:19.404708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:19.405064 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m15:36:19.405411 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m15:36:19.513305 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_preparation' was left open.
[0m15:36:19.514516 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_preparation: Close
[0m15:36:19.622239 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_customer_churn' was left open.
[0m15:36:19.623182 [debug] [MainThread]: On model.dbt_transformations.prep_customer_churn: Close
[0m15:36:19.740257 [info ] [MainThread]: 
[0m15:36:19.742877 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m15:36:19.746726 [debug] [MainThread]: Command end result
[0m15:36:19.786818 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m15:36:19.789324 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m15:36:19.795984 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m15:36:19.796377 [info ] [MainThread]: 
[0m15:36:19.797347 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:36:19.798215 [info ] [MainThread]: 
[0m15:36:19.799771 [error] [MainThread]:   Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  000979 (42601): SQL compilation error:
  [TRANSACTIONS_CUSTOMERS_JOINED_CTE.TOTAL_REVENUE] is not a valid group by expression
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql
[0m15:36:19.800867 [info ] [MainThread]: 
[0m15:36:19.801740 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:36:19.803319 [debug] [MainThread]: Command `dbt run` failed at 15:36:19.803155 after 4.24 seconds
[0m15:36:19.803794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002497FC15860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024979336710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024979D21130>]}
[0m15:36:19.804260 [debug] [MainThread]: Flushing usage events
[0m15:36:21.186980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:11.563665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BB13D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BAE555310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BB3207ED0>]}


============================== 15:37:11.568962 | 390c142d-53a0-4405-883d-b7640099d35f ==============================
[0m15:37:11.568962 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:37:11.570020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prep_customer_churn', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:37:12.039182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '390c142d-53a0-4405-883d-b7640099d35f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BB3A3DBA0>]}
[0m15:37:12.105638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '390c142d-53a0-4405-883d-b7640099d35f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BB3919E10>]}
[0m15:37:12.106877 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m15:37:12.570080 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:37:12.778813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:37:12.779557 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\preparation\prep_customer_churn.sql
[0m15:37:13.068134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '390c142d-53a0-4405-883d-b7640099d35f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BB3977150>]}
[0m15:37:13.145226 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m15:37:13.171031 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m15:37:13.204463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '390c142d-53a0-4405-883d-b7640099d35f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BAE6CB6B0>]}
[0m15:37:13.205003 [info ] [MainThread]: Found 5 models, 4 sources, 473 macros
[0m15:37:13.205960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '390c142d-53a0-4405-883d-b7640099d35f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BB3D02F90>]}
[0m15:37:13.207680 [info ] [MainThread]: 
[0m15:37:13.208437 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:37:13.209136 [info ] [MainThread]: 
[0m15:37:13.210015 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:37:13.211156 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m15:37:13.377152 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m15:37:13.377584 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m15:37:13.377938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:14.248427 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.870 seconds
[0m15:37:14.255302 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m15:37:14.266206 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m15:37:14.266680 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m15:37:14.267066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:14.684948 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.418 seconds
[0m15:37:14.688300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_staging, now list_DE_MINI_PROJECT_DB_preparation)
[0m15:37:14.691862 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m15:37:14.693457 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m15:37:14.809313 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.115 seconds
[0m15:37:14.811505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '390c142d-53a0-4405-883d-b7640099d35f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BB511B520>]}
[0m15:37:14.814285 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_customer_churn
[0m15:37:14.814958 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_customer_churn ................... [RUN]
[0m15:37:14.816023 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_customer_churn'
[0m15:37:14.816505 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_customer_churn
[0m15:37:14.825353 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_customer_churn"
[0m15:37:14.827120 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_customer_churn
[0m15:37:14.862380 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_customer_churn"
[0m15:37:14.864450 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_customer_churn"
[0m15:37:14.864962 [debug] [Thread-1 (]: On model.dbt_transformations.prep_customer_churn: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_customer_churn"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_customer_churn
         as
        (WITH transactions_customers_joined_cte AS(
    SELECT
        customer_id,
        customer_name,
        revenue_type,
        revenue
    FROM
        DE_MINI_PROJECT_DB.staging.stg_transactions
    INNER JOIN 
        DE_MINI_PROJECT_DB.staging.stg_customers
        USING(customer_id)
),rank_customers_cte AS (
    SELECT  
        customer_id,
        customer_name,
        SUM(revenue) OVER(PARTITION BY customer_id) AS total_revenue
        DENSE_RANK() OVER(ORDER BY total_revenue DESC) AS customer_rank
    FROM    
        transactions_customers_joined_cte
    WHERE
        revenue_type=1
    GROUP BY    
        customer_id,customer_name
    ORDER BY    
        total_revenue
)

SELECT
    *
FROM
    rank_customers_cte
        );
[0m15:37:14.865458 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:37:15.247656 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01baffff-3201-7e57-000c-4ad20002030e
[0m15:37:15.248995 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 19 at position 8 unexpected 'DENSE_RANK'.
syntax error line 19 at position 19 unexpected ')'.
syntax error line 19 at position 21 unexpected 'OVER'.
syntax error line 19 at position 53 unexpected ')'.
[0m15:37:15.260986 [debug] [Thread-1 (]: Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 8 unexpected 'DENSE_RANK'.
  syntax error line 19 at position 19 unexpected ')'.
  syntax error line 19 at position 21 unexpected 'OVER'.
  syntax error line 19 at position 53 unexpected ')'.
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql
[0m15:37:15.263673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390c142d-53a0-4405-883d-b7640099d35f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BB5315790>]}
[0m15:37:15.264603 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model preparation.prep_customer_churn .......... [[31mERROR[0m in 0.45s]
[0m15:37:15.265879 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_customer_churn
[0m15:37:15.266688 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.prep_customer_churn' to be skipped because of status 'error'.  Reason: Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 8 unexpected 'DENSE_RANK'.
  syntax error line 19 at position 19 unexpected ')'.
  syntax error line 19 at position 21 unexpected 'OVER'.
  syntax error line 19 at position 53 unexpected ')'.
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql.
[0m15:37:15.269005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:15.269394 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m15:37:15.269748 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m15:37:15.377730 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_preparation' was left open.
[0m15:37:15.378440 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_preparation: Close
[0m15:37:15.491529 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_customer_churn' was left open.
[0m15:37:15.491952 [debug] [MainThread]: On model.dbt_transformations.prep_customer_churn: Close
[0m15:37:15.600391 [info ] [MainThread]: 
[0m15:37:15.603018 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m15:37:15.606951 [debug] [MainThread]: Command end result
[0m15:37:15.643705 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m15:37:15.646252 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m15:37:15.652945 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m15:37:15.653445 [info ] [MainThread]: 
[0m15:37:15.655030 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:37:15.656181 [info ] [MainThread]: 
[0m15:37:15.657368 [error] [MainThread]:   Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 8 unexpected 'DENSE_RANK'.
  syntax error line 19 at position 19 unexpected ')'.
  syntax error line 19 at position 21 unexpected 'OVER'.
  syntax error line 19 at position 53 unexpected ')'.
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql
[0m15:37:15.658337 [info ] [MainThread]: 
[0m15:37:15.659099 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:37:15.660650 [debug] [MainThread]: Command `dbt run` failed at 15:37:15.660500 after 4.23 seconds
[0m15:37:15.661182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BB5319860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BADA36710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018BAE421130>]}
[0m15:37:15.661629 [debug] [MainThread]: Flushing usage events
[0m15:37:16.632839 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:03:19.977901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B73D1D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B73B3C1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B73DF0BED0>]}


============================== 16:03:19.999277 | 8727cff2-fc36-45bd-9742-9e21b28f02b8 ==============================
[0m16:03:19.999277 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:03:20.000650 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m prep_customer_churn', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:03:24.046169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8727cff2-fc36-45bd-9742-9e21b28f02b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B73F73DBA0>]}
[0m16:03:24.139889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8727cff2-fc36-45bd-9742-9e21b28f02b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B73F619E10>]}
[0m16:03:24.152840 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:03:24.861582 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:03:26.614445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:03:26.615139 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\preparation\prep_customer_churn.sql
[0m16:03:26.935866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8727cff2-fc36-45bd-9742-9e21b28f02b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B73F677150>]}
[0m16:03:27.024239 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:03:27.045702 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:03:27.353445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8727cff2-fc36-45bd-9742-9e21b28f02b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B73B51B6B0>]}
[0m16:03:27.354079 [info ] [MainThread]: Found 5 models, 4 sources, 473 macros
[0m16:03:27.355050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8727cff2-fc36-45bd-9742-9e21b28f02b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B73FA02F90>]}
[0m16:03:27.357011 [info ] [MainThread]: 
[0m16:03:27.357825 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:03:27.359032 [info ] [MainThread]: 
[0m16:03:27.359946 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:03:27.361736 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m16:03:30.881142 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m16:03:30.881625 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m16:03:30.882023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:31.872382 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.990 seconds
[0m16:03:31.880515 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_preparation'
[0m16:03:31.892347 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m16:03:31.892831 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m16:03:31.893225 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:32.305305 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.412 seconds
[0m16:03:32.312013 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_preparation, now list_DE_MINI_PROJECT_DB_staging)
[0m16:03:32.319367 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m16:03:32.320847 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m16:03:32.442426 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.120 seconds
[0m16:03:32.453480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8727cff2-fc36-45bd-9742-9e21b28f02b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B73FE2F520>]}
[0m16:03:32.461640 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_customer_churn
[0m16:03:32.463759 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_customer_churn ................... [RUN]
[0m16:03:32.467096 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_customer_churn'
[0m16:03:32.468786 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_customer_churn
[0m16:03:32.480034 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_customer_churn"
[0m16:03:32.481606 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_customer_churn
[0m16:03:32.516372 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_customer_churn"
[0m16:03:32.518483 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_customer_churn"
[0m16:03:32.519024 [debug] [Thread-1 (]: On model.dbt_transformations.prep_customer_churn: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_customer_churn"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_customer_churn
         as
        (WITH transactions_customers_joined_cte AS(
    SELECT
        customer_id,
        customer_name,
        revenue_type,
        revenue
    FROM
        DE_MINI_PROJECT_DB.staging.stg_transactions
    INNER JOIN 
        DE_MINI_PROJECT_DB.staging.stg_customers
        USING(customer_id)
),rank_customers_cte AS (
    SELECT  
        customer_id,
        customer_name,
        SUM(revenue) AS total_revenue
        DENSE_RANK() OVER(ORDER BY total_revenue DESC) AS customer_rank
    FROM    
        transactions_customers_joined_cte
    WHERE
        revenue_type=1
    GROUP BY    
        customer_id,customer_name
    ORDER BY    
        total_revenue
)

SELECT
    *
FROM
    rank_customers_cte
        );
[0m16:03:32.519491 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:03:33.043723 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0019-3201-7e57-000c-4ad20002032e
[0m16:03:33.044262 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 19 at position 8 unexpected 'DENSE_RANK'.
syntax error line 19 at position 19 unexpected ')'.
syntax error line 19 at position 21 unexpected 'OVER'.
syntax error line 19 at position 53 unexpected ')'.
[0m16:03:33.053557 [debug] [Thread-1 (]: Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 8 unexpected 'DENSE_RANK'.
  syntax error line 19 at position 19 unexpected ')'.
  syntax error line 19 at position 21 unexpected 'OVER'.
  syntax error line 19 at position 53 unexpected ')'.
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql
[0m16:03:33.063874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8727cff2-fc36-45bd-9742-9e21b28f02b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B741115790>]}
[0m16:03:33.064724 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model preparation.prep_customer_churn .......... [[31mERROR[0m in 0.59s]
[0m16:03:33.065901 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_customer_churn
[0m16:03:33.066605 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.prep_customer_churn' to be skipped because of status 'error'.  Reason: Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 8 unexpected 'DENSE_RANK'.
  syntax error line 19 at position 19 unexpected ')'.
  syntax error line 19 at position 21 unexpected 'OVER'.
  syntax error line 19 at position 53 unexpected ')'.
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql.
[0m16:03:33.068752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:33.069126 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m16:03:33.069487 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m16:03:33.191736 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m16:03:33.192178 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m16:03:33.306957 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_customer_churn' was left open.
[0m16:03:33.307425 [debug] [MainThread]: On model.dbt_transformations.prep_customer_churn: Close
[0m16:03:33.411506 [info ] [MainThread]: 
[0m16:03:33.414133 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.05 seconds (6.05s).
[0m16:03:33.418060 [debug] [MainThread]: Command end result
[0m16:03:33.454810 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:03:33.457856 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:03:33.465043 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m16:03:33.465544 [info ] [MainThread]: 
[0m16:03:33.466636 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:03:33.467938 [info ] [MainThread]: 
[0m16:03:33.469128 [error] [MainThread]:   Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 19 at position 8 unexpected 'DENSE_RANK'.
  syntax error line 19 at position 19 unexpected ')'.
  syntax error line 19 at position 21 unexpected 'OVER'.
  syntax error line 19 at position 53 unexpected ')'.
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql
[0m16:03:33.470317 [info ] [MainThread]: 
[0m16:03:33.471196 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:03:33.472942 [debug] [MainThread]: Command `dbt run` failed at 16:03:33.472682 after 13.71 seconds
[0m16:03:33.473514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7411197B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B741173250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B741172DF0>]}
[0m16:03:33.473996 [debug] [MainThread]: Flushing usage events
[0m16:03:34.491818 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:04:20.605310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A9F8D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A9C9C1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AA160BED0>]}


============================== 16:04:20.610721 | d984b382-fcef-45bb-9f71-6bbc02b2ede9 ==============================
[0m16:04:20.610721 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:04:20.611797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m prep_customer_churn', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:04:21.122333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd984b382-fcef-45bb-9f71-6bbc02b2ede9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AA1E3DBA0>]}
[0m16:04:21.199248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd984b382-fcef-45bb-9f71-6bbc02b2ede9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AA1D19E10>]}
[0m16:04:21.200620 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:04:21.700980 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:04:21.923270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:04:21.923948 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\preparation\prep_customer_churn.sql
[0m16:04:22.221392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd984b382-fcef-45bb-9f71-6bbc02b2ede9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AA1D77150>]}
[0m16:04:22.298193 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:04:22.302543 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:04:22.331775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd984b382-fcef-45bb-9f71-6bbc02b2ede9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A9CB2B6B0>]}
[0m16:04:22.332338 [info ] [MainThread]: Found 5 models, 4 sources, 473 macros
[0m16:04:22.333204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd984b382-fcef-45bb-9f71-6bbc02b2ede9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AA2102F90>]}
[0m16:04:22.334941 [info ] [MainThread]: 
[0m16:04:22.335685 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:04:22.336355 [info ] [MainThread]: 
[0m16:04:22.337201 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:04:22.338318 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m16:04:22.506802 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m16:04:22.507255 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m16:04:22.507641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:23.320804 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.813 seconds
[0m16:04:23.330780 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m16:04:23.342397 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m16:04:23.342856 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m16:04:23.343220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:23.797488 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.454 seconds
[0m16:04:23.800941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_staging, now list_DE_MINI_PROJECT_DB_preparation)
[0m16:04:23.805076 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m16:04:23.805610 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m16:04:23.886781 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.080 seconds
[0m16:04:23.892293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd984b382-fcef-45bb-9f71-6bbc02b2ede9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AA251B520>]}
[0m16:04:23.898780 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_customer_churn
[0m16:04:23.900512 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_customer_churn ................... [RUN]
[0m16:04:23.903031 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_customer_churn'
[0m16:04:23.904329 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_customer_churn
[0m16:04:23.921474 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_customer_churn"
[0m16:04:23.923438 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_customer_churn
[0m16:04:23.959025 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_customer_churn"
[0m16:04:23.960996 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_customer_churn"
[0m16:04:23.961504 [debug] [Thread-1 (]: On model.dbt_transformations.prep_customer_churn: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_customer_churn"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_customer_churn
         as
        (WITH transactions_customers_joined_cte AS(
    SELECT
        customer_id,
        customer_name,
        revenue_type,
        revenue
    FROM
        DE_MINI_PROJECT_DB.staging.stg_transactions
    INNER JOIN 
        DE_MINI_PROJECT_DB.staging.stg_customers
        USING(customer_id)
)


SELECT  
    customer_id,
    customer_name,
    SUM(revenue) AS total_revenue
    DENSE_RANK() OVER(ORDER BY total_revenue DESC) AS customer_rank
FROM    
    transactions_customers_joined_cte
WHERE
    revenue_type=1
GROUP BY    
    customer_id,customer_name
ORDER BY    
    total_revenue
        );
[0m16:04:23.961971 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:04:24.343973 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb001a-3201-7eb6-000c-4ad2000220ba
[0m16:04:24.344509 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 4 unexpected 'DENSE_RANK'.
syntax error line 21 at position 49 unexpected ')'.
[0m16:04:24.351787 [debug] [Thread-1 (]: Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 4 unexpected 'DENSE_RANK'.
  syntax error line 21 at position 49 unexpected ')'.
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql
[0m16:04:24.353922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd984b382-fcef-45bb-9f71-6bbc02b2ede9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AA2715F10>]}
[0m16:04:24.354692 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model preparation.prep_customer_churn .......... [[31mERROR[0m in 0.45s]
[0m16:04:24.355913 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_customer_churn
[0m16:04:24.356623 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.prep_customer_churn' to be skipped because of status 'error'.  Reason: Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 4 unexpected 'DENSE_RANK'.
  syntax error line 21 at position 49 unexpected ')'.
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql.
[0m16:04:24.358742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:24.359106 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m16:04:24.359458 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m16:04:24.467114 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_preparation' was left open.
[0m16:04:24.467553 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_preparation: Close
[0m16:04:24.581514 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_customer_churn' was left open.
[0m16:04:24.582408 [debug] [MainThread]: On model.dbt_transformations.prep_customer_churn: Close
[0m16:04:24.683589 [info ] [MainThread]: 
[0m16:04:24.684632 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.35 seconds (2.35s).
[0m16:04:24.685931 [debug] [MainThread]: Command end result
[0m16:04:24.713695 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:04:24.716497 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:04:24.725005 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m16:04:24.725563 [info ] [MainThread]: 
[0m16:04:24.726547 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:04:24.727319 [info ] [MainThread]: 
[0m16:04:24.728178 [error] [MainThread]:   Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 4 unexpected 'DENSE_RANK'.
  syntax error line 21 at position 49 unexpected ')'.
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql
[0m16:04:24.728958 [info ] [MainThread]: 
[0m16:04:24.729740 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:04:24.731104 [debug] [MainThread]: Command `dbt run` failed at 16:04:24.730961 after 4.28 seconds
[0m16:04:24.731545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AA2718C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AA27FD630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AA27FE2B0>]}
[0m16:04:24.732014 [debug] [MainThread]: Flushing usage events
[0m16:04:25.999158 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:05:01.959590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E44D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E25E5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E620BED0>]}


============================== 16:05:01.964475 | 23c9a657-31a2-42a8-8597-2ad3025e288c ==============================
[0m16:05:01.964475 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:05:01.965510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prep_customer_churn', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:05:02.441434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23c9a657-31a2-42a8-8597-2ad3025e288c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E6A3DBA0>]}
[0m16:05:02.513332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23c9a657-31a2-42a8-8597-2ad3025e288c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E6919E10>]}
[0m16:05:02.514637 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:05:03.008003 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:05:03.219820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:05:03.220491 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\preparation\prep_customer_churn.sql
[0m16:05:03.521562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23c9a657-31a2-42a8-8597-2ad3025e288c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E6977150>]}
[0m16:05:03.601034 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:05:03.605524 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:05:03.635826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23c9a657-31a2-42a8-8597-2ad3025e288c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E275B6B0>]}
[0m16:05:03.636436 [info ] [MainThread]: Found 5 models, 4 sources, 473 macros
[0m16:05:03.637330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23c9a657-31a2-42a8-8597-2ad3025e288c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E6D06F90>]}
[0m16:05:03.639678 [info ] [MainThread]: 
[0m16:05:03.641076 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:05:03.641784 [info ] [MainThread]: 
[0m16:05:03.642904 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:05:03.644030 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m16:05:03.823621 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m16:05:03.824128 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m16:05:03.824550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:04.709031 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.884 seconds
[0m16:05:04.733561 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_preparation'
[0m16:05:04.747100 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m16:05:04.747554 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m16:05:04.747966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:05.154939 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.407 seconds
[0m16:05:05.157621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_preparation, now list_DE_MINI_PROJECT_DB_staging)
[0m16:05:05.160768 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m16:05:05.161365 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m16:05:05.239895 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.078 seconds
[0m16:05:05.244881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23c9a657-31a2-42a8-8597-2ad3025e288c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E811B520>]}
[0m16:05:05.248794 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_customer_churn
[0m16:05:05.249861 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_customer_churn ................... [RUN]
[0m16:05:05.251555 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_customer_churn'
[0m16:05:05.252377 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_customer_churn
[0m16:05:05.266440 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_customer_churn"
[0m16:05:05.267992 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_customer_churn
[0m16:05:05.309952 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_customer_churn"
[0m16:05:05.312987 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_customer_churn"
[0m16:05:05.313513 [debug] [Thread-1 (]: On model.dbt_transformations.prep_customer_churn: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_customer_churn"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_customer_churn
         as
        (WITH transactions_customers_joined_cte AS(
    SELECT
        customer_id,
        customer_name,
        revenue_type,
        revenue
    FROM
        DE_MINI_PROJECT_DB.staging.stg_transactions
    INNER JOIN 
        DE_MINI_PROJECT_DB.staging.stg_customers
        USING(customer_id)
)


SELECT  
    customer_id,
    customer_name,
    SUM(revenue) AS total_revenue
    DENSE_RANK() OVER(ORDER BY SUM(revenue) DESC) AS customer_rank
FROM    
    transactions_customers_joined_cte
WHERE
    revenue_type=1
GROUP BY    
    customer_id,customer_name
ORDER BY    
    total_revenue
        );
[0m16:05:05.313984 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:05:05.774953 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb001b-3201-7db6-000c-4ad200021236
[0m16:05:05.775733 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 4 unexpected 'DENSE_RANK'.
syntax error line 21 at position 48 unexpected ')'.
[0m16:05:05.784609 [debug] [Thread-1 (]: Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 4 unexpected 'DENSE_RANK'.
  syntax error line 21 at position 48 unexpected ')'.
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql
[0m16:05:05.786780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23c9a657-31a2-42a8-8597-2ad3025e288c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E8311F10>]}
[0m16:05:05.787576 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model preparation.prep_customer_churn .......... [[31mERROR[0m in 0.53s]
[0m16:05:05.788883 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_customer_churn
[0m16:05:05.789596 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.prep_customer_churn' to be skipped because of status 'error'.  Reason: Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 4 unexpected 'DENSE_RANK'.
  syntax error line 21 at position 48 unexpected ')'.
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql.
[0m16:05:05.792056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:05.792551 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m16:05:05.792915 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m16:05:05.896435 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m16:05:05.896907 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m16:05:06.006665 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_customer_churn' was left open.
[0m16:05:06.008190 [debug] [MainThread]: On model.dbt_transformations.prep_customer_churn: Close
[0m16:05:06.116675 [info ] [MainThread]: 
[0m16:05:06.117646 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.47 seconds (2.47s).
[0m16:05:06.118893 [debug] [MainThread]: Command end result
[0m16:05:06.144762 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:05:06.147830 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:05:06.155212 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m16:05:06.155653 [info ] [MainThread]: 
[0m16:05:06.156546 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:05:06.157356 [info ] [MainThread]: 
[0m16:05:06.158373 [error] [MainThread]:   Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 4 unexpected 'DENSE_RANK'.
  syntax error line 21 at position 48 unexpected ')'.
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql
[0m16:05:06.159344 [info ] [MainThread]: 
[0m16:05:06.160257 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:05:06.161988 [debug] [MainThread]: Command `dbt run` failed at 16:05:06.161786 after 4.33 seconds
[0m16:05:06.162545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E8318C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E8373ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1E8373750>]}
[0m16:05:06.163070 [debug] [MainThread]: Flushing usage events
[0m16:05:07.163019 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:05:33.615192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DD12D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DCF3B5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DD300BED0>]}


============================== 16:05:33.620912 | 87f37e3e-705f-4d3d-a125-ce043e22e71e ==============================
[0m16:05:33.620912 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:05:33.622149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prep_customer_churn', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:05:34.145632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87f37e3e-705f-4d3d-a125-ce043e22e71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DD383DBA0>]}
[0m16:05:34.218800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87f37e3e-705f-4d3d-a125-ce043e22e71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DD3719E10>]}
[0m16:05:34.220288 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:05:34.737133 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:05:34.948835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:05:34.949507 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\preparation\prep_customer_churn.sql
[0m16:05:35.249988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87f37e3e-705f-4d3d-a125-ce043e22e71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DD3777150>]}
[0m16:05:35.325264 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:05:35.329528 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:05:35.360768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87f37e3e-705f-4d3d-a125-ce043e22e71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DCF51B6B0>]}
[0m16:05:35.361592 [info ] [MainThread]: Found 5 models, 4 sources, 473 macros
[0m16:05:35.362499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87f37e3e-705f-4d3d-a125-ce043e22e71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DD3B02F90>]}
[0m16:05:35.364294 [info ] [MainThread]: 
[0m16:05:35.365150 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:05:35.365862 [info ] [MainThread]: 
[0m16:05:35.366811 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:05:35.367995 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m16:05:35.541057 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m16:05:35.541521 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m16:05:35.541905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:36.351675 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.810 seconds
[0m16:05:36.362787 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m16:05:36.378581 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m16:05:36.379112 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m16:05:36.379536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:36.818340 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.439 seconds
[0m16:05:36.820815 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_staging, now list_DE_MINI_PROJECT_DB_preparation)
[0m16:05:36.824002 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m16:05:36.824424 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m16:05:36.911581 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.087 seconds
[0m16:05:36.913701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87f37e3e-705f-4d3d-a125-ce043e22e71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DD3F1B520>]}
[0m16:05:36.916299 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_customer_churn
[0m16:05:36.916879 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_customer_churn ................... [RUN]
[0m16:05:36.917891 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_customer_churn'
[0m16:05:36.918332 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_customer_churn
[0m16:05:36.927398 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_customer_churn"
[0m16:05:36.928626 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_customer_churn
[0m16:05:36.963829 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_customer_churn"
[0m16:05:36.965863 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_customer_churn"
[0m16:05:36.966367 [debug] [Thread-1 (]: On model.dbt_transformations.prep_customer_churn: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_customer_churn"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_customer_churn
         as
        (WITH transactions_customers_joined_cte AS(
    SELECT
        customer_id,
        customer_name,
        revenue_type,
        revenue
    FROM
        DE_MINI_PROJECT_DB.staging.stg_transactions
    INNER JOIN 
        DE_MINI_PROJECT_DB.staging.stg_customers
        USING(customer_id)
)


SELECT  
    customer_id,
    customer_name,
    SUM(revenue) AS total_revenue,
    DENSE_RANK() OVER(ORDER BY SUM(revenue) DESC) AS customer_rank
FROM    
    transactions_customers_joined_cte
WHERE
    revenue_type=1
GROUP BY    
    customer_id,customer_name
ORDER BY    
    total_revenue
        );
[0m16:05:36.966848 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:05:38.805205 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.838 seconds
[0m16:05:38.830964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87f37e3e-705f-4d3d-a125-ce043e22e71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DD5111310>]}
[0m16:05:38.831743 [info ] [Thread-1 (]: 1 of 1 OK created sql table model preparation.prep_customer_churn .............. [[32mSUCCESS 1[0m in 1.91s]
[0m16:05:38.832952 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_customer_churn
[0m16:05:38.834485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:38.834849 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m16:05:38.835203 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m16:05:38.937338 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_preparation' was left open.
[0m16:05:38.937802 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_preparation: Close
[0m16:05:39.042582 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_customer_churn' was left open.
[0m16:05:39.043063 [debug] [MainThread]: On model.dbt_transformations.prep_customer_churn: Close
[0m16:05:39.157146 [info ] [MainThread]: 
[0m16:05:39.158148 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.79 seconds (3.79s).
[0m16:05:39.159387 [debug] [MainThread]: Command end result
[0m16:05:39.183946 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:05:39.186556 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:05:39.194330 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m16:05:39.194870 [info ] [MainThread]: 
[0m16:05:39.195958 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:05:39.196755 [info ] [MainThread]: 
[0m16:05:39.197529 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:05:39.198908 [debug] [MainThread]: Command `dbt run` succeeded at 16:05:39.198767 after 5.73 seconds
[0m16:05:39.199345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DD5119390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DD5170C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015DD5172DF0>]}
[0m16:05:39.199820 [debug] [MainThread]: Flushing usage events
[0m16:05:40.133865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:09:34.172350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFFBE21A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFF8FA5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFFCB6BED0>]}


============================== 16:09:34.187231 | 4c0c4f81-6b5b-45bf-96b5-0435e28e6eb5 ==============================
[0m16:09:34.187231 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:09:34.188327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m prep_customer_churn', 'send_anonymous_usage_stats': 'True'}
[0m16:09:37.570252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c0c4f81-6b5b-45bf-96b5-0435e28e6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFFE43DBA0>]}
[0m16:09:37.636423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c0c4f81-6b5b-45bf-96b5-0435e28e6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFFE319E10>]}
[0m16:09:37.646002 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:09:38.283776 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:09:39.873359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:09:39.874026 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\preparation\prep_customer_churn.sql
[0m16:09:40.162902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c0c4f81-6b5b-45bf-96b5-0435e28e6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFFE377150>]}
[0m16:09:40.237102 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:09:40.254928 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:09:40.544109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c0c4f81-6b5b-45bf-96b5-0435e28e6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFFB11B6B0>]}
[0m16:09:40.544733 [info ] [MainThread]: Found 5 models, 4 sources, 473 macros
[0m16:09:40.545694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c0c4f81-6b5b-45bf-96b5-0435e28e6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFFE702F90>]}
[0m16:09:40.547421 [info ] [MainThread]: 
[0m16:09:40.548147 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:09:40.548821 [info ] [MainThread]: 
[0m16:09:40.549640 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:09:40.550725 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m16:09:44.007256 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m16:09:44.007731 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m16:09:44.008102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:45.031495 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.023 seconds
[0m16:09:45.047474 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_preparation'
[0m16:09:45.058297 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m16:09:45.058712 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m16:09:45.059052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:45.849131 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.790 seconds
[0m16:09:45.852433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_preparation, now list_DE_MINI_PROJECT_DB_staging)
[0m16:09:45.854867 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m16:09:45.855253 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m16:09:45.953613 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.098 seconds
[0m16:09:45.956890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c0c4f81-6b5b-45bf-96b5-0435e28e6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFFEB1F520>]}
[0m16:09:45.959428 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_customer_churn
[0m16:09:45.960008 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_customer_churn ................... [RUN]
[0m16:09:45.961050 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_customer_churn'
[0m16:09:45.961485 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_customer_churn
[0m16:09:45.969551 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_customer_churn"
[0m16:09:45.970903 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_customer_churn
[0m16:09:46.010963 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_customer_churn"
[0m16:09:46.013277 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_customer_churn"
[0m16:09:46.013817 [debug] [Thread-1 (]: On model.dbt_transformations.prep_customer_churn: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_customer_churn"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_customer_churn
         as
        (WITH transactions_customers_joined_cte AS(
    SELECT
        customer_id,
        customer_name,
        revenue_type,
        revenue
    FROM
        DE_MINI_PROJECT_DB.staging.stg_transactions
    INNER JOIN 
        DE_MINI_PROJECT_DB.staging.stg_customers
        USING(customer_id)
)


SELECT  
    customer_id,
    customer_name,
    CAST(SUM(revenue) AS DECIMAL(10,2)) AS total_revenue,
    DENSE_RANK() OVER(ORDER BY total_revenue) AS customer_rank
FROM    
    transactions_customers_joined_cte
WHERE
    revenue_type=1
GROUP BY    
    customer_id,customer_name
ORDER BY    
    total_revenue
        );
[0m16:09:46.014276 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:09:46.947478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.933 seconds
[0m16:09:46.984615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4c0c4f81-6b5b-45bf-96b5-0435e28e6eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFFED15190>]}
[0m16:09:46.985484 [info ] [Thread-1 (]: 1 of 1 OK created sql table model preparation.prep_customer_churn .............. [[32mSUCCESS 1[0m in 1.01s]
[0m16:09:46.986667 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_customer_churn
[0m16:09:46.988675 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:09:46.989139 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m16:09:46.989517 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m16:09:47.105180 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m16:09:47.105839 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m16:09:47.223537 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_customer_churn' was left open.
[0m16:09:47.224135 [debug] [MainThread]: On model.dbt_transformations.prep_customer_churn: Close
[0m16:09:47.331868 [info ] [MainThread]: 
[0m16:09:47.334424 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.78 seconds (6.78s).
[0m16:09:47.338627 [debug] [MainThread]: Command end result
[0m16:09:47.377264 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:09:47.379853 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:09:47.386804 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m16:09:47.387296 [info ] [MainThread]: 
[0m16:09:47.388359 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:09:47.389585 [info ] [MainThread]: 
[0m16:09:47.390650 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:09:47.392331 [debug] [MainThread]: Command `dbt run` succeeded at 16:09:47.392172 after 13.48 seconds
[0m16:09:47.392760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFFED18B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFFED70C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CFFED72CB0>]}
[0m16:09:47.393210 [debug] [MainThread]: Flushing usage events
[0m16:09:48.370303 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:54.347915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1768D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D173A65310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D17870BED0>]}


============================== 16:10:54.352985 | 6042fe33-33e2-4f36-afd8-5b2afe9cb66c ==============================
[0m16:10:54.352985 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:10:54.354024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m prep_customer_churn', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:10:54.832356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6042fe33-33e2-4f36-afd8-5b2afe9cb66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D178F3DBA0>]}
[0m16:10:54.901558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6042fe33-33e2-4f36-afd8-5b2afe9cb66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D178E19E10>]}
[0m16:10:54.902848 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:10:55.407787 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:10:55.627069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:10:55.627733 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\preparation\prep_customer_churn.sql
[0m16:10:55.950099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6042fe33-33e2-4f36-afd8-5b2afe9cb66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D178E77150>]}
[0m16:10:56.034551 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:10:56.039023 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:10:56.072659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6042fe33-33e2-4f36-afd8-5b2afe9cb66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D173BCB6B0>]}
[0m16:10:56.073584 [info ] [MainThread]: Found 5 models, 4 sources, 473 macros
[0m16:10:56.075157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6042fe33-33e2-4f36-afd8-5b2afe9cb66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D179202F90>]}
[0m16:10:56.077102 [info ] [MainThread]: 
[0m16:10:56.077972 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:10:56.078734 [info ] [MainThread]: 
[0m16:10:56.080057 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:10:56.081415 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m16:10:56.284418 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m16:10:56.284866 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m16:10:56.285245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:57.115482 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.830 seconds
[0m16:10:57.123722 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_preparation'
[0m16:10:57.136835 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m16:10:57.137536 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m16:10:57.137983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:57.498853 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.361 seconds
[0m16:10:57.501010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_preparation, now list_DE_MINI_PROJECT_DB_staging)
[0m16:10:57.503511 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m16:10:57.503981 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m16:10:57.581511 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.077 seconds
[0m16:10:57.585010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6042fe33-33e2-4f36-afd8-5b2afe9cb66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D179617520>]}
[0m16:10:57.587592 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_customer_churn
[0m16:10:57.588277 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_customer_churn ................... [RUN]
[0m16:10:57.589294 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_customer_churn'
[0m16:10:57.589829 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_customer_churn
[0m16:10:57.600606 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_customer_churn"
[0m16:10:57.601960 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_customer_churn
[0m16:10:57.641953 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_customer_churn"
[0m16:10:57.646190 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_customer_churn"
[0m16:10:57.647439 [debug] [Thread-1 (]: On model.dbt_transformations.prep_customer_churn: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_customer_churn"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_customer_churn
         as
        (WITH transactions_customers_joined_cte AS(
    SELECT
        customer_id,
        customer_name,
        revenue_type,
        revenue
    FROM
        DE_MINI_PROJECT_DB.staging.stg_transactions
    INNER JOIN 
        DE_MINI_PROJECT_DB.staging.stg_customers
        USING(customer_id)
)


SELECT  
    DENSE_RANK() OVER(ORDER BY total_revenue) AS customer_rank,
    CAST(SUM(revenue) AS DECIMAL(10,2)) AS total_revenue,
    customer_id,
    customer_name
FROM    
    transactions_customers_joined_cte
WHERE
    revenue_type=1
GROUP BY    
    customer_id,customer_name
ORDER BY    
    total_revenue
        );
[0m16:10:57.647935 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:10:58.265082 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb0020-3201-7e57-000c-4ad200020392
[0m16:10:58.265657 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 18 at position 31
invalid identifier 'TOTAL_REVENUE'
[0m16:10:58.273338 [debug] [Thread-1 (]: Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  000904 (42000): SQL compilation error: error line 18 at position 31
  invalid identifier 'TOTAL_REVENUE'
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql
[0m16:10:58.275915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6042fe33-33e2-4f36-afd8-5b2afe9cb66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D179815790>]}
[0m16:10:58.277066 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model preparation.prep_customer_churn .......... [[31mERROR[0m in 0.68s]
[0m16:10:58.278450 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_customer_churn
[0m16:10:58.279466 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.prep_customer_churn' to be skipped because of status 'error'.  Reason: Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  000904 (42000): SQL compilation error: error line 18 at position 31
  invalid identifier 'TOTAL_REVENUE'
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql.
[0m16:10:58.281788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:58.282210 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m16:10:58.282595 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m16:10:58.390757 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m16:10:58.391222 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m16:10:58.508804 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_customer_churn' was left open.
[0m16:10:58.510442 [debug] [MainThread]: On model.dbt_transformations.prep_customer_churn: Close
[0m16:10:58.624079 [info ] [MainThread]: 
[0m16:10:58.624861 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.54 seconds (2.54s).
[0m16:10:58.625965 [debug] [MainThread]: Command end result
[0m16:10:58.651832 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:10:58.654529 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:10:58.662574 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m16:10:58.663121 [info ] [MainThread]: 
[0m16:10:58.663913 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:10:58.664605 [info ] [MainThread]: 
[0m16:10:58.665365 [error] [MainThread]:   Database Error in model prep_customer_churn (models\preparation\prep_customer_churn.sql)
  000904 (42000): SQL compilation error: error line 18 at position 31
  invalid identifier 'TOTAL_REVENUE'
  compiled code at target\run\dbt_transformations\models\preparation\prep_customer_churn.sql
[0m16:10:58.665964 [info ] [MainThread]: 
[0m16:10:58.666591 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:10:58.667829 [debug] [MainThread]: Command `dbt run` failed at 16:10:58.667683 after 4.47 seconds
[0m16:10:58.668287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D179818CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D179873ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D179873750>]}
[0m16:10:58.668770 [debug] [MainThread]: Flushing usage events
[0m16:11:00.109696 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:11:20.953860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC7E21A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC4FA5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC8B67ED0>]}


============================== 16:11:20.958594 | f3bfcc85-8493-4b8a-b0c5-c1dbd8d13e1e ==============================
[0m16:11:20.958594 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:11:20.959766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prep_customer_churn', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:11:21.421821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3bfcc85-8493-4b8a-b0c5-c1dbd8d13e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BCA43DBA0>]}
[0m16:11:21.487854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3bfcc85-8493-4b8a-b0c5-c1dbd8d13e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BCA319E10>]}
[0m16:11:21.489077 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:11:21.962720 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:11:22.161554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:11:22.162196 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\preparation\prep_customer_churn.sql
[0m16:11:22.442750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3bfcc85-8493-4b8a-b0c5-c1dbd8d13e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BCA377150>]}
[0m16:11:22.516112 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:11:22.520397 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:11:22.549210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3bfcc85-8493-4b8a-b0c5-c1dbd8d13e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BC711B6B0>]}
[0m16:11:22.549839 [info ] [MainThread]: Found 5 models, 4 sources, 473 macros
[0m16:11:22.550790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3bfcc85-8493-4b8a-b0c5-c1dbd8d13e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BCA702F90>]}
[0m16:11:22.552515 [info ] [MainThread]: 
[0m16:11:22.553284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:11:22.553989 [info ] [MainThread]: 
[0m16:11:22.554890 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:11:22.556003 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m16:11:22.724025 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m16:11:22.724471 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m16:11:22.724842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:23.497390 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.772 seconds
[0m16:11:23.504493 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_preparation'
[0m16:11:23.515225 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m16:11:23.515642 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m16:11:23.516002 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:23.935970 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.420 seconds
[0m16:11:23.938758 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_preparation, now list_DE_MINI_PROJECT_DB_staging)
[0m16:11:23.941004 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m16:11:23.941523 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m16:11:24.030961 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.089 seconds
[0m16:11:24.034161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3bfcc85-8493-4b8a-b0c5-c1dbd8d13e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BCAB17520>]}
[0m16:11:24.036904 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_customer_churn
[0m16:11:24.037530 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_customer_churn ................... [RUN]
[0m16:11:24.038604 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_customer_churn'
[0m16:11:24.039180 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_customer_churn
[0m16:11:24.048576 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_customer_churn"
[0m16:11:24.049922 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_customer_churn
[0m16:11:24.084992 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_customer_churn"
[0m16:11:24.088082 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_customer_churn"
[0m16:11:24.088710 [debug] [Thread-1 (]: On model.dbt_transformations.prep_customer_churn: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_customer_churn"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_customer_churn
         as
        (WITH transactions_customers_joined_cte AS(
    SELECT
        customer_id,
        customer_name,
        revenue_type,
        revenue
    FROM
        DE_MINI_PROJECT_DB.staging.stg_transactions
    INNER JOIN 
        DE_MINI_PROJECT_DB.staging.stg_customers
        USING(customer_id)
)


SELECT  
    CAST(SUM(revenue) AS DECIMAL(10,2)) AS total_revenue,
    DENSE_RANK() OVER(ORDER BY total_revenue) AS customer_rank,
    customer_id,
    customer_name
FROM    
    transactions_customers_joined_cte
WHERE
    revenue_type=1
GROUP BY    
    customer_id,customer_name
ORDER BY    
    total_revenue
        );
[0m16:11:24.089159 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:11:25.065942 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.976 seconds
[0m16:11:25.091805 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3bfcc85-8493-4b8a-b0c5-c1dbd8d13e1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BCAD11190>]}
[0m16:11:25.092550 [info ] [Thread-1 (]: 1 of 1 OK created sql table model preparation.prep_customer_churn .............. [[32mSUCCESS 1[0m in 1.05s]
[0m16:11:25.093719 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_customer_churn
[0m16:11:25.095306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:25.095659 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m16:11:25.096002 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m16:11:25.205545 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m16:11:25.206014 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m16:11:25.308709 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_customer_churn' was left open.
[0m16:11:25.310225 [debug] [MainThread]: On model.dbt_transformations.prep_customer_churn: Close
[0m16:11:25.426850 [info ] [MainThread]: 
[0m16:11:25.429385 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m16:11:25.433230 [debug] [MainThread]: Command end result
[0m16:11:25.458571 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:11:25.461401 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:11:25.468401 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m16:11:25.468949 [info ] [MainThread]: 
[0m16:11:25.470046 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:25.470895 [info ] [MainThread]: 
[0m16:11:25.472029 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:11:25.474395 [debug] [MainThread]: Command `dbt run` succeeded at 16:11:25.474196 after 4.65 seconds
[0m16:11:25.475090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BCAD18B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BCAD70C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BCAD72CB0>]}
[0m16:11:25.475541 [debug] [MainThread]: Flushing usage events
[0m16:11:26.422495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:11:54.985400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2A4021A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2A31B5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2A4D6BED0>]}


============================== 16:11:54.990587 | e87c291d-3995-4307-9664-a2723d50ea44 ==============================
[0m16:11:54.990587 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:11:54.991827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m prep_customer_churn', 'send_anonymous_usage_stats': 'True'}
[0m16:11:55.484561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e87c291d-3995-4307-9664-a2723d50ea44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2A663DBA0>]}
[0m16:11:55.559042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e87c291d-3995-4307-9664-a2723d50ea44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2A6519E10>]}
[0m16:11:55.560361 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:11:56.058442 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:11:56.274946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:11:56.275628 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\preparation\prep_customer_churn.sql
[0m16:11:56.578890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e87c291d-3995-4307-9664-a2723d50ea44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2A6577150>]}
[0m16:11:56.656519 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:11:56.660875 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:11:56.691767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e87c291d-3995-4307-9664-a2723d50ea44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2A331B6B0>]}
[0m16:11:56.692424 [info ] [MainThread]: Found 5 models, 4 sources, 473 macros
[0m16:11:56.693346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e87c291d-3995-4307-9664-a2723d50ea44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2A6902F90>]}
[0m16:11:56.695174 [info ] [MainThread]: 
[0m16:11:56.695918 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:11:56.696545 [info ] [MainThread]: 
[0m16:11:56.697412 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:11:56.698500 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m16:11:56.876173 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m16:11:56.876631 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m16:11:56.877005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:57.806752 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.929 seconds
[0m16:11:57.823285 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_preparation'
[0m16:11:57.833697 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m16:11:57.834132 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m16:11:57.834482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:58.226128 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.392 seconds
[0m16:11:58.228308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_preparation, now list_DE_MINI_PROJECT_DB_staging)
[0m16:11:58.230400 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m16:11:58.230807 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m16:11:58.318365 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.087 seconds
[0m16:11:58.322538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e87c291d-3995-4307-9664-a2723d50ea44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2A6D17520>]}
[0m16:11:58.325883 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_customer_churn
[0m16:11:58.326624 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_customer_churn ................... [RUN]
[0m16:11:58.327857 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_customer_churn'
[0m16:11:58.328395 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_customer_churn
[0m16:11:58.337979 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_customer_churn"
[0m16:11:58.339265 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_customer_churn
[0m16:11:58.379359 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_customer_churn"
[0m16:11:58.381817 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_customer_churn"
[0m16:11:58.382371 [debug] [Thread-1 (]: On model.dbt_transformations.prep_customer_churn: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_customer_churn"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_customer_churn
         as
        (WITH transactions_customers_joined_cte AS(
    SELECT
        customer_id,
        customer_name,
        revenue_type,
        revenue
    FROM
        DE_MINI_PROJECT_DB.staging.stg_transactions
    INNER JOIN 
        DE_MINI_PROJECT_DB.staging.stg_customers
        USING(customer_id)
)


SELECT  
    CAST(SUM(revenue) AS DECIMAL(10,2)) AS total_revenue,
    DENSE_RANK() OVER(ORDER BY total_revenue DESC) AS customer_rank,
    customer_id,
    customer_name
FROM    
    transactions_customers_joined_cte
WHERE
    revenue_type=1
GROUP BY    
    customer_id,customer_name
ORDER BY    
    total_revenue
        );
[0m16:11:58.383154 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:11:59.282415 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.899 seconds
[0m16:11:59.308277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e87c291d-3995-4307-9664-a2723d50ea44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2A6F11190>]}
[0m16:11:59.308994 [info ] [Thread-1 (]: 1 of 1 OK created sql table model preparation.prep_customer_churn .............. [[32mSUCCESS 1[0m in 0.98s]
[0m16:11:59.310161 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_customer_churn
[0m16:11:59.311729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:59.312078 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m16:11:59.312418 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m16:11:59.425465 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m16:11:59.426262 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m16:11:59.537756 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_customer_churn' was left open.
[0m16:11:59.538205 [debug] [MainThread]: On model.dbt_transformations.prep_customer_churn: Close
[0m16:11:59.646925 [info ] [MainThread]: 
[0m16:11:59.649760 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.95 seconds (2.95s).
[0m16:11:59.654150 [debug] [MainThread]: Command end result
[0m16:11:59.681596 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:11:59.684223 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:11:59.692343 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m16:11:59.692808 [info ] [MainThread]: 
[0m16:11:59.693841 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:59.694717 [info ] [MainThread]: 
[0m16:11:59.695502 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:11:59.696846 [debug] [MainThread]: Command `dbt run` succeeded at 16:11:59.696706 after 4.87 seconds
[0m16:11:59.697281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2A6F18B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2A6F70C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2A6F72CB0>]}
[0m16:11:59.697718 [debug] [MainThread]: Flushing usage events
[0m16:12:01.050519 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:13:31.001465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002207D7F1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002207A971310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002207F603ED0>]}


============================== 16:13:31.006545 | eb1e8f04-a166-4c29-af90-400262ed1b36 ==============================
[0m16:13:31.006545 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:13:31.007644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prep_customer_rank', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:13:31.500045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb1e8f04-a166-4c29-af90-400262ed1b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002207FE3DBA0>]}
[0m16:13:31.570630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb1e8f04-a166-4c29-af90-400262ed1b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002207FD19E10>]}
[0m16:13:31.571967 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:13:32.072390 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:13:32.311886 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:13:32.313647 [debug] [MainThread]: Partial parsing: added file: dbt_transformations://models\preparation\prep_customer_rank.sql
[0m16:13:32.314329 [debug] [MainThread]: Partial parsing: deleted file: dbt_transformations://models\preparation\prep_customer_churn.sql
[0m16:13:32.627010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb1e8f04-a166-4c29-af90-400262ed1b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002207FD77150>]}
[0m16:13:32.705135 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:13:32.709476 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:13:32.740321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb1e8f04-a166-4c29-af90-400262ed1b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002207AAEB6B0>]}
[0m16:13:32.740873 [info ] [MainThread]: Found 5 models, 4 sources, 473 macros
[0m16:13:32.741764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb1e8f04-a166-4c29-af90-400262ed1b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022000102F90>]}
[0m16:13:32.743544 [info ] [MainThread]: 
[0m16:13:32.744368 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:13:32.745083 [info ] [MainThread]: 
[0m16:13:32.746067 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:13:32.747219 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m16:13:32.929989 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m16:13:32.930447 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m16:13:32.930821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:33.793697 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.863 seconds
[0m16:13:33.818621 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_preparation'
[0m16:13:33.839887 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m16:13:33.840740 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m16:13:33.841436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:34.265239 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.423 seconds
[0m16:13:34.268231 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_preparation, now list_DE_MINI_PROJECT_DB_staging)
[0m16:13:34.270259 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m16:13:34.270644 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m16:13:34.367034 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.096 seconds
[0m16:13:34.371359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb1e8f04-a166-4c29-af90-400262ed1b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002200051B520>]}
[0m16:13:34.374924 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_customer_rank
[0m16:13:34.375887 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_customer_rank .................... [RUN]
[0m16:13:34.377455 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_customer_rank'
[0m16:13:34.378161 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_customer_rank
[0m16:13:34.391916 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_customer_rank"
[0m16:13:34.394120 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_customer_rank
[0m16:13:34.431053 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_customer_rank"
[0m16:13:34.433750 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_customer_rank"
[0m16:13:34.434600 [debug] [Thread-1 (]: On model.dbt_transformations.prep_customer_rank: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_customer_rank"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_customer_rank
         as
        (WITH transactions_customers_joined_cte AS(
    SELECT
        customer_id,
        customer_name,
        revenue_type,
        revenue
    FROM
        DE_MINI_PROJECT_DB.staging.stg_transactions
    INNER JOIN 
        DE_MINI_PROJECT_DB.staging.stg_customers
        USING(customer_id)
)


SELECT  
    CAST(SUM(revenue) AS DECIMAL(10,2)) AS total_revenue,
    DENSE_RANK() OVER(ORDER BY total_revenue DESC) AS customer_rank,
    customer_id,
    customer_name
FROM    
    transactions_customers_joined_cte
WHERE
    revenue_type=1
GROUP BY    
    customer_id,customer_name
ORDER BY    
    customer_rank
        );
[0m16:13:34.435122 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:13:35.193244 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.758 seconds
[0m16:13:35.227199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb1e8f04-a166-4c29-af90-400262ed1b36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022000715190>]}
[0m16:13:35.227970 [info ] [Thread-1 (]: 1 of 1 OK created sql table model preparation.prep_customer_rank ............... [[32mSUCCESS 1[0m in 0.85s]
[0m16:13:35.229191 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_customer_rank
[0m16:13:35.230803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:35.231287 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m16:13:35.231759 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m16:13:35.333258 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m16:13:35.334135 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m16:13:35.450174 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_customer_rank' was left open.
[0m16:13:35.450612 [debug] [MainThread]: On model.dbt_transformations.prep_customer_rank: Close
[0m16:13:35.558255 [info ] [MainThread]: 
[0m16:13:35.559281 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m16:13:35.560469 [debug] [MainThread]: Command end result
[0m16:13:35.585942 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:13:35.588586 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:13:35.595676 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m16:13:35.596098 [info ] [MainThread]: 
[0m16:13:35.596941 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:13:35.597658 [info ] [MainThread]: 
[0m16:13:35.598411 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:13:35.600300 [debug] [MainThread]: Command `dbt run` succeeded at 16:13:35.600024 after 4.81 seconds
[0m16:13:35.600827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022000718B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022000770C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022000772CB0>]}
[0m16:13:35.601420 [debug] [MainThread]: Flushing usage events
[0m16:13:36.560144 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:08.547356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D309ED1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3090B1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D30AC1BED0>]}


============================== 16:20:08.552352 | 9523bb3a-599a-4541-8890-45b7e7ca83a6 ==============================
[0m16:20:08.552352 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:20:08.553394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m prep_product_rank', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:20:09.027564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9523bb3a-599a-4541-8890-45b7e7ca83a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D30C53DBA0>]}
[0m16:20:09.094550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9523bb3a-599a-4541-8890-45b7e7ca83a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D30C419E10>]}
[0m16:20:09.095766 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:20:09.568318 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:20:09.775645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:20:09.776217 [debug] [MainThread]: Partial parsing: added file: dbt_transformations://models\preparation\prep_product_rank.sql
[0m16:20:09.776672 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\preparation\prep_customer_rank.sql
[0m16:20:10.064951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9523bb3a-599a-4541-8890-45b7e7ca83a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D30C477B50>]}
[0m16:20:10.139470 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:20:10.143802 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:20:10.173325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9523bb3a-599a-4541-8890-45b7e7ca83a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D30921B6B0>]}
[0m16:20:10.173928 [info ] [MainThread]: Found 6 models, 4 sources, 473 macros
[0m16:20:10.174905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9523bb3a-599a-4541-8890-45b7e7ca83a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D30C802DD0>]}
[0m16:20:10.176641 [info ] [MainThread]: 
[0m16:20:10.177410 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:20:10.178125 [info ] [MainThread]: 
[0m16:20:10.179010 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:20:10.180100 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m16:20:10.346054 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m16:20:10.346493 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m16:20:10.346858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:11.199887 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.853 seconds
[0m16:20:11.217287 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m16:20:11.230831 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m16:20:11.231265 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m16:20:11.231612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:11.745080 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.513 seconds
[0m16:20:11.752846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_staging, now list_DE_MINI_PROJECT_DB_preparation)
[0m16:20:11.762422 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m16:20:11.763443 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m16:20:11.863107 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.099 seconds
[0m16:20:11.866374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9523bb3a-599a-4541-8890-45b7e7ca83a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D30CC0EB60>]}
[0m16:20:11.869243 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_product_rank
[0m16:20:11.869882 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_product_rank ..................... [RUN]
[0m16:20:11.870934 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_product_rank'
[0m16:20:11.871425 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_product_rank
[0m16:20:11.879739 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_product_rank"
[0m16:20:11.882881 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_product_rank
[0m16:20:11.919130 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_product_rank"
[0m16:20:11.921540 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_product_rank"
[0m16:20:11.922063 [debug] [Thread-1 (]: On model.dbt_transformations.prep_product_rank: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_product_rank"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_product_rank
         as
        (WITH transactions_products_joined_cte AS(
    SELECT  
        product_id,
        product_family,
        revenue,
        revenue_type
    FROM    
        DE_MINI_PROJECT_DB.staging.stg_transactions
    INNER JOIN
        DE_MINI_PROJECT_DB.staging.stg_products  
        USING (product_id)
)

SELECT
    SUM(revenue) AS total_revenue_by_product,
    DENSE_RANK() OVER(ORDER BY total_revenue_by_product) AS product_rank,
    product_id,
    product_family
FROM
    transactions_products_joined_cte
WHERE 
    revenue_type=1
GROUP BY 
    product_id,product_family
ORDER BY    
    product_rank
        );
[0m16:20:11.922561 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:20:12.928080 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.005 seconds
[0m16:20:12.954324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9523bb3a-599a-4541-8890-45b7e7ca83a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D30CE153D0>]}
[0m16:20:12.955057 [info ] [Thread-1 (]: 1 of 1 OK created sql table model preparation.prep_product_rank ................ [[32mSUCCESS 1[0m in 1.08s]
[0m16:20:12.956235 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_product_rank
[0m16:20:12.957986 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:12.958328 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m16:20:12.958660 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m16:20:13.064902 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_preparation' was left open.
[0m16:20:13.065376 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_preparation: Close
[0m16:20:13.173576 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_product_rank' was left open.
[0m16:20:13.175118 [debug] [MainThread]: On model.dbt_transformations.prep_product_rank: Close
[0m16:20:13.290355 [info ] [MainThread]: 
[0m16:20:13.291512 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m16:20:13.292664 [debug] [MainThread]: Command end result
[0m16:20:13.320600 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:20:13.323176 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:20:13.330526 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m16:20:13.331206 [info ] [MainThread]: 
[0m16:20:13.332255 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:13.333185 [info ] [MainThread]: 
[0m16:20:13.333982 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:20:13.335335 [debug] [MainThread]: Command `dbt run` succeeded at 16:20:13.335199 after 5.00 seconds
[0m16:20:13.335756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D30CE19C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D30C591590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D30C593ED0>]}
[0m16:20:13.336182 [debug] [MainThread]: Flushing usage events
[0m16:20:14.303704 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:22:14.373672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB8E8D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB8B9F1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB90607ED0>]}


============================== 16:22:14.388699 | d346d4f1-de5b-4a29-a28f-c4b1869bcb6c ==============================
[0m16:22:14.388699 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:22:14.389737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m prep_customer_rank', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:22:17.887120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd346d4f1-de5b-4a29-a28f-c4b1869bcb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB90E3DBA0>]}
[0m16:22:17.956113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd346d4f1-de5b-4a29-a28f-c4b1869bcb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB90D19E10>]}
[0m16:22:17.965680 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:22:18.625619 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:22:20.328995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:22:20.329686 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\preparation\prep_product_rank.sql
[0m16:22:20.624482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd346d4f1-de5b-4a29-a28f-c4b1869bcb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB90D75950>]}
[0m16:22:20.699343 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:22:20.717937 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:22:21.005588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd346d4f1-de5b-4a29-a28f-c4b1869bcb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB8BB6B6B0>]}
[0m16:22:21.006212 [info ] [MainThread]: Found 6 models, 4 sources, 473 macros
[0m16:22:21.007211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd346d4f1-de5b-4a29-a28f-c4b1869bcb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB91102F90>]}
[0m16:22:21.008953 [info ] [MainThread]: 
[0m16:22:21.009710 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:22:21.010474 [info ] [MainThread]: 
[0m16:22:21.011369 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:22:21.012486 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m16:22:24.360213 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m16:22:24.360660 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m16:22:24.361025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:25.429770 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.069 seconds
[0m16:22:25.437405 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m16:22:25.448914 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m16:22:25.449334 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m16:22:25.449690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:25.867656 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.418 seconds
[0m16:22:25.871154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_staging, now list_DE_MINI_PROJECT_DB_preparation)
[0m16:22:25.874066 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m16:22:25.874437 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m16:22:25.983643 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.109 seconds
[0m16:22:25.990580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd346d4f1-de5b-4a29-a28f-c4b1869bcb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB91512B60>]}
[0m16:22:25.998632 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_customer_rank
[0m16:22:26.000740 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_customer_rank .................... [RUN]
[0m16:22:26.003957 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_customer_rank'
[0m16:22:26.005623 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_customer_rank
[0m16:22:26.014788 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_customer_rank"
[0m16:22:26.016038 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_customer_rank
[0m16:22:26.051083 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_customer_rank"
[0m16:22:26.053204 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_customer_rank"
[0m16:22:26.053680 [debug] [Thread-1 (]: On model.dbt_transformations.prep_customer_rank: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_customer_rank"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_customer_rank
         as
        (WITH transactions_customers_joined_cte AS(
    SELECT
        customer_id,
        customer_name,
        revenue_type,
        revenue
    FROM
        DE_MINI_PROJECT_DB.staging.stg_transactions
    INNER JOIN 
        DE_MINI_PROJECT_DB.staging.stg_customers
        USING(customer_id)
)


SELECT  
    CAST(SUM(revenue) AS DECIMAL(10,2)) AS total_revenue_by_customer,
    DENSE_RANK() OVER(ORDER BY total_revenue_by_customer DESC) AS customer_rank,
    customer_id,
    customer_name
FROM    
    transactions_customers_joined_cte
WHERE
    revenue_type=1
GROUP BY    
    customer_id,customer_name
ORDER BY    
    customer_rank
        );
[0m16:22:26.054126 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:22:26.866088 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.812 seconds
[0m16:22:26.899556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd346d4f1-de5b-4a29-a28f-c4b1869bcb6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB91729310>]}
[0m16:22:26.900359 [info ] [Thread-1 (]: 1 of 1 OK created sql table model preparation.prep_customer_rank ............... [[32mSUCCESS 1[0m in 0.89s]
[0m16:22:26.901547 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_customer_rank
[0m16:22:26.903135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:22:26.903488 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m16:22:26.903955 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m16:22:27.009982 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_preparation' was left open.
[0m16:22:27.011489 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_preparation: Close
[0m16:22:27.123110 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_customer_rank' was left open.
[0m16:22:27.123810 [debug] [MainThread]: On model.dbt_transformations.prep_customer_rank: Close
[0m16:22:27.225258 [info ] [MainThread]: 
[0m16:22:27.226430 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.21 seconds (6.21s).
[0m16:22:27.228036 [debug] [MainThread]: Command end result
[0m16:22:27.256036 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:22:27.258595 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:22:27.266668 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m16:22:27.267197 [info ] [MainThread]: 
[0m16:22:27.268385 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:22:27.269320 [info ] [MainThread]: 
[0m16:22:27.270116 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:22:27.271471 [debug] [MainThread]: Command `dbt run` succeeded at 16:22:27.271330 after 13.07 seconds
[0m16:22:27.271903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB9172D910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB90E89310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB90E8BED0>]}
[0m16:22:27.272351 [debug] [MainThread]: Flushing usage events
[0m16:22:28.328020 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:22:53.927060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B322D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B303B5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B34007ED0>]}


============================== 16:22:53.931851 | f1e3acd4-03e8-414d-92f4-3f5a3524438c ==============================
[0m16:22:53.931851 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:22:53.932883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prep_product_rank', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:22:54.404266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1e3acd4-03e8-414d-92f4-3f5a3524438c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B3483DBA0>]}
[0m16:22:54.475255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1e3acd4-03e8-414d-92f4-3f5a3524438c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B34715E10>]}
[0m16:22:54.476902 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:22:54.969078 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:22:55.169527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:22:55.169956 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:22:55.208437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1e3acd4-03e8-414d-92f4-3f5a3524438c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B34777950>]}
[0m16:22:55.289135 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:22:55.294547 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:22:55.321147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1e3acd4-03e8-414d-92f4-3f5a3524438c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B3051B6B0>]}
[0m16:22:55.321687 [info ] [MainThread]: Found 6 models, 4 sources, 473 macros
[0m16:22:55.322649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1e3acd4-03e8-414d-92f4-3f5a3524438c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B34B03310>]}
[0m16:22:55.324650 [info ] [MainThread]: 
[0m16:22:55.325562 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:22:55.326288 [info ] [MainThread]: 
[0m16:22:55.327236 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:22:55.328385 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m16:22:55.449918 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m16:22:55.450377 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m16:22:55.450735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:56.287766 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.837 seconds
[0m16:22:56.295676 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_preparation'
[0m16:22:56.361127 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m16:22:56.361607 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m16:22:56.362006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:56.778012 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.416 seconds
[0m16:22:56.785051 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_preparation, now list_DE_MINI_PROJECT_DB_staging)
[0m16:22:56.793180 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m16:22:56.794199 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m16:22:56.883132 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.088 seconds
[0m16:22:56.886741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1e3acd4-03e8-414d-92f4-3f5a3524438c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B34C1F5F0>]}
[0m16:22:56.889670 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_product_rank
[0m16:22:56.890345 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_product_rank ..................... [RUN]
[0m16:22:56.891472 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_product_rank'
[0m16:22:56.891955 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_product_rank
[0m16:22:56.901061 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_product_rank"
[0m16:22:56.902376 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_product_rank
[0m16:22:56.939215 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_product_rank"
[0m16:22:56.941681 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_product_rank"
[0m16:22:56.942322 [debug] [Thread-1 (]: On model.dbt_transformations.prep_product_rank: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_product_rank"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_product_rank
         as
        (WITH transactions_products_joined_cte AS(
    SELECT  
        product_id,
        product_family,
        product_sub_family,
        revenue,
        revenue_type
    FROM    
        DE_MINI_PROJECT_DB.staging.stg_transactions
    INNER JOIN
        DE_MINI_PROJECT_DB.staging.stg_products  
        USING (product_id)
)

SELECT
    SUM(revenue) AS total_revenue_by_product,
    DENSE_RANK() OVER(ORDER BY total_revenue_by_product DESC) AS product_rank,
    product_id,
    product_family,
    product_sub_family
FROM
    transactions_products_joined_cte
WHERE 
    revenue_type=1
GROUP BY 
    product_id,product_family,product_sub_family
ORDER BY    
    product_rank
        );
[0m16:22:56.942927 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:22:57.847349 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.904 seconds
[0m16:22:57.872513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1e3acd4-03e8-414d-92f4-3f5a3524438c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B360BD010>]}
[0m16:22:57.873278 [info ] [Thread-1 (]: 1 of 1 OK created sql table model preparation.prep_product_rank ................ [[32mSUCCESS 1[0m in 0.98s]
[0m16:22:57.874450 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_product_rank
[0m16:22:57.876699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:22:57.877351 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m16:22:57.877731 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m16:22:57.981830 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m16:22:57.982661 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m16:22:58.108486 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_product_rank' was left open.
[0m16:22:58.109254 [debug] [MainThread]: On model.dbt_transformations.prep_product_rank: Close
[0m16:22:58.219489 [info ] [MainThread]: 
[0m16:22:58.222374 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m16:22:58.226594 [debug] [MainThread]: Command end result
[0m16:22:58.265747 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:22:58.268369 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:22:58.274919 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m16:22:58.275377 [info ] [MainThread]: 
[0m16:22:58.276633 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:22:58.277571 [info ] [MainThread]: 
[0m16:22:58.278325 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:22:58.279681 [debug] [MainThread]: Command `dbt run` succeeded at 16:22:58.279549 after 4.48 seconds
[0m16:22:58.280084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B36147B70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B34C2ADF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B34C2AFD0>]}
[0m16:22:58.280533 [debug] [MainThread]: Flushing usage events
[0m16:22:59.283929 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:24:17.632524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAFF4D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAFC605310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB01207ED0>]}


============================== 16:24:17.637312 | 1b803f20-bf32-449e-870a-e1c68c3ea700 ==============================
[0m16:24:17.637312 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:24:17.638377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m prep_product_rank', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:24:18.103178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b803f20-bf32-449e-870a-e1c68c3ea700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB01A3DBA0>]}
[0m16:24:18.168997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b803f20-bf32-449e-870a-e1c68c3ea700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB01919E10>]}
[0m16:24:18.170309 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:24:18.673028 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:24:18.868707 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:24:18.869366 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\preparation\prep_product_rank.sql
[0m16:24:19.153529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b803f20-bf32-449e-870a-e1c68c3ea700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB01975950>]}
[0m16:24:19.227920 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:24:19.232838 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:24:19.263231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b803f20-bf32-449e-870a-e1c68c3ea700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAFC77B6B0>]}
[0m16:24:19.264639 [info ] [MainThread]: Found 6 models, 4 sources, 473 macros
[0m16:24:19.265546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b803f20-bf32-449e-870a-e1c68c3ea700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB01D02F90>]}
[0m16:24:19.267600 [info ] [MainThread]: 
[0m16:24:19.268375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:24:19.269043 [info ] [MainThread]: 
[0m16:24:19.269856 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:24:19.270994 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m16:24:19.441646 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m16:24:19.442097 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m16:24:19.442484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:20.234535 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.792 seconds
[0m16:24:20.244056 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m16:24:20.255970 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m16:24:20.256386 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m16:24:20.256813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:20.665458 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.409 seconds
[0m16:24:20.667550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_staging, now list_DE_MINI_PROJECT_DB_preparation)
[0m16:24:20.670260 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m16:24:20.670633 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m16:24:20.760590 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.089 seconds
[0m16:24:20.768784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b803f20-bf32-449e-870a-e1c68c3ea700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB03112B60>]}
[0m16:24:20.776786 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_product_rank
[0m16:24:20.778893 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_product_rank ..................... [RUN]
[0m16:24:20.782018 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_product_rank'
[0m16:24:20.783666 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_product_rank
[0m16:24:20.794619 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_product_rank"
[0m16:24:20.796238 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_product_rank
[0m16:24:20.830534 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_product_rank"
[0m16:24:20.832608 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_product_rank"
[0m16:24:20.833093 [debug] [Thread-1 (]: On model.dbt_transformations.prep_product_rank: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_product_rank"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_product_rank
         as
        (WITH transactions_products_joined_cte AS(
    SELECT  
        product_id,
        product_family,
        revenue,
        revenue_type
    FROM    
        DE_MINI_PROJECT_DB.staging.stg_transactions
    INNER JOIN
        DE_MINI_PROJECT_DB.staging.stg_products  
        USING (product_id)
)

SELECT
    SUM(revenue) AS total_revenue_by_product,
    DENSE_RANK() OVER(ORDER BY total_revenue_by_product DESC) AS product_rank,
    product_id,
    product_family
FROM
    transactions_products_joined_cte
WHERE 
    revenue_type=1
GROUP BY 
    product_id,product_family
ORDER BY    
    product_rank
        );
[0m16:24:20.833546 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:24:21.834589 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.001 seconds
[0m16:24:21.859688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b803f20-bf32-449e-870a-e1c68c3ea700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB03335490>]}
[0m16:24:21.860411 [info ] [Thread-1 (]: 1 of 1 OK created sql table model preparation.prep_product_rank ................ [[32mSUCCESS 1[0m in 1.08s]
[0m16:24:21.861625 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_product_rank
[0m16:24:21.863318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:21.863655 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m16:24:21.863985 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m16:24:21.968525 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_preparation' was left open.
[0m16:24:21.969761 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_preparation: Close
[0m16:24:22.078323 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_product_rank' was left open.
[0m16:24:22.078800 [debug] [MainThread]: On model.dbt_transformations.prep_product_rank: Close
[0m16:24:22.188203 [info ] [MainThread]: 
[0m16:24:22.190803 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m16:24:22.194648 [debug] [MainThread]: Command end result
[0m16:24:22.236890 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:24:22.239524 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:24:22.246760 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m16:24:22.247253 [info ] [MainThread]: 
[0m16:24:22.248263 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:24:22.249129 [info ] [MainThread]: 
[0m16:24:22.250034 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:24:22.251377 [debug] [MainThread]: Command `dbt run` succeeded at 16:24:22.251242 after 4.76 seconds
[0m16:24:22.251797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB03339BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB01A91310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB01A93ED0>]}
[0m16:24:22.252222 [debug] [MainThread]: Flushing usage events
[0m16:24:23.230371 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:58.866144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E0900D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E08F2B5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E090E0BED0>]}


============================== 16:25:58.870954 | 02944c05-198a-40ca-bf4e-bc16f3d5ad69 ==============================
[0m16:25:58.870954 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:25:58.872037 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m prep_product_rank', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:25:59.351549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02944c05-198a-40ca-bf4e-bc16f3d5ad69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E09263DBA0>]}
[0m16:25:59.419312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02944c05-198a-40ca-bf4e-bc16f3d5ad69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E092519E10>]}
[0m16:25:59.420685 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:25:59.905482 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:26:00.101185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:26:00.101599 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:26:00.138783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02944c05-198a-40ca-bf4e-bc16f3d5ad69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E092577950>]}
[0m16:26:00.220405 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:26:00.224687 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:26:00.251770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02944c05-198a-40ca-bf4e-bc16f3d5ad69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E08F41B6B0>]}
[0m16:26:00.252386 [info ] [MainThread]: Found 6 models, 4 sources, 473 macros
[0m16:26:00.253185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02944c05-198a-40ca-bf4e-bc16f3d5ad69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E092907310>]}
[0m16:26:00.254886 [info ] [MainThread]: 
[0m16:26:00.255574 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:26:00.256228 [info ] [MainThread]: 
[0m16:26:00.257076 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:26:00.258170 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m16:26:00.376762 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m16:26:00.377214 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m16:26:00.377566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:01.159344 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.782 seconds
[0m16:26:01.166121 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m16:26:01.231016 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m16:26:01.231562 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m16:26:01.231932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:01.668657 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.437 seconds
[0m16:26:01.672582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_staging, now list_DE_MINI_PROJECT_DB_preparation)
[0m16:26:01.674581 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m16:26:01.674966 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m16:26:01.778313 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.103 seconds
[0m16:26:01.784035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02944c05-198a-40ca-bf4e-bc16f3d5ad69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E092A1F5F0>]}
[0m16:26:01.788285 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_product_rank
[0m16:26:01.789254 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_product_rank ..................... [RUN]
[0m16:26:01.790600 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_product_rank'
[0m16:26:01.791219 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_product_rank
[0m16:26:01.802363 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_product_rank"
[0m16:26:01.803871 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_product_rank
[0m16:26:01.839307 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_product_rank"
[0m16:26:01.841293 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_product_rank"
[0m16:26:01.841840 [debug] [Thread-1 (]: On model.dbt_transformations.prep_product_rank: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_product_rank"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_product_rank
         as
        (WITH transactions_products_joined_cte AS(
    SELECT  
        product_id,
        product_family,
        revenue,
        revenue_type
    FROM    
        DE_MINI_PROJECT_DB.staging.stg_transactions
    INNER JOIN
        DE_MINI_PROJECT_DB.staging.stg_products  
        USING (product_id)
)

SELECT
    SUM(revenue) AS total_revenue_by_product,
    DENSE_RANK() OVER(ORDER BY total_revenue_by_product DESC) AS product_rank,
    product_id,
    product_family
FROM
    transactions_products_joined_cte
WHERE 
    revenue_type=1
GROUP BY 
    product_id,product_family
ORDER BY    
    product_rank
        );
[0m16:26:01.842349 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:26:02.631732 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.789 seconds
[0m16:26:02.659506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02944c05-198a-40ca-bf4e-bc16f3d5ad69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E092ECD010>]}
[0m16:26:02.660561 [info ] [Thread-1 (]: 1 of 1 OK created sql table model preparation.prep_product_rank ................ [[32mSUCCESS 1[0m in 0.87s]
[0m16:26:02.661847 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_product_rank
[0m16:26:02.663566 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:02.663993 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m16:26:02.664378 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m16:26:02.769217 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_preparation' was left open.
[0m16:26:02.769705 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_preparation: Close
[0m16:26:02.877618 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_product_rank' was left open.
[0m16:26:02.878279 [debug] [MainThread]: On model.dbt_transformations.prep_product_rank: Close
[0m16:26:02.987454 [info ] [MainThread]: 
[0m16:26:02.988534 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.73 seconds (2.73s).
[0m16:26:02.989760 [debug] [MainThread]: Command end result
[0m16:26:03.014577 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:26:03.017279 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:26:03.024255 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m16:26:03.024669 [info ] [MainThread]: 
[0m16:26:03.025490 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:26:03.026333 [info ] [MainThread]: 
[0m16:26:03.027399 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:26:03.029185 [debug] [MainThread]: Command `dbt run` succeeded at 16:26:03.028907 after 4.30 seconds
[0m16:26:03.029867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E094047A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E09264FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002E09264C9B0>]}
[0m16:26:03.030438 [debug] [MainThread]: Flushing usage events
[0m16:26:04.000358 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:29:09.375361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170EDED1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170ED0B1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170EEC0BED0>]}


============================== 16:29:09.380882 | 0abc3da0-b681-4b5c-9ed1-f98c91bf7169 ==============================
[0m16:29:09.380882 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:29:09.381930 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m prep_product_rank', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:29:09.913497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0abc3da0-b681-4b5c-9ed1-f98c91bf7169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170F053DBA0>]}
[0m16:29:09.988148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0abc3da0-b681-4b5c-9ed1-f98c91bf7169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170F0419E10>]}
[0m16:29:09.989422 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m16:29:10.475312 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:29:10.671982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:29:10.672640 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\preparation\prep_product_rank.sql
[0m16:29:10.971269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0abc3da0-b681-4b5c-9ed1-f98c91bf7169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170F0475950>]}
[0m16:29:11.051088 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:29:11.055385 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:29:11.085879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0abc3da0-b681-4b5c-9ed1-f98c91bf7169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170ED21B6B0>]}
[0m16:29:11.086481 [info ] [MainThread]: Found 6 models, 4 sources, 473 macros
[0m16:29:11.087362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0abc3da0-b681-4b5c-9ed1-f98c91bf7169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170F0802F90>]}
[0m16:29:11.089102 [info ] [MainThread]: 
[0m16:29:11.089855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:29:11.090557 [info ] [MainThread]: 
[0m16:29:11.091440 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:29:11.092813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m16:29:11.266811 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m16:29:11.267253 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m16:29:11.267615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:12.103166 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.835 seconds
[0m16:29:12.117875 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_preparation'
[0m16:29:12.128424 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m16:29:12.128834 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m16:29:12.129191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:12.555923 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.426 seconds
[0m16:29:12.558443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_preparation, now list_DE_MINI_PROJECT_DB_staging)
[0m16:29:12.560786 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m16:29:12.561183 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m16:29:12.658059 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.096 seconds
[0m16:29:12.668942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0abc3da0-b681-4b5c-9ed1-f98c91bf7169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170F0C0EB60>]}
[0m16:29:12.676862 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_product_rank
[0m16:29:12.679019 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_product_rank ..................... [RUN]
[0m16:29:12.682181 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_product_rank'
[0m16:29:12.683845 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_product_rank
[0m16:29:12.693443 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_product_rank"
[0m16:29:12.694703 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_product_rank
[0m16:29:12.732487 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_product_rank"
[0m16:29:12.735888 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_product_rank"
[0m16:29:12.736528 [debug] [Thread-1 (]: On model.dbt_transformations.prep_product_rank: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_product_rank"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_product_rank
         as
        (WITH transactions_products_joined_cte AS(
    SELECT  
        product_id,
        product_family,
        product_sub_family,
        revenue,
        revenue_type
    FROM    
        DE_MINI_PROJECT_DB.staging.stg_transactions
    INNER JOIN
        DE_MINI_PROJECT_DB.staging.stg_products  
        USING (product_id)
)

SELECT
    SUM(revenue) AS total_revenue_by_product,
    DENSE_RANK() OVER(ORDER BY total_revenue_by_product DESC) AS product_rank,
    product_id,
    product_family,
    product_sub_family
FROM
    transactions_products_joined_cte
WHERE 
    revenue_type=1
GROUP BY 
    product_id,product_family,product_sub_family
ORDER BY    
    product_rank
        );
[0m16:29:12.737205 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:29:13.676390 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.939 seconds
[0m16:29:13.710617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0abc3da0-b681-4b5c-9ed1-f98c91bf7169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170F0E15490>]}
[0m16:29:13.711444 [info ] [Thread-1 (]: 1 of 1 OK created sql table model preparation.prep_product_rank ................ [[32mSUCCESS 1[0m in 1.03s]
[0m16:29:13.712666 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_product_rank
[0m16:29:13.714362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:13.714892 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m16:29:13.715369 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m16:29:13.822085 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m16:29:13.822873 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m16:29:13.939532 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_product_rank' was left open.
[0m16:29:13.941168 [debug] [MainThread]: On model.dbt_transformations.prep_product_rank: Close
[0m16:29:14.066967 [info ] [MainThread]: 
[0m16:29:14.069746 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m16:29:14.074065 [debug] [MainThread]: Command end result
[0m16:29:14.115055 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m16:29:14.118059 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m16:29:14.125601 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m16:29:14.126020 [info ] [MainThread]: 
[0m16:29:14.127005 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:29:14.127777 [info ] [MainThread]: 
[0m16:29:14.128563 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:29:14.129874 [debug] [MainThread]: Command `dbt run` succeeded at 16:29:14.129733 after 4.90 seconds
[0m16:29:14.130306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170F0E19BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170F0588D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170F058BED0>]}
[0m16:29:14.130751 [debug] [MainThread]: Flushing usage events
[0m16:29:15.502542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:07:08.557953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBACD1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEB7E35310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBBA07ED0>]}


============================== 19:07:08.580166 | 4fe05029-7840-4bca-b0f7-07c56f481f06 ==============================
[0m19:07:08.580166 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:07:08.581277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_customer_rank_KPI', 'send_anonymous_usage_stats': 'True'}
[0m19:07:12.850176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fe05029-7840-4bca-b0f7-07c56f481f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBD33DBA0>]}
[0m19:07:12.921016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fe05029-7840-4bca-b0f7-07c56f481f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBD219E10>]}
[0m19:07:12.930707 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:07:13.598327 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:07:13.713721 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:07:13.714586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4fe05029-7840-4bca-b0f7-07c56f481f06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBD275450>]}
[0m19:07:16.505681 [error] [MainThread]: Encountered an error:
Compilation Error in model mart_product_rank_KPI (models\mart\mart_product_rank_KPI.sql)
  expected token 'end of print statement', got ':'
    line 4
      {{ref:('prep_product_rank')}}
[0m19:07:16.507369 [debug] [MainThread]: Command `dbt run` failed at 19:07:16.507192 after 8.17 seconds
[0m19:07:16.507845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBD6B9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBD6B8AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBB8EBE70>]}
[0m19:07:16.508464 [debug] [MainThread]: Flushing usage events
[0m19:07:17.490402 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:08:06.458389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7ED01A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7BE85310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7FA4BED0>]}


============================== 19:08:06.463461 | 91fb2846-039b-4e59-b9ee-42286072f331 ==============================
[0m19:08:06.463461 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:08:06.464502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m mart_customer_rank_KPI', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:08:06.970837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91fb2846-039b-4e59-b9ee-42286072f331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB8133DBA0>]}
[0m19:08:07.047548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91fb2846-039b-4e59-b9ee-42286072f331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB81215E10>]}
[0m19:08:07.048831 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:08:07.539193 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:08:07.635277 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:08:07.637525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '91fb2846-039b-4e59-b9ee-42286072f331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB81275450>]}
[0m19:08:08.804071 [error] [MainThread]: Encountered an error:
Compilation Error in model mart_product_rank_KPI (models\mart\mart_product_rank_KPI.sql)
  expected token 'end of print statement', got ':'
    line 4
      {{ref:('prep_product_rank')}}
[0m19:08:08.805808 [debug] [MainThread]: Command `dbt run` failed at 19:08:08.805642 after 2.49 seconds
[0m19:08:08.806268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB81609220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB81608AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7F92BE70>]}
[0m19:08:08.806717 [debug] [MainThread]: Flushing usage events
[0m19:08:09.836566 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:09:32.166581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C79D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C4B25310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C970BED0>]}


============================== 19:09:32.184462 | db6f5280-8647-42d3-b5c5-5631e79d2c32 ==============================
[0m19:09:32.184462 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:09:32.185534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m mart_customer_rank_KPI', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:09:35.858928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db6f5280-8647-42d3-b5c5-5631e79d2c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C9F3DBA0>]}
[0m19:09:35.931359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db6f5280-8647-42d3-b5c5-5631e79d2c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C9E19E10>]}
[0m19:09:35.942021 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:09:36.702312 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:09:36.955852 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:09:36.957014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'db6f5280-8647-42d3-b5c5-5631e79d2c32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C9E75450>]}
[0m19:09:41.625449 [error] [MainThread]: Encountered an error:
Compilation Error in model mart_customer_rank_KPI (models\mart\mart_customer_rank_KPI.sql)
  expected token 'end of print statement', got ':'
    line 4
      {{ref:('prep_customer_rank')}}
[0m19:09:41.627181 [debug] [MainThread]: Command `dbt run` failed at 19:09:41.626946 after 9.64 seconds
[0m19:09:41.627726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247CA220AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247CA223C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247C95EBE70>]}
[0m19:09:41.628204 [debug] [MainThread]: Flushing usage events
[0m19:09:43.160262 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:10:35.809431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3E55D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3E26E1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3E7307ED0>]}


============================== 19:10:35.814340 | 5cb2cd81-208d-472f-b7c1-b039064c48fb ==============================
[0m19:10:35.814340 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:10:35.815379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_customer_rank_KPI', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:10:36.330428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cb2cd81-208d-472f-b7c1-b039064c48fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3E7B3DBA0>]}
[0m19:10:36.403960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cb2cd81-208d-472f-b7c1-b039064c48fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3E7A19E10>]}
[0m19:10:36.405256 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:10:36.898758 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:10:37.008069 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:10:37.008949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5cb2cd81-208d-472f-b7c1-b039064c48fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3E7A75450>]}
[0m19:10:38.258353 [error] [MainThread]: Encountered an error:
Compilation Error in model mart_product_rank_KPI (models\mart\mart_product_rank_KPI.sql)
  expected token 'end of print statement', got ':'
    line 4
      {{ref:('prep_product_rank')}}
[0m19:10:38.260012 [debug] [MainThread]: Command `dbt run` failed at 19:10:38.259859 after 2.59 seconds
[0m19:10:38.260453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3E7EC1220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3E7EC0AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3E71EBE70>]}
[0m19:10:38.260913 [debug] [MainThread]: Flushing usage events
[0m19:10:39.224909 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:11:02.956822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029529CD1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029526DD5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002952AA03ED0>]}


============================== 19:11:02.961978 | 52b7734e-5518-408e-9b22-11de59be1493 ==============================
[0m19:11:02.961978 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:11:02.962938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m mart_customer_rank_KPI', 'send_anonymous_usage_stats': 'True'}
[0m19:11:03.474115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52b7734e-5518-408e-9b22-11de59be1493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002952C23DBA0>]}
[0m19:11:03.551530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52b7734e-5518-408e-9b22-11de59be1493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002952C119E10>]}
[0m19:11:03.552836 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:11:04.042002 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:11:04.149397 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:11:04.150168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '52b7734e-5518-408e-9b22-11de59be1493', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002952C175450>]}
[0m19:11:05.300656 [error] [MainThread]: Encountered an error:
Compilation Error in model mart_customer_rank_KPI (models\mart\mart_customer_rank_KPI.sql)
  expected token 'end of print statement', got ':'
    line 4
      {{ ref:('prep_customer_rank')}}
[0m19:11:05.302285 [debug] [MainThread]: Command `dbt run` failed at 19:11:05.302135 after 2.48 seconds
[0m19:11:05.302724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002952C538AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002952C53BC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002952A8EBE70>]}
[0m19:11:05.303163 [debug] [MainThread]: Flushing usage events
[0m19:11:06.275314 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:13:16.316994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286308D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002862D9A5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002863260FED0>]}


============================== 19:13:16.322440 | e708ad96-dd3f-42d4-9c96-100012a34a51 ==============================
[0m19:13:16.322440 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:13:16.323498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_customer_rank_KPI', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:13:16.832913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e708ad96-dd3f-42d4-9c96-100012a34a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028632E3DBA0>]}
[0m19:13:16.908471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e708ad96-dd3f-42d4-9c96-100012a34a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028632D19E10>]}
[0m19:13:16.909985 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:13:17.423968 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:13:17.530521 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:13:17.532960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e708ad96-dd3f-42d4-9c96-100012a34a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028632D75450>]}
[0m19:13:18.963275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e708ad96-dd3f-42d4-9c96-100012a34a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286331454F0>]}
[0m19:13:19.038436 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m19:13:19.072844 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m19:13:19.402898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e708ad96-dd3f-42d4-9c96-100012a34a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002863330F4D0>]}
[0m19:13:19.403539 [info ] [MainThread]: Found 8 models, 4 sources, 473 macros
[0m19:13:19.404497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e708ad96-dd3f-42d4-9c96-100012a34a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286331AA5B0>]}
[0m19:13:19.407184 [info ] [MainThread]: 
[0m19:13:19.408096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:13:19.408827 [info ] [MainThread]: 
[0m19:13:19.409933 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:13:19.411459 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m19:13:22.953281 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m19:13:22.953742 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m19:13:22.954117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:24.157786 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.204 seconds
[0m19:13:24.160010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB, now create_DE_MINI_PROJECT_DB_mart)
[0m19:13:24.161258 [debug] [ThreadPool]: Creating schema "database: "DE_MINI_PROJECT_DB"
schema: "mart"
"
[0m19:13:24.165795 [debug] [ThreadPool]: Using snowflake connection "create_DE_MINI_PROJECT_DB_mart"
[0m19:13:24.166196 [debug] [ThreadPool]: On create_DE_MINI_PROJECT_DB_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "create_DE_MINI_PROJECT_DB_mart"} */
create schema if not exists DE_MINI_PROJECT_DB.mart
[0m19:13:24.271464 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.105 seconds
[0m19:13:24.284042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m19:13:24.296952 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m19:13:24.297358 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m19:13:24.297702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:24.720489 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.422 seconds
[0m19:13:24.728369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_staging, now list_DE_MINI_PROJECT_DB_preparation)
[0m19:13:24.742285 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m19:13:24.743678 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m19:13:24.852346 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.107 seconds
[0m19:13:24.859158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_preparation, now list_DE_MINI_PROJECT_DB_mart)
[0m19:13:24.869261 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_mart"
[0m19:13:24.870317 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_mart"} */
show objects in DE_MINI_PROJECT_DB.mart limit 10000;
[0m19:13:24.958928 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.088 seconds
[0m19:13:24.966171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e708ad96-dd3f-42d4-9c96-100012a34a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286336E4290>]}
[0m19:13:24.972417 [debug] [Thread-1 (]: Began running node model.dbt_transformations.mart_customer_rank_KPI
[0m19:13:24.973034 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.mart_customer_rank_KPI ....................... [RUN]
[0m19:13:24.974158 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.mart_customer_rank_KPI'
[0m19:13:24.974572 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.mart_customer_rank_KPI
[0m19:13:24.981963 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.mart_customer_rank_KPI"
[0m19:13:24.984070 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.mart_customer_rank_KPI
[0m19:13:25.024050 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.mart_customer_rank_KPI"
[0m19:13:25.026580 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.mart_customer_rank_KPI"
[0m19:13:25.027102 [debug] [Thread-1 (]: On model.dbt_transformations.mart_customer_rank_KPI: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.mart_customer_rank_KPI"} */
create or replace transient table DE_MINI_PROJECT_DB.mart.mart_customer_rank_KPI
         as
        (SELECT
    *
FROM
    DE_MINI_PROJECT_DB.preparation.prep_customer_rank
        );
[0m19:13:25.027532 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:13:26.231810 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.204 seconds
[0m19:13:26.267859 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e708ad96-dd3f-42d4-9c96-100012a34a51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286338254F0>]}
[0m19:13:26.268663 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.mart_customer_rank_KPI .................. [[32mSUCCESS 1[0m in 1.28s]
[0m19:13:26.269889 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.mart_customer_rank_KPI
[0m19:13:26.271736 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:13:26.272124 [debug] [MainThread]: Connection 'create_DE_MINI_PROJECT_DB_mart' was left open.
[0m19:13:26.272471 [debug] [MainThread]: On create_DE_MINI_PROJECT_DB_mart: Close
[0m19:13:26.373773 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_mart' was left open.
[0m19:13:26.374223 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_mart: Close
[0m19:13:26.481989 [debug] [MainThread]: Connection 'model.dbt_transformations.mart_customer_rank_KPI' was left open.
[0m19:13:26.482423 [debug] [MainThread]: On model.dbt_transformations.mart_customer_rank_KPI: Close
[0m19:13:26.587584 [info ] [MainThread]: 
[0m19:13:26.590146 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.18 seconds (7.18s).
[0m19:13:26.594010 [debug] [MainThread]: Command end result
[0m19:13:26.636615 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m19:13:26.640700 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m19:13:26.647590 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m19:13:26.648042 [info ] [MainThread]: 
[0m19:13:26.648942 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:13:26.649679 [info ] [MainThread]: 
[0m19:13:26.650448 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:13:26.651757 [debug] [MainThread]: Command `dbt run` succeeded at 19:13:26.651619 after 10.48 seconds
[0m19:13:26.652175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028633896E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286330DA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028633636BD0>]}
[0m19:13:26.652609 [debug] [MainThread]: Flushing usage events
[0m19:13:28.052412 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:14:12.713520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019719FD1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000197191B5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001971AD0BED0>]}


============================== 19:14:12.718708 | 9ad46f7c-f013-4de9-b034-87a2d2ba116b ==============================
[0m19:14:12.718708 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:14:12.719794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m mart_product_rank_KPI', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:14:13.213342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ad46f7c-f013-4de9-b034-87a2d2ba116b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001971C63DBA0>]}
[0m19:14:13.283864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ad46f7c-f013-4de9-b034-87a2d2ba116b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001971C519E10>]}
[0m19:14:13.285589 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:14:13.802618 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:14:14.009015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:14:14.009447 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:14:14.048027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ad46f7c-f013-4de9-b034-87a2d2ba116b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001971C577950>]}
[0m19:14:14.131758 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m19:14:14.137059 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m19:14:14.165400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ad46f7c-f013-4de9-b034-87a2d2ba116b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001971931B6B0>]}
[0m19:14:14.166037 [info ] [MainThread]: Found 8 models, 4 sources, 473 macros
[0m19:14:14.166970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ad46f7c-f013-4de9-b034-87a2d2ba116b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001971C903310>]}
[0m19:14:14.169253 [info ] [MainThread]: 
[0m19:14:14.170305 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:14:14.171064 [info ] [MainThread]: 
[0m19:14:14.172072 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:14:14.173390 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m19:14:14.297836 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m19:14:14.298314 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m19:14:14.298685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:15.049189 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.750 seconds
[0m19:14:15.057337 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m19:14:15.124006 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m19:14:15.124476 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m19:14:15.124843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:15.485498 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.360 seconds
[0m19:14:15.494354 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_staging, now list_DE_MINI_PROJECT_DB_preparation)
[0m19:14:15.498265 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m19:14:15.498658 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m19:14:15.602383 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.103 seconds
[0m19:14:15.604511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_preparation, now list_DE_MINI_PROJECT_DB_mart)
[0m19:14:15.607064 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_mart"
[0m19:14:15.608012 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_mart"} */
show objects in DE_MINI_PROJECT_DB.mart limit 10000;
[0m19:14:15.688314 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.080 seconds
[0m19:14:15.690775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ad46f7c-f013-4de9-b034-87a2d2ba116b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001971C2F7A00>]}
[0m19:14:15.693356 [debug] [Thread-1 (]: Began running node model.dbt_transformations.mart_product_rank_KPI
[0m19:14:15.693946 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.mart_product_rank_KPI ........................ [RUN]
[0m19:14:15.694956 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.mart_product_rank_KPI'
[0m19:14:15.695393 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.mart_product_rank_KPI
[0m19:14:15.703499 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.mart_product_rank_KPI"
[0m19:14:15.704880 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.mart_product_rank_KPI
[0m19:14:15.743772 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.mart_product_rank_KPI"
[0m19:14:15.745656 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.mart_product_rank_KPI"
[0m19:14:15.746147 [debug] [Thread-1 (]: On model.dbt_transformations.mart_product_rank_KPI: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.mart_product_rank_KPI"} */
create or replace transient table DE_MINI_PROJECT_DB.mart.mart_product_rank_KPI
         as
        (SELECT  
    *
FROM
    DE_MINI_PROJECT_DB.preparation.prep_product_rank
        );
[0m19:14:15.746574 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:14:16.568493 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.822 seconds
[0m19:14:16.596553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad46f7c-f013-4de9-b034-87a2d2ba116b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001971CEBCD10>]}
[0m19:14:16.597302 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.mart_product_rank_KPI ................... [[32mSUCCESS 1[0m in 0.90s]
[0m19:14:16.598516 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.mart_product_rank_KPI
[0m19:14:16.600179 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:16.600541 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m19:14:16.600887 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m19:14:16.702578 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_mart' was left open.
[0m19:14:16.703052 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_mart: Close
[0m19:14:16.811059 [debug] [MainThread]: Connection 'model.dbt_transformations.mart_product_rank_KPI' was left open.
[0m19:14:16.811642 [debug] [MainThread]: On model.dbt_transformations.mart_product_rank_KPI: Close
[0m19:14:16.915000 [info ] [MainThread]: 
[0m19:14:16.916413 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m19:14:16.918437 [debug] [MainThread]: Command end result
[0m19:14:16.952751 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m19:14:16.957426 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m19:14:16.965036 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m19:14:16.965474 [info ] [MainThread]: 
[0m19:14:16.966440 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:14:16.967175 [info ] [MainThread]: 
[0m19:14:16.967981 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:14:16.969329 [debug] [MainThread]: Command `dbt run` succeeded at 19:14:16.969184 after 4.39 seconds
[0m19:14:16.969767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001971CF47E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001971C620230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001971C6213B0>]}
[0m19:14:16.970223 [debug] [MainThread]: Flushing usage events
[0m19:14:18.023189 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:26:38.436682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6D2D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6B4B5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6F013ED0>]}


============================== 19:26:38.453568 | e230c97c-259a-43fd-aa9d-cf74f60d381b ==============================
[0m19:26:38.453568 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:26:38.454666 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m prep_new_logos', 'send_anonymous_usage_stats': 'True'}
[0m19:26:41.845527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e230c97c-259a-43fd-aa9d-cf74f60d381b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6F83DBA0>]}
[0m19:26:41.911570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e230c97c-259a-43fd-aa9d-cf74f60d381b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6F719E10>]}
[0m19:26:41.920892 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:26:42.545176 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:26:44.121008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:26:44.121612 [debug] [MainThread]: Partial parsing: added file: dbt_transformations://models\preparation\prep_new_logos.sql
[0m19:26:44.409998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e230c97c-259a-43fd-aa9d-cf74f60d381b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6F777C50>]}
[0m19:26:44.485075 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m19:26:44.503082 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m19:26:44.787835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e230c97c-259a-43fd-aa9d-cf74f60d381b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6B61B6B0>]}
[0m19:26:44.788474 [info ] [MainThread]: Found 9 models, 4 sources, 473 macros
[0m19:26:44.789443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e230c97c-259a-43fd-aa9d-cf74f60d381b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6FB02F90>]}
[0m19:26:44.791815 [info ] [MainThread]: 
[0m19:26:44.792716 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:26:44.793383 [info ] [MainThread]: 
[0m19:26:44.794278 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:26:44.795439 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m19:26:48.152636 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m19:26:48.153100 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m19:26:48.153473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:49.216313 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.063 seconds
[0m19:26:49.225190 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m19:26:49.237217 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m19:26:49.237697 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m19:26:49.238062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:49.763190 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.525 seconds
[0m19:26:49.765751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_staging, now list_DE_MINI_PROJECT_DB_preparation)
[0m19:26:49.769040 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m19:26:49.769488 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m19:26:49.891733 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.122 seconds
[0m19:26:49.894572 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_preparation, now list_DE_MINI_PROJECT_DB_mart)
[0m19:26:49.896482 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_mart"
[0m19:26:49.896871 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_mart"} */
show objects in DE_MINI_PROJECT_DB.mart limit 10000;
[0m19:26:50.095644 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.198 seconds
[0m19:26:50.098805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e230c97c-259a-43fd-aa9d-cf74f60d381b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A6FF364E0>]}
[0m19:26:50.101397 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_new_logos
[0m19:26:50.101984 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_new_logos ........................ [RUN]
[0m19:26:50.103055 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_new_logos'
[0m19:26:50.103488 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_new_logos
[0m19:26:50.111786 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_new_logos"
[0m19:26:50.113396 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_new_logos
[0m19:26:50.148287 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_new_logos"
[0m19:26:50.150503 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_new_logos"
[0m19:26:50.151004 [debug] [Thread-1 (]: On model.dbt_transformations.prep_new_logos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_new_logos"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_new_logos
         as
        (WITH cte AS(
    SELECT
        customer_id,
        EXTRACT(YEAR FROM MIN(payment_month)) AS first_transaction_year,
        EXTRACT(YEAR FROM payment_month) AS fiscal_year
    FROM
        DE_MINI_PROJECT_DB.staging.stg_transactions
)

SELECT  
    fiscal_year,
    COUNT(customer_id) AS no_of_new_logos
FROM
    cte
WHERE
    fiscal_year = first_transaction_year
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m19:26:50.151455 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:26:50.727002 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00e4-3201-7e57-000c-4ad200020662
[0m19:26:50.727531 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[STG_TRANSACTIONS.CUSTOMER_ID] is not a valid group by expression
[0m19:26:50.737063 [debug] [Thread-1 (]: Database Error in model prep_new_logos (models\preparation\prep_new_logos.sql)
  000979 (42601): SQL compilation error:
  [STG_TRANSACTIONS.CUSTOMER_ID] is not a valid group by expression
  compiled code at target\run\dbt_transformations\models\preparation\prep_new_logos.sql
[0m19:26:50.747296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e230c97c-259a-43fd-aa9d-cf74f60d381b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A7114D850>]}
[0m19:26:50.748134 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model preparation.prep_new_logos ............... [[31mERROR[0m in 0.63s]
[0m19:26:50.749367 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_new_logos
[0m19:26:50.750079 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.prep_new_logos' to be skipped because of status 'error'.  Reason: Database Error in model prep_new_logos (models\preparation\prep_new_logos.sql)
  000979 (42601): SQL compilation error:
  [STG_TRANSACTIONS.CUSTOMER_ID] is not a valid group by expression
  compiled code at target\run\dbt_transformations\models\preparation\prep_new_logos.sql.
[0m19:26:50.752277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:50.752637 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m19:26:50.752990 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m19:26:50.858891 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_mart' was left open.
[0m19:26:50.859342 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_mart: Close
[0m19:26:50.965779 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_new_logos' was left open.
[0m19:26:50.967299 [debug] [MainThread]: On model.dbt_transformations.prep_new_logos: Close
[0m19:26:51.087529 [info ] [MainThread]: 
[0m19:26:51.088537 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.29 seconds (6.29s).
[0m19:26:51.089728 [debug] [MainThread]: Command end result
[0m19:26:51.119602 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m19:26:51.122786 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m19:26:51.130896 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m19:26:51.131536 [info ] [MainThread]: 
[0m19:26:51.132503 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:26:51.133376 [info ] [MainThread]: 
[0m19:26:51.134383 [error] [MainThread]:   Database Error in model prep_new_logos (models\preparation\prep_new_logos.sql)
  000979 (42601): SQL compilation error:
  [STG_TRANSACTIONS.CUSTOMER_ID] is not a valid group by expression
  compiled code at target\run\dbt_transformations\models\preparation\prep_new_logos.sql
[0m19:26:51.135291 [info ] [MainThread]: 
[0m19:26:51.136171 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:26:51.137772 [debug] [MainThread]: Command `dbt run` failed at 19:26:51.137558 after 12.96 seconds
[0m19:26:51.138317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A71155B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A711B3110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A711B2FD0>]}
[0m19:26:51.138877 [debug] [MainThread]: Flushing usage events
[0m19:26:52.068148 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:14.129280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE15D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBDE6E5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE330FED0>]}


============================== 19:27:14.134062 | e482a8b3-c65f-4924-8018-1ad482494379 ==============================
[0m19:27:14.134062 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:27:14.135076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m prep_new_logos', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:27:14.610745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e482a8b3-c65f-4924-8018-1ad482494379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE3B3DBA0>]}
[0m19:27:14.677596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e482a8b3-c65f-4924-8018-1ad482494379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE3A19E10>]}
[0m19:27:14.678825 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:27:15.174338 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:27:15.376701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:27:15.377336 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\preparation\prep_new_logos.sql
[0m19:27:15.658451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e482a8b3-c65f-4924-8018-1ad482494379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE3A7B150>]}
[0m19:27:15.733843 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m19:27:15.738166 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m19:27:15.768327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e482a8b3-c65f-4924-8018-1ad482494379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBDE85B6B0>]}
[0m19:27:15.768932 [info ] [MainThread]: Found 9 models, 4 sources, 473 macros
[0m19:27:15.769865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e482a8b3-c65f-4924-8018-1ad482494379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE3E01B70>]}
[0m19:27:15.771675 [info ] [MainThread]: 
[0m19:27:15.772422 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:27:15.773085 [info ] [MainThread]: 
[0m19:27:15.773911 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:27:15.775037 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m19:27:15.944723 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m19:27:15.945186 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m19:27:15.945553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:16.699546 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.754 seconds
[0m19:27:16.706779 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_preparation'
[0m19:27:16.717461 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m19:27:16.717886 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m19:27:16.718244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:17.159415 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.441 seconds
[0m19:27:17.161502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_preparation, now list_DE_MINI_PROJECT_DB_mart)
[0m19:27:17.163937 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_mart"
[0m19:27:17.164312 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_mart"} */
show objects in DE_MINI_PROJECT_DB.mart limit 10000;
[0m19:27:17.258227 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.093 seconds
[0m19:27:17.263999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_mart, now list_DE_MINI_PROJECT_DB_staging)
[0m19:27:17.271168 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m19:27:17.272251 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m19:27:17.365592 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.092 seconds
[0m19:27:17.376257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e482a8b3-c65f-4924-8018-1ad482494379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE4235E60>]}
[0m19:27:17.384356 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_new_logos
[0m19:27:17.386493 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_new_logos ........................ [RUN]
[0m19:27:17.389606 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_new_logos'
[0m19:27:17.391277 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_new_logos
[0m19:27:17.401340 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_new_logos"
[0m19:27:17.402609 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_new_logos
[0m19:27:17.438303 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_new_logos"
[0m19:27:17.440185 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_new_logos"
[0m19:27:17.440657 [debug] [Thread-1 (]: On model.dbt_transformations.prep_new_logos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_new_logos"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_new_logos
         as
        (WITH cte AS(
    SELECT
        EXTRACT(YEAR FROM MIN(payment_month)) AS first_transaction_year,
        EXTRACT(YEAR FROM payment_month) AS fiscal_year
    FROM
        DE_MINI_PROJECT_DB.staging.stg_transactions
)

SELECT  
    fiscal_year,
    COUNT(customer_id) AS no_of_new_logos
FROM
    cte
WHERE
    fiscal_year = first_transaction_year
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m19:27:17.441148 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:27:17.813564 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00e5-3201-7d7b-000c-4ad20001dd42
[0m19:27:17.814479 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 10
invalid identifier 'CUSTOMER_ID'
[0m19:27:17.826096 [debug] [Thread-1 (]: Database Error in model prep_new_logos (models\preparation\prep_new_logos.sql)
  000904 (42000): SQL compilation error: error line 13 at position 10
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\dbt_transformations\models\preparation\prep_new_logos.sql
[0m19:27:17.828746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e482a8b3-c65f-4924-8018-1ad482494379', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE4421790>]}
[0m19:27:17.829682 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model preparation.prep_new_logos ............... [[31mERROR[0m in 0.44s]
[0m19:27:17.831057 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_new_logos
[0m19:27:17.831928 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.prep_new_logos' to be skipped because of status 'error'.  Reason: Database Error in model prep_new_logos (models\preparation\prep_new_logos.sql)
  000904 (42000): SQL compilation error: error line 13 at position 10
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\dbt_transformations\models\preparation\prep_new_logos.sql.
[0m19:27:17.834153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:17.834534 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m19:27:17.834905 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m19:27:17.937173 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m19:27:17.937946 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m19:27:18.045355 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_new_logos' was left open.
[0m19:27:18.046847 [debug] [MainThread]: On model.dbt_transformations.prep_new_logos: Close
[0m19:27:18.163286 [info ] [MainThread]: 
[0m19:27:18.164278 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m19:27:18.165430 [debug] [MainThread]: Command end result
[0m19:27:18.194856 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m19:27:18.197406 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m19:27:18.205122 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m19:27:18.205606 [info ] [MainThread]: 
[0m19:27:18.206510 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:27:18.207983 [info ] [MainThread]: 
[0m19:27:18.208831 [error] [MainThread]:   Database Error in model prep_new_logos (models\preparation\prep_new_logos.sql)
  000904 (42000): SQL compilation error: error line 13 at position 10
  invalid identifier 'CUSTOMER_ID'
  compiled code at target\run\dbt_transformations\models\preparation\prep_new_logos.sql
[0m19:27:18.209595 [info ] [MainThread]: 
[0m19:27:18.210344 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:27:18.211820 [debug] [MainThread]: Command `dbt run` failed at 19:27:18.211660 after 4.21 seconds
[0m19:27:18.212348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE4429910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE3B90D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBE3B91310>]}
[0m19:27:18.212835 [debug] [MainThread]: Flushing usage events
[0m19:27:19.225678 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:28:41.109270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017869031A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000178681B5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017869D7BED0>]}


============================== 19:28:41.114590 | f9e9ef1d-2dd2-4bf4-8a05-947bf8a5d535 ==============================
[0m19:28:41.114590 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:28:41.115625 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prep_new_logos', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:28:41.608318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9e9ef1d-2dd2-4bf4-8a05-947bf8a5d535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001786B63DBA0>]}
[0m19:28:41.679829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9e9ef1d-2dd2-4bf4-8a05-947bf8a5d535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001786B519E10>]}
[0m19:28:41.681145 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:28:42.162890 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:28:42.383392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:28:42.384138 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\preparation\prep_new_logos.sql
[0m19:28:42.675459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9e9ef1d-2dd2-4bf4-8a05-947bf8a5d535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001786B577150>]}
[0m19:28:42.753687 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m19:28:42.758266 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m19:28:42.787536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9e9ef1d-2dd2-4bf4-8a05-947bf8a5d535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001786832B6B0>]}
[0m19:28:42.788094 [info ] [MainThread]: Found 9 models, 4 sources, 473 macros
[0m19:28:42.788988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9e9ef1d-2dd2-4bf4-8a05-947bf8a5d535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001786B905B70>]}
[0m19:28:42.790807 [info ] [MainThread]: 
[0m19:28:42.791601 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:28:42.792294 [info ] [MainThread]: 
[0m19:28:42.793170 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:28:42.794296 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m19:28:42.964061 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m19:28:42.964581 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m19:28:42.965017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:43.726472 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.761 seconds
[0m19:28:43.733755 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_preparation'
[0m19:28:43.744312 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m19:28:43.744735 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m19:28:43.745097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:44.165245 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.420 seconds
[0m19:28:44.167325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_preparation, now list_DE_MINI_PROJECT_DB_mart)
[0m19:28:44.169787 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_mart"
[0m19:28:44.170142 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_mart"} */
show objects in DE_MINI_PROJECT_DB.mart limit 10000;
[0m19:28:44.263613 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.093 seconds
[0m19:28:44.266704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_mart, now list_DE_MINI_PROJECT_DB_staging)
[0m19:28:44.268621 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m19:28:44.268997 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m19:28:44.372990 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.104 seconds
[0m19:28:44.377741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9e9ef1d-2dd2-4bf4-8a05-947bf8a5d535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001786BD35E60>]}
[0m19:28:44.381799 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_new_logos
[0m19:28:44.383055 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_new_logos ........................ [RUN]
[0m19:28:44.384929 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_new_logos'
[0m19:28:44.385889 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_new_logos
[0m19:28:44.396149 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_new_logos"
[0m19:28:44.397818 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_new_logos
[0m19:28:44.432918 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_new_logos"
[0m19:28:44.435117 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_new_logos"
[0m19:28:44.435618 [debug] [Thread-1 (]: On model.dbt_transformations.prep_new_logos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_new_logos"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_new_logos
         as
        (WITH cte AS(
    SELECT
        customer_id,
        EXTRACT(YEAR FROM MIN(payment_month)) AS first_transaction_year,
        EXTRACT(YEAR FROM payment_month) AS fiscal_year
    FROM
        DE_MINI_PROJECT_DB.staging.stg_transactions
)

SELECT  
    fiscal_year,
    COUNT(customer_id) AS no_of_new_logos
FROM
    cte
WHERE
    fiscal_year = first_transaction_year
GROUP BY
    fiscal_year,customer_id
ORDER BY
    fiscal_year
        );
[0m19:28:44.436070 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:28:44.852628 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00e6-3201-7db6-000c-4ad20002156e
[0m19:28:44.853417 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000979 (42601): SQL compilation error:
[STG_TRANSACTIONS.CUSTOMER_ID] is not a valid group by expression
[0m19:28:44.863160 [debug] [Thread-1 (]: Database Error in model prep_new_logos (models\preparation\prep_new_logos.sql)
  000979 (42601): SQL compilation error:
  [STG_TRANSACTIONS.CUSTOMER_ID] is not a valid group by expression
  compiled code at target\run\dbt_transformations\models\preparation\prep_new_logos.sql
[0m19:28:44.865415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9e9ef1d-2dd2-4bf4-8a05-947bf8a5d535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001786BF25790>]}
[0m19:28:44.866219 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model preparation.prep_new_logos ............... [[31mERROR[0m in 0.48s]
[0m19:28:44.867464 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_new_logos
[0m19:28:44.868215 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.prep_new_logos' to be skipped because of status 'error'.  Reason: Database Error in model prep_new_logos (models\preparation\prep_new_logos.sql)
  000979 (42601): SQL compilation error:
  [STG_TRANSACTIONS.CUSTOMER_ID] is not a valid group by expression
  compiled code at target\run\dbt_transformations\models\preparation\prep_new_logos.sql.
[0m19:28:44.870308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:44.870656 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m19:28:44.870992 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m19:28:44.979785 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m19:28:44.980477 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m19:28:45.092746 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_new_logos' was left open.
[0m19:28:45.093424 [debug] [MainThread]: On model.dbt_transformations.prep_new_logos: Close
[0m19:28:45.206390 [info ] [MainThread]: 
[0m19:28:45.207315 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.41 seconds (2.41s).
[0m19:28:45.208468 [debug] [MainThread]: Command end result
[0m19:28:45.237598 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m19:28:45.241620 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m19:28:45.249129 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m19:28:45.249587 [info ] [MainThread]: 
[0m19:28:45.250578 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:28:45.251485 [info ] [MainThread]: 
[0m19:28:45.252395 [error] [MainThread]:   Database Error in model prep_new_logos (models\preparation\prep_new_logos.sql)
  000979 (42601): SQL compilation error:
  [STG_TRANSACTIONS.CUSTOMER_ID] is not a valid group by expression
  compiled code at target\run\dbt_transformations\models\preparation\prep_new_logos.sql
[0m19:28:45.253496 [info ] [MainThread]: 
[0m19:28:45.254637 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:28:45.257210 [debug] [MainThread]: Command `dbt run` failed at 19:28:45.256867 after 4.37 seconds
[0m19:28:45.257714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001786BF29910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001786BF72FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001786BF72DF0>]}
[0m19:28:45.258189 [debug] [MainThread]: Flushing usage events
[0m19:28:46.230323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:38:52.560866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A65C5D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A659745310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A65E30BED0>]}


============================== 19:38:52.576535 | 96e24185-1a33-4cca-bdab-d17663f94c06 ==============================
[0m19:38:52.576535 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:38:52.577673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m prep_new_logos', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:38:55.935474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96e24185-1a33-4cca-bdab-d17663f94c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A65EB4DBA0>]}
[0m19:38:56.001656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96e24185-1a33-4cca-bdab-d17663f94c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A65EA29E10>]}
[0m19:38:56.012060 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:38:56.692364 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:38:58.300452 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:38:58.301110 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\preparation\prep_new_logos.sql
[0m19:38:58.587862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96e24185-1a33-4cca-bdab-d17663f94c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A65EA87150>]}
[0m19:38:58.665038 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m19:38:58.683605 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m19:38:58.986342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96e24185-1a33-4cca-bdab-d17663f94c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6598AB6B0>]}
[0m19:38:58.986967 [info ] [MainThread]: Found 9 models, 4 sources, 473 macros
[0m19:38:58.987947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96e24185-1a33-4cca-bdab-d17663f94c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A65EE15B70>]}
[0m19:38:58.989733 [info ] [MainThread]: 
[0m19:38:58.990488 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:38:58.991178 [info ] [MainThread]: 
[0m19:38:58.992051 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:38:58.993395 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m19:39:02.358428 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m19:39:02.358889 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m19:39:02.359260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:03.580683 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.221 seconds
[0m19:39:03.587973 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_staging'
[0m19:39:03.599206 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m19:39:03.599683 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m19:39:03.600060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:03.971285 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.371 seconds
[0m19:39:03.973973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_staging, now list_DE_MINI_PROJECT_DB_mart)
[0m19:39:03.977344 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_mart"
[0m19:39:03.977792 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_mart"} */
show objects in DE_MINI_PROJECT_DB.mart limit 10000;
[0m19:39:04.114364 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.136 seconds
[0m19:39:04.121375 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_mart, now list_DE_MINI_PROJECT_DB_preparation)
[0m19:39:04.129942 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m19:39:04.131385 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m19:39:04.218821 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.086 seconds
[0m19:39:04.225130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96e24185-1a33-4cca-bdab-d17663f94c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A65F255E60>]}
[0m19:39:04.227619 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_new_logos
[0m19:39:04.228241 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_new_logos ........................ [RUN]
[0m19:39:04.229341 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_new_logos'
[0m19:39:04.229774 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_new_logos
[0m19:39:04.238718 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_new_logos"
[0m19:39:04.240081 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_new_logos
[0m19:39:04.275049 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_new_logos"
[0m19:39:04.276965 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_new_logos"
[0m19:39:04.277445 [debug] [Thread-1 (]: On model.dbt_transformations.prep_new_logos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_new_logos"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_new_logos
         as
        (WITH cte AS(
    SELECT
        customer_id,
        EXTRACT(YEAR FROM MIN(payment_month)) AS fiscal_year
    FROM
        DE_MINI_PROJECT_DB.staging.stg_transactions
    GROUP BY
        customer_id
)

SELECT  
    fiscal_year,
    COUNT(customer_id) AS no_of_new_logos
FROM
    new_logos_cte
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m19:39:04.277888 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:39:04.845200 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bb00f1-3201-7e57-000c-4ad200020672
[0m19:39:04.845733 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'NEW_LOGOS_CTE' does not exist or not authorized.
[0m19:39:04.853216 [debug] [Thread-1 (]: Database Error in model prep_new_logos (models\preparation\prep_new_logos.sql)
  002003 (42S02): SQL compilation error:
  Object 'NEW_LOGOS_CTE' does not exist or not authorized.
  compiled code at target\run\dbt_transformations\models\preparation\prep_new_logos.sql
[0m19:39:04.864463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96e24185-1a33-4cca-bdab-d17663f94c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A65F471790>]}
[0m19:39:04.865292 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model preparation.prep_new_logos ............... [[31mERROR[0m in 0.62s]
[0m19:39:04.866543 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_new_logos
[0m19:39:04.867290 [debug] [Thread-4 (]: Marking all children of 'model.dbt_transformations.prep_new_logos' to be skipped because of status 'error'.  Reason: Database Error in model prep_new_logos (models\preparation\prep_new_logos.sql)
  002003 (42S02): SQL compilation error:
  Object 'NEW_LOGOS_CTE' does not exist or not authorized.
  compiled code at target\run\dbt_transformations\models\preparation\prep_new_logos.sql.
[0m19:39:04.869467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:04.869848 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m19:39:04.870208 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m19:39:04.976678 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_preparation' was left open.
[0m19:39:04.977860 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_preparation: Close
[0m19:39:05.081692 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_new_logos' was left open.
[0m19:39:05.082392 [debug] [MainThread]: On model.dbt_transformations.prep_new_logos: Close
[0m19:39:05.187094 [info ] [MainThread]: 
[0m19:39:05.188902 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.20 seconds (6.20s).
[0m19:39:05.191512 [debug] [MainThread]: Command end result
[0m19:39:05.228674 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m19:39:05.231258 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m19:39:05.238851 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m19:39:05.239518 [info ] [MainThread]: 
[0m19:39:05.240735 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:39:05.242076 [info ] [MainThread]: 
[0m19:39:05.243145 [error] [MainThread]:   Database Error in model prep_new_logos (models\preparation\prep_new_logos.sql)
  002003 (42S02): SQL compilation error:
  Object 'NEW_LOGOS_CTE' does not exist or not authorized.
  compiled code at target\run\dbt_transformations\models\preparation\prep_new_logos.sql
[0m19:39:05.243979 [info ] [MainThread]: 
[0m19:39:05.244802 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:39:05.246391 [debug] [MainThread]: Command `dbt run` failed at 19:39:05.246217 after 12.95 seconds
[0m19:39:05.246853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A65F479860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A65EBA0D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A65EBA1310>]}
[0m19:39:05.247303 [debug] [MainThread]: Flushing usage events
[0m19:39:06.272949 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:21.121750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235884D1A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235865C1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002358A20BED0>]}


============================== 19:39:21.126855 | c9e9e559-5023-43a9-95bc-fccae4765634 ==============================
[0m19:39:21.126855 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:39:21.127950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m prep_new_logos', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:39:21.618600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9e9e559-5023-43a9-95bc-fccae4765634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002358AA3DBA0>]}
[0m19:39:21.692298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9e9e559-5023-43a9-95bc-fccae4765634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002358A919E10>]}
[0m19:39:21.693628 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:39:22.195004 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:39:22.427881 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:39:22.428588 [debug] [MainThread]: Partial parsing: updated file: dbt_transformations://models\preparation\prep_new_logos.sql
[0m19:39:22.803711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9e9e559-5023-43a9-95bc-fccae4765634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002358A977150>]}
[0m19:39:22.881672 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m19:39:22.886055 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m19:39:22.918981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9e9e559-5023-43a9-95bc-fccae4765634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002358672B6B0>]}
[0m19:39:22.919598 [info ] [MainThread]: Found 9 models, 4 sources, 473 macros
[0m19:39:22.920813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9e9e559-5023-43a9-95bc-fccae4765634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002358AD01B70>]}
[0m19:39:22.922853 [info ] [MainThread]: 
[0m19:39:22.923909 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:39:22.924442 [info ] [MainThread]: 
[0m19:39:22.925093 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:39:22.926294 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m19:39:23.123172 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m19:39:23.123727 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m19:39:23.124101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:24.015030 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.891 seconds
[0m19:39:24.025684 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_preparation'
[0m19:39:24.037743 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m19:39:24.038327 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m19:39:24.038715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:24.480852 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.442 seconds
[0m19:39:24.483243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_preparation, now list_DE_MINI_PROJECT_DB_staging)
[0m19:39:24.485441 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m19:39:24.485842 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m19:39:24.561791 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.075 seconds
[0m19:39:24.563983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_staging, now list_DE_MINI_PROJECT_DB_mart)
[0m19:39:24.567163 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_mart"
[0m19:39:24.567611 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_mart"} */
show objects in DE_MINI_PROJECT_DB.mart limit 10000;
[0m19:39:24.657785 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.090 seconds
[0m19:39:24.660555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9e9e559-5023-43a9-95bc-fccae4765634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002358C1364E0>]}
[0m19:39:24.663175 [debug] [Thread-1 (]: Began running node model.dbt_transformations.prep_new_logos
[0m19:39:24.663769 [info ] [Thread-1 (]: 1 of 1 START sql table model preparation.prep_new_logos ........................ [RUN]
[0m19:39:24.664546 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.prep_new_logos'
[0m19:39:24.664992 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.prep_new_logos
[0m19:39:24.673399 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.prep_new_logos"
[0m19:39:24.674547 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.prep_new_logos
[0m19:39:24.712168 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.prep_new_logos"
[0m19:39:24.713954 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.prep_new_logos"
[0m19:39:24.714473 [debug] [Thread-1 (]: On model.dbt_transformations.prep_new_logos: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.prep_new_logos"} */
create or replace transient table DE_MINI_PROJECT_DB.preparation.prep_new_logos
         as
        (WITH new_logos_cte AS(
    SELECT
        customer_id,
        EXTRACT(YEAR FROM MIN(payment_month)) AS fiscal_year
    FROM
        DE_MINI_PROJECT_DB.staging.stg_transactions
    GROUP BY
        customer_id
)

SELECT  
    fiscal_year,
    COUNT(customer_id) AS no_of_new_logos
FROM
    new_logos_cte
GROUP BY
    fiscal_year
ORDER BY
    fiscal_year
        );
[0m19:39:24.714979 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:39:25.818876 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.104 seconds
[0m19:39:25.844328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9e9e559-5023-43a9-95bc-fccae4765634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002358C321F10>]}
[0m19:39:25.845124 [info ] [Thread-1 (]: 1 of 1 OK created sql table model preparation.prep_new_logos ................... [[32mSUCCESS 1[0m in 1.18s]
[0m19:39:25.846051 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.prep_new_logos
[0m19:39:25.847694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:25.848055 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m19:39:25.848408 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m19:39:25.950519 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_mart' was left open.
[0m19:39:25.951668 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_mart: Close
[0m19:39:26.049379 [debug] [MainThread]: Connection 'model.dbt_transformations.prep_new_logos' was left open.
[0m19:39:26.049920 [debug] [MainThread]: On model.dbt_transformations.prep_new_logos: Close
[0m19:39:26.167226 [info ] [MainThread]: 
[0m19:39:26.168198 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m19:39:26.169539 [debug] [MainThread]: Command end result
[0m19:39:26.199149 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m19:39:26.202329 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m19:39:26.210436 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m19:39:26.211000 [info ] [MainThread]: 
[0m19:39:26.212405 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:39:26.213442 [info ] [MainThread]: 
[0m19:39:26.214286 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:39:26.215689 [debug] [MainThread]: Command `dbt run` succeeded at 19:39:26.215542 after 5.23 seconds
[0m19:39:26.216130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002358C328B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002358C387390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002358C386FD0>]}
[0m19:39:26.216599 [debug] [MainThread]: Flushing usage events
[0m19:39:27.577254 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:44.433058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027734B11A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027731CA1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027736907ED0>]}


============================== 19:40:44.438618 | 3b56f9ae-5a17-42c9-9e55-20c0b20230d3 ==============================
[0m19:40:44.438618 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:40:44.439724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RamanathanL\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RamanathanL\\Desktop\\DBT-DE-mini-project\\dbt_transformations\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m mart_new_logos_KPI', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:40:44.928426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b56f9ae-5a17-42c9-9e55-20c0b20230d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002773713DBA0>]}
[0m19:40:45.003016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b56f9ae-5a17-42c9-9e55-20c0b20230d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027737019E10>]}
[0m19:40:45.004447 [info ] [MainThread]: Registered adapter: snowflake=1.9.1
[0m19:40:45.490665 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:40:45.701286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:40:45.701887 [debug] [MainThread]: Partial parsing: added file: dbt_transformations://models\mart\mart_new_logos_KPI.sql
[0m19:40:45.996865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b56f9ae-5a17-42c9-9e55-20c0b20230d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027737075950>]}
[0m19:40:46.088755 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m19:40:46.109046 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m19:40:46.154888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b56f9ae-5a17-42c9-9e55-20c0b20230d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027731E0B6B0>]}
[0m19:40:46.155674 [info ] [MainThread]: Found 10 models, 4 sources, 473 macros
[0m19:40:46.156587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b56f9ae-5a17-42c9-9e55-20c0b20230d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027737406F90>]}
[0m19:40:46.158410 [info ] [MainThread]: 
[0m19:40:46.159122 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:40:46.159824 [info ] [MainThread]: 
[0m19:40:46.160640 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:40:46.161867 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB'
[0m19:40:46.341999 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB"
[0m19:40:46.342446 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB"} */
show terse schemas in database DE_MINI_PROJECT_DB
    limit 10000
[0m19:40:46.342814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:47.111355 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.768 seconds
[0m19:40:47.119367 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DE_MINI_PROJECT_DB_preparation'
[0m19:40:47.130984 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_preparation"
[0m19:40:47.131459 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_preparation: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_preparation"} */
show objects in DE_MINI_PROJECT_DB.preparation limit 10000;
[0m19:40:47.131847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:47.781946 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.650 seconds
[0m19:40:47.784234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_preparation, now list_DE_MINI_PROJECT_DB_mart)
[0m19:40:47.787067 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_mart"
[0m19:40:47.787464 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_mart: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_mart"} */
show objects in DE_MINI_PROJECT_DB.mart limit 10000;
[0m19:40:47.930636 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.143 seconds
[0m19:40:47.932744 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DE_MINI_PROJECT_DB_mart, now list_DE_MINI_PROJECT_DB_staging)
[0m19:40:47.935343 [debug] [ThreadPool]: Using snowflake connection "list_DE_MINI_PROJECT_DB_staging"
[0m19:40:47.935771 [debug] [ThreadPool]: On list_DE_MINI_PROJECT_DB_staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "connection_name": "list_DE_MINI_PROJECT_DB_staging"} */
show objects in DE_MINI_PROJECT_DB.staging limit 10000;
[0m19:40:48.023607 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.087 seconds
[0m19:40:48.026822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b56f9ae-5a17-42c9-9e55-20c0b20230d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027737659D90>]}
[0m19:40:48.029510 [debug] [Thread-1 (]: Began running node model.dbt_transformations.mart_new_logos_KPI
[0m19:40:48.030248 [info ] [Thread-1 (]: 1 of 1 START sql table model mart.mart_new_logos_KPI ........................... [RUN]
[0m19:40:48.031270 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_transformations.mart_new_logos_KPI'
[0m19:40:48.031747 [debug] [Thread-1 (]: Began compiling node model.dbt_transformations.mart_new_logos_KPI
[0m19:40:48.041317 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_transformations.mart_new_logos_KPI"
[0m19:40:48.045487 [debug] [Thread-1 (]: Began executing node model.dbt_transformations.mart_new_logos_KPI
[0m19:40:48.083068 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_transformations.mart_new_logos_KPI"
[0m19:40:48.084957 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_transformations.mart_new_logos_KPI"
[0m19:40:48.085504 [debug] [Thread-1 (]: On model.dbt_transformations.mart_new_logos_KPI: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "dbt_transformations", "target_name": "dev", "node_id": "model.dbt_transformations.mart_new_logos_KPI"} */
create or replace transient table DE_MINI_PROJECT_DB.mart.mart_new_logos_KPI
         as
        (SELECT
    *
FROM
    DE_MINI_PROJECT_DB.preparation.prep_new_logos
        );
[0m19:40:48.085961 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:40:48.933610 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.848 seconds
[0m19:40:48.959646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b56f9ae-5a17-42c9-9e55-20c0b20230d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027737A25FD0>]}
[0m19:40:48.960468 [info ] [Thread-1 (]: 1 of 1 OK created sql table model mart.mart_new_logos_KPI ...................... [[32mSUCCESS 1[0m in 0.93s]
[0m19:40:48.961635 [debug] [Thread-1 (]: Finished running node model.dbt_transformations.mart_new_logos_KPI
[0m19:40:48.963226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:48.963602 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB' was left open.
[0m19:40:48.963984 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB: Close
[0m19:40:49.067724 [debug] [MainThread]: Connection 'list_DE_MINI_PROJECT_DB_staging' was left open.
[0m19:40:49.068302 [debug] [MainThread]: On list_DE_MINI_PROJECT_DB_staging: Close
[0m19:40:49.167871 [debug] [MainThread]: Connection 'model.dbt_transformations.mart_new_logos_KPI' was left open.
[0m19:40:49.168332 [debug] [MainThread]: On model.dbt_transformations.mart_new_logos_KPI: Close
[0m19:40:49.269034 [info ] [MainThread]: 
[0m19:40:49.270528 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.11 seconds (3.11s).
[0m19:40:49.272647 [debug] [MainThread]: Command end result
[0m19:40:49.310880 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\manifest.json
[0m19:40:49.314052 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\semantic_manifest.json
[0m19:40:49.321275 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RamanathanL\Desktop\DBT-DE-mini-project\dbt_transformations\target\run_results.json
[0m19:40:49.321774 [info ] [MainThread]: 
[0m19:40:49.322640 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:40:49.323469 [info ] [MainThread]: 
[0m19:40:49.324603 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:40:49.327787 [debug] [MainThread]: Command `dbt run` succeeded at 19:40:49.327546 after 5.12 seconds
[0m19:40:49.328303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027737A28B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027737B72E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027737B73B10>]}
[0m19:40:49.328777 [debug] [MainThread]: Flushing usage events
[0m19:40:50.294372 [debug] [MainThread]: An error was encountered while trying to flush usage events
